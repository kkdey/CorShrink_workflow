<!DOCTYPE html>

<html xmlns="http://www.w3.org/1999/xhtml">

<head>

<meta charset="utf-8" />
<meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
<meta name="generator" content="pandoc" />

<meta name="viewport" content="width=device-width, initial-scale=1">

<meta name="author" content="Kushal K Dey" />


<title>GSEA All tissues :: CorShrink vs CountClust</title>

<link href="site_libs/highlightjs-1.1/textmate.css" rel="stylesheet" />
<script src="site_libs/highlightjs-1.1/highlight.js"></script>

<style type="text/css">code{white-space: pre;}</style>
<script type="text/javascript">
if (window.hljs && document.readyState && document.readyState === "complete") {
   window.setTimeout(function() {
      hljs.initHighlighting();
   }, 0);
}
</script>




<link rel="stylesheet" href="cosmo.css" type="text/css" />

</head>

<body>


<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <link href="https://fonts.googleapis.com/css?family=Open+Sans:100,300,400,600" rel="stylesheet" type="text/css">
    <link href="../docs/cosmo.css" rel="stylesheet">
    <link href="../docs/cosmo.min.css" rel="stylesheet">
</head>
<script src="https://ajax.googleapis.com/ajax/libs/jquery/1.12.4/jquery.min.js"></script>
<script src="../docs/bootstrap/js/bootstrap.min.js"></script>

<body>

<div class = "nav" align = "middle">
<div class= "p1"></div>
<p>
  <a class="btn btn-large btn btn-primary" type="button" href = "corshrink_front.html">HOME</a> 
  &nbsp &nbsp
  <a class="btn btn-large btn btn-primary" type="button" href = "workflow.html">WORKFLOW</a> 
  &nbsp &nbsp
  <a class="btn btn-large btn btn-primary" type="button" href = "tissue_corr.html">GTEx DEMO</a> 
  &nbsp &nbsp
  <a class="btn btn-large btn btn-primary" type="button" href = "about.html">METHODS</a> 
  &nbsp &nbsp
  <a class="btn btn-large btn btn-primary" type="button" href = "https://github.com/kkdey/CorShrink">SOFTWARE</a> 
  &nbsp &nbsp
  <a class="btn btn-large btn btn-primary" type="button" href = "license.html">LICENSE</a> 
   &nbsp &nbsp
  <a class="btn btn-large btn btn-primary" type="button" href = "https://github.com/kkdey/CorShrink_workflow">GITHUB</a> 
 </p>
</div>  
<!-- <div class="nav">
  <a href="index.html">Home page</a> &nbsp &nbsp
  <a href="musings.html">Musings</a> &nbsp &nbsp
  <a href="town.html">My town</a> &nbsp &nbsp
  <a href="links.html">Links</a>
</div> -->

<!-- Main content -->
</body>
</html>


<h1 class="title toc-ignore">GSEA All tissues :: CorShrink vs CountClust</h1>
<h4 class="author"><em>Kushal K Dey</em></h4>
<h4 class="date"><em>5/12/2017</em></h4>


<div id="TOC">
<ul>
<li><a href="#brain-related">Brain related</a></li>
<li><a href="#high-intra-corr-in-brain-low-intra-corr-in-others">High intra corr in Brain, low intra corr in others</a><ul>
<li><a href="#cluster-3">cluster 3</a></li>
<li><a href="#cluster-9">cluster 9</a></li>
<li><a href="#cluster-15">cluster 15</a></li>
<li><a href="#cluster-16">cluster 16</a></li>
<li><a href="#cluster-17">cluster 17</a></li>
</ul></li>
<li><a href="#high-brain-vs-other-tissues">High Brain vs other tissues</a><ul>
<li><a href="#cluster-17-1">cluster 17</a></li>
<li><a href="#cluster-19">cluster 19</a></li>
<li><a href="#cluster-4">cluster 4</a></li>
</ul></li>
<li><a href="#heart-related">Heart related</a><ul>
<li><a href="#cluster-1">cluster 1</a></li>
<li><a href="#cluster-14">cluster 14</a></li>
</ul></li>
<li><a href="#skin-related">Skin related</a></li>
<li><a href="#session-information">Session information</a></li>
</ul>
</div>

<!-- The file analysis/chunks.R contains chunks that define default settings
shared across the workflowr files. -->
<!-- Update knitr chunk options -->
<!-- Insert the date the file was last updated -->
<p><strong>Last updated:</strong> 2017-05-27</p>
<!-- Insert the code version (Git commit SHA1) if Git repository exists and R
 package git2r is installed -->
<p><strong>Code version:</strong> cedfc43</p>
<p>In this script, we try to perform some gene set enrichment analysis of the CountClust clusters with respect to the CorShrink patterns observed</p>
<pre class="r"><code>ash_cor_result &lt;- get(load(&quot;../output/ash_cor_only_voom_pearson_halfuniform_gtex_tissues.rda&quot;))
common_samples &lt;- get(load(&quot;../output/common_samples.rda&quot;))
tissue_labels &lt;- read.table(file = &quot;../data/GTEX_V6/samples_id.txt&quot;)[,3]

#library(data.table)
#data &lt;- data.frame(fread(&quot;../data/GTEX_V6/cis_gene_expression.txt&quot;))
#matdata &lt;- t(data[,-c(1,2)])

gene_names &lt;- as.character(read.table(file = &quot;../data/GTEX_V6/gene_names_GTEX_V6.txt&quot;)[,1])
gene_names_1 &lt;- as.character(sapply(gene_names, function(x) return(strsplit(x, &quot;[.]&quot;)[[1]][1])))


U &lt;- unique(tissue_labels)</code></pre>
<div id="brain-related" class="section level2">
<h2>Brain related</h2>
<pre class="r"><code>#####################  Brain high  ############################

tab &lt;- array(0, dim(ash_cor_result)[3])
for(m in 1:dim(ash_cor_result)[3]){
  temp &lt;- ash_cor_result[order_index[1:13], order_index[(1:13)],m]
  tab[m] &lt;-  median(temp[row(temp) &gt; col(temp)])
}

tval &lt;- (tab - mean(tab))/sd(tab)
names(tval) &lt;- gene_names_1</code></pre>
<pre class="r"><code>cluster_list &lt;- vector(mode = &quot;list&quot;, length = 20)
for(l in 1:20){
  cluster_list[[l]] &lt;- as.character(read.table(paste0(&quot;../utilities/gene_names_clus_&quot;, l, &quot;.txt&quot;))[,1])
}

related_genes &lt;- c();
for(l in 1:length(cluster_list)){
  related_genes &lt;- c(related_genes, cluster_list[[l]]);
}
related_genes &lt;- unique(related_genes)

other_genes &lt;- setdiff(gene_names_1, related_genes)

cluster_list[[7]] &lt;- sample(other_genes, 100, replace = FALSE)


library(fgsea)</code></pre>
<pre><code>Loading required package: Rcpp</code></pre>
<pre class="r"><code>out &lt;- fgsea(pathways = cluster_list,
             stats = tval,
             nperm = 10000)

out</code></pre>
<pre><code>            pval         padj         ES        NES nMoreExtreme size
 1: 0.0001523229 0.0007705348  0.4366438  1.8611967            0  100
 2: 0.0002924832 0.0009766579 -0.3983731 -1.8820443            0  102
 3: 0.0048743336 0.0097486672  0.3753964  1.6001294           31  100
 4: 0.0002929974 0.0009766579 -0.4637046 -2.1845901            0  101
 5: 0.0421879546 0.0649045456 -0.2834399 -1.3343385          144  100
 6: 0.0140391927 0.0255258050 -0.3098733 -1.4639425           47  102
 7: 0.6980959634 0.7348378563  0.2063487  0.8795626         4582  100
 8: 0.1522234026 0.1902792533  0.2840250  1.2129475         1002  101
 9: 0.0014547571 0.0036368926 -0.3489673 -1.6428195            4  100
10: 0.2545316070 0.2994489494  0.2628932  1.1205839         1670  100
11: 0.1387838231 0.1850450975 -0.2514760 -1.1838634          476  100
12: 0.0726969191 0.1038527416  0.3078022  1.3144897          478  101
13: 0.8265041889 0.8265041889  0.1907827  0.8132123         5425  100
14: 0.0011638056 0.0033251590 -0.3613619 -1.7011692            3  100
15: 0.0417364813 0.0649045456  0.3236580  1.3795943          273  100
16: 0.0001519064 0.0007705348  0.4388910  1.8759816            0  102
17: 0.0001519064 0.0007705348  0.7086071  3.0288471            0  102
18: 0.4560548363 0.5067275958  0.2342652  0.9985569         2993  100
19: 0.0001541070 0.0007705348  0.4790927  2.0077942            0   90
20: 0.0033511043 0.0074468985  0.3827156  1.6313275           21  100
                                                                                         leadingEdge
 1: ENSG00000215513,ENSG00000099622,ENSG00000174652,ENSG00000113369,ENSG00000120738,ENSG00000177606,
 2: ENSG00000132879,ENSG00000163032,ENSG00000162545,ENSG00000204681,ENSG00000187189,ENSG00000171867,
 3: ENSG00000165507,ENSG00000167772,ENSG00000178878,ENSG00000147872,ENSG00000205362,ENSG00000100336,
 4: ENSG00000213160,ENSG00000213160,ENSG00000112658,ENSG00000198624,ENSG00000163681,ENSG00000064999,
 5: ENSG00000136999,ENSG00000112562,ENSG00000164761,ENSG00000151468,ENSG00000106809,ENSG00000255905,
 6: ENSG00000196407,ENSG00000106123,ENSG00000130940,ENSG00000125898,ENSG00000179859,ENSG00000178934,
 7: ENSG00000180198,ENSG00000204169,ENSG00000197905,ENSG00000124160,ENSG00000075131,ENSG00000137434,
 8: ENSG00000149257,ENSG00000175592,ENSG00000173530,ENSG00000148926,ENSG00000083444,ENSG00000044574,
 9: ENSG00000105290,ENSG00000154945,ENSG00000179195,ENSG00000165424,ENSG00000147533,ENSG00000026652,
10: ENSG00000197142,ENSG00000144381,ENSG00000155850,ENSG00000090920,ENSG00000172831,ENSG00000066230,
11: ENSG00000158079,ENSG00000189058,ENSG00000143344,ENSG00000138434,ENSG00000203485,ENSG00000164764,
12: ENSG00000077150,ENSG00000137959,ENSG00000231389,ENSG00000137804,ENSG00000240342,ENSG00000118503,
13: ENSG00000132141,ENSG00000134202,ENSG00000128944,ENSG00000204390,ENSG00000184378,ENSG00000115138,
14: ENSG00000134571,ENSG00000143499,ENSG00000106617,ENSG00000241837,ENSG00000148677,ENSG00000131143,
15: ENSG00000106211,ENSG00000143546,ENSG00000149573,ENSG00000134531,ENSG00000258232,ENSG00000167553,
16: ENSG00000101187,ENSG00000108342,ENSG00000134470,ENSG00000068001,ENSG00000128016,ENSG00000108691,
17: ENSG00000204525,ENSG00000018280,ENSG00000185201,ENSG00000163220,ENSG00000171051,ENSG00000163221,
18: ENSG00000156968,ENSG00000100219,ENSG00000112312,ENSG00000260065,ENSG00000218510,ENSG00000171105,
19: ENSG00000132002,ENSG00000135245,ENSG00000244734,ENSG00000187010,ENSG00000206172,ENSG00000011422,
20: ENSG00000105697,ENSG00000047457,ENSG00000197249,ENSG00000159403,ENSG00000182326,ENSG00000171236,</code></pre>
<p>It is dominated by the Clusters 17 and 19 which are blood related tissues in terms of positive effects. We need to carry out more focussed analysis.</p>
</div>
<div id="high-intra-corr-in-brain-low-intra-corr-in-others" class="section level2">
<h2>High intra corr in Brain, low intra corr in others</h2>
<pre class="r"><code>#####################  Brain high, others low  ############################

tab &lt;- array(0, dim(ash_cor_result)[3])
for(m in 1:dim(ash_cor_result)[3]){
  temp &lt;- ash_cor_result[order_index[1:13], order_index[(1:13)],m]
  temp1 &lt;- ash_cor_result[order_index[-(1:13)], order_index[-(1:13)],m]
  tab[m] &lt;- median(temp[row(temp) &gt; col(temp)]) - median(temp1[row(temp1) &gt; col(temp1)])
}

tval &lt;- (tab - mean(tab))/sd(tab)
names(tval) &lt;- gene_names_1</code></pre>
<pre class="r"><code>cluster_list &lt;- vector(mode = &quot;list&quot;, length = 20)
for(l in 1:20){
  cluster_list[[l]] &lt;- as.character(read.table(paste0(&quot;../utilities/gene_names_clus_&quot;, l, &quot;.txt&quot;))[,1])
}

related_genes &lt;- c();
for(l in 1:length(cluster_list)){
  related_genes &lt;- c(related_genes, cluster_list[[l]]);
}
related_genes &lt;- unique(related_genes)

other_genes &lt;- setdiff(gene_names_1, related_genes)

cluster_list[[7]] &lt;- sample(other_genes, 100, replace = FALSE)


library(fgsea)
out &lt;- fgsea(pathways = cluster_list,
             stats = tval,
             nperm = 10000)

out</code></pre>
<pre><code>            pval         padj         ES        NES nMoreExtreme size
 1: 0.6286258424 0.6984731582  0.2114232  0.9109936         4290  100
 2: 0.2586860392 0.3695514845 -0.2286283 -1.0939664          818  102
 3: 0.0001464987 0.0007324934  0.4854141  2.0915832            0  100
 4: 0.4133079291 0.5224180807  0.2365765  1.0215469         2819  101
 5: 0.0413126282 0.0751138694  0.3219232  1.3871235          281  100
 6: 0.4179344646 0.5224180807  0.2357138  1.0206009         2856  102
 7: 0.9023929471 0.9023929471 -0.1668585 -0.7962350         2865  100
 8: 0.0010259417 0.0034198056  0.4071460  1.7580731            6  101
 9: 0.0295969773 0.0591939547 -0.2843741 -1.3570099           93  100
10: 0.0055669499 0.0159055711  0.3760376  1.6202949           37  100
11: 0.0691473777 0.1063805810  0.3064099  1.3202786          471  100
12: 0.4481899458 0.5272822891  0.2323423  1.0032633         3057  101
13: 0.0547858942 0.0913098237 -0.2731504 -1.3034513          173  100
14: 0.8904189862 0.9023929471  0.1783670  0.7685592         6077  100
15: 0.0001464987 0.0007324934  0.5560112  2.3957768            0  100
16: 0.0001462844 0.0007324934  0.5546165  2.4013964            0  102
17: 0.0001462844 0.0007324934  0.6547553  2.8349805            0  102
18: 0.0150893642 0.0335319204  0.3513747  1.5140258          102  100
19: 0.0063864548 0.0159661369  0.3822779  1.6183359           42   90
20: 0.0002929974 0.0011719895  0.4274384  1.8417738            1  100
                                                                                         leadingEdge
 1: ENSG00000120738,ENSG00000177606,ENSG00000176046,ENSG00000099622,ENSG00000113369,ENSG00000112715,
 2: ENSG00000127585,ENSG00000132535,ENSG00000109472,ENSG00000168993,ENSG00000131771,ENSG00000137267,
 3: ENSG00000123689,ENSG00000146674,ENSG00000166819,ENSG00000178878,ENSG00000165507,ENSG00000257607,
 4: ENSG00000213949,ENSG00000128272,ENSG00000103852,ENSG00000073712,ENSG00000163431,ENSG00000129116,
 5: ENSG00000099860,ENSG00000171223,ENSG00000198959,ENSG00000072952,ENSG00000161638,ENSG00000143878,
 6: ENSG00000170345,ENSG00000114315,ENSG00000142178,ENSG00000136826,ENSG00000112378,ENSG00000136235,
 7: ENSG00000178127,ENSG00000161800,ENSG00000173915,ENSG00000221819,ENSG00000272817,ENSG00000159314,
 8: ENSG00000134013,ENSG00000175592,ENSG00000173530,ENSG00000182718,ENSG00000149257,ENSG00000148926,
 9: ENSG00000151552,ENSG00000154945,ENSG00000180354,ENSG00000011426,ENSG00000157827,ENSG00000047849,
10: ENSG00000197142,ENSG00000155850,ENSG00000090920,ENSG00000172831,ENSG00000149809,ENSG00000144381,
11: ENSG00000132470,ENSG00000177303,ENSG00000091409,ENSG00000269926,ENSG00000168209,ENSG00000105227,
12: ENSG00000137804,ENSG00000118503,ENSG00000077150,ENSG00000019582,ENSG00000112118,ENSG00000109320,
13: ENSG00000157653,ENSG00000163923,ENSG00000183496,ENSG00000117481,ENSG00000135951,ENSG00000176732,
14: ENSG00000127472,ENSG00000172346,ENSG00000109846,ENSG00000135940,ENSG00000120053,ENSG00000172270,
15: ENSG00000134531,ENSG00000106211,ENSG00000149573,ENSG00000164687,ENSG00000258232,ENSG00000171401,
16: ENSG00000108342,ENSG00000128016,ENSG00000144802,ENSG00000134470,ENSG00000068001,ENSG00000108691,
17: ENSG00000107738,ENSG00000125753,ENSG00000141574,ENSG00000100504,ENSG00000100985,ENSG00000137462,
18: ENSG00000112312,ENSG00000100219,ENSG00000156968,ENSG00000051108,ENSG00000171105,ENSG00000150593,
19: ENSG00000132002,ENSG00000011422,ENSG00000135245,ENSG00000187837,ENSG00000240758,ENSG00000132819,
20: ENSG00000105697,ENSG00000047457,ENSG00000182326,ENSG00000124253,ENSG00000159403,ENSG00000197249,</code></pre>
<pre class="r"><code>unlist(lapply(out$leadingEdge, function(x) return(length(x))))</code></pre>
<pre><code> [1]  9 36 34 23 29 24 35 31 45 25 22 22 37 18 39 38 63 30 38 28</code></pre>
<div id="cluster-3" class="section level3">
<h3>cluster 3</h3>
<pre class="r"><code>genes_clus &lt;- cluster_list[[3]][1:9]
#genes_clus &lt;- out$leadingEdge[[1]][1:9]

matched_indices &lt;- match(genes_clus, gene_names_1)
par(mfrow = c(3,3))
for(m in 1:length(matched_indices)){
      col=c(rev(rgb(seq(1,0,length=1000),1,seq(1,0,length=1000))),
          rgb(1,seq(1,0,length=1000),seq(1,0,length=1000)))
    image(as.matrix(ash_cor_result[order_index,order_index, matched_indices[m]]),
          col=col, main=paste0(&quot;corshrink:&quot;, genes_clus[m]), cex.main=2,
          xaxt = &quot;n&quot;, yaxt = &quot;n&quot;, zlim=c(-1,1))
    axis(1, at = seq(0, 1, length.out = 53), labels = U, las=2, cex.axis = 0.5)
    axis(2, at = seq(0, 1, length.out = 53), labels = U, las=2, cex.axis = 0.5)
}</code></pre>
<p><img src="figure/gsea_corshrink_corpcor_2.Rmd/unnamed-chunk-8-1.png" width="672" style="display: block; margin: auto;" /></p>
</div>
<div id="cluster-9" class="section level3">
<h3>cluster 9</h3>
<pre class="r"><code>genes_clus &lt;- cluster_list[[9]][1:9]
#genes_clus &lt;- out$leadingEdge[[1]][1:9]

matched_indices &lt;- match(genes_clus, gene_names_1)
par(mfrow = c(3,3))
for(m in 1:length(matched_indices)){
      col=c(rev(rgb(seq(1,0,length=1000),1,seq(1,0,length=1000))),
          rgb(1,seq(1,0,length=1000),seq(1,0,length=1000)))
    image(as.matrix(ash_cor_result[order_index,order_index, matched_indices[m]]),
          col=col, main=paste0(&quot;corshrink:&quot;, genes_clus[m]), cex.main=2,
          xaxt = &quot;n&quot;, yaxt = &quot;n&quot;, zlim=c(-1,1))
    axis(1, at = seq(0, 1, length.out = 53), labels = U, las=2, cex.axis = 0.5)
    axis(2, at = seq(0, 1, length.out = 53), labels = U, las=2, cex.axis = 0.5)
}</code></pre>
<p><img src="figure/gsea_corshrink_corpcor_2.Rmd/unnamed-chunk-9-1.png" width="672" style="display: block; margin: auto;" /></p>
</div>
<div id="cluster-15" class="section level3">
<h3>cluster 15</h3>
<pre class="r"><code>genes_clus &lt;- cluster_list[[15]][1:9]
#genes_clus &lt;- out$leadingEdge[[1]][1:9]

matched_indices &lt;- match(genes_clus, gene_names_1)
par(mfrow = c(3,3))
for(m in 1:length(matched_indices)){
      col=c(rev(rgb(seq(1,0,length=1000),1,seq(1,0,length=1000))),
          rgb(1,seq(1,0,length=1000),seq(1,0,length=1000)))
    image(as.matrix(ash_cor_result[order_index,order_index, matched_indices[m]]),
          col=col, main=paste0(&quot;corshrink:&quot;, genes_clus[m]), cex.main=2,
          xaxt = &quot;n&quot;, yaxt = &quot;n&quot;, zlim=c(-1,1))
    axis(1, at = seq(0, 1, length.out = 53), labels = U, las=2, cex.axis = 0.5)
    axis(2, at = seq(0, 1, length.out = 53), labels = U, las=2, cex.axis = 0.5)
}</code></pre>
<p><img src="figure/gsea_corshrink_corpcor_2.Rmd/unnamed-chunk-10-1.png" width="672" style="display: block; margin: auto;" /></p>
</div>
<div id="cluster-16" class="section level3">
<h3>cluster 16</h3>
<pre class="r"><code>genes_clus &lt;- cluster_list[[16]][1:9]
#genes_clus &lt;- out$leadingEdge[[1]][1:9]

matched_indices &lt;- match(genes_clus, gene_names_1)
par(mfrow = c(3,3))
for(m in 1:length(matched_indices)){
      col=c(rev(rgb(seq(1,0,length=1000),1,seq(1,0,length=1000))),
          rgb(1,seq(1,0,length=1000),seq(1,0,length=1000)))
    image(as.matrix(ash_cor_result[order_index,order_index, matched_indices[m]]),
          col=col, main=paste0(&quot;corshrink:&quot;, genes_clus[m]), cex.main=2,
          xaxt = &quot;n&quot;, yaxt = &quot;n&quot;, zlim=c(-1,1))
    axis(1, at = seq(0, 1, length.out = 53), labels = U, las=2, cex.axis = 0.5)
    axis(2, at = seq(0, 1, length.out = 53), labels = U, las=2, cex.axis = 0.5)
}</code></pre>
<p><img src="figure/gsea_corshrink_corpcor_2.Rmd/unnamed-chunk-11-1.png" width="672" style="display: block; margin: auto;" /></p>
</div>
<div id="cluster-17" class="section level3">
<h3>cluster 17</h3>
<pre class="r"><code>genes_clus &lt;- cluster_list[[17]][1:9]
#genes_clus &lt;- out$leadingEdge[[1]][1:9]

matched_indices &lt;- match(genes_clus, gene_names_1)
par(mfrow = c(3,3))
for(m in 1:length(matched_indices)){
      col=c(rev(rgb(seq(1,0,length=1000),1,seq(1,0,length=1000))),
          rgb(1,seq(1,0,length=1000),seq(1,0,length=1000)))
    image(as.matrix(ash_cor_result[order_index,order_index, matched_indices[m]]),
          col=col, main=paste0(&quot;corshrink:&quot;, genes_clus[m]), cex.main=2,
          xaxt = &quot;n&quot;, yaxt = &quot;n&quot;, zlim=c(-1,1))
    axis(1, at = seq(0, 1, length.out = 53), labels = U, las=2, cex.axis = 0.5)
    axis(2, at = seq(0, 1, length.out = 53), labels = U, las=2, cex.axis = 0.5)
}</code></pre>
<p><img src="figure/gsea_corshrink_corpcor_2.Rmd/unnamed-chunk-12-1.png" width="672" style="display: block; margin: auto;" /></p>
<p>Which tissues do these clusters corrsspond to?</p>
<p>clusters 15, 16 mainly correspond to Esophagus Mucosa and Lung. Cluster 3 corresponds to Breast and Adipose - the fatty issues. Cluster 9, which is one of the rare clusters with strong negative effect in gsea corresponds to the Brain-spinal cord genes, which we know have less correlation among the brain tissues.</p>
</div>
</div>
<div id="high-brain-vs-other-tissues" class="section level2">
<h2>High Brain vs other tissues</h2>
<pre class="r"><code>tab &lt;- array(0, dim(ash_cor_result)[3])
for(m in 1:dim(ash_cor_result)[3]){
  temp &lt;- ash_cor_result[order_index[1:13], order_index[-(1:13)],m]
  tab[m] &lt;- median(temp[row(temp) &gt; col(temp)])
}

tval &lt;- (tab - mean(tab))/sd(tab)
names(tval) &lt;- gene_names_1</code></pre>
<pre class="r"><code>cluster_list &lt;- vector(mode = &quot;list&quot;, length = 20)
for(l in 1:20){
  cluster_list[[l]] &lt;- as.character(read.table(paste0(&quot;../utilities/gene_names_clus_&quot;, l, &quot;.txt&quot;))[,1])
}

related_genes &lt;- c();
for(l in 1:length(cluster_list)){
  related_genes &lt;- c(related_genes, cluster_list[[l]]);
}
related_genes &lt;- unique(related_genes)

other_genes &lt;- setdiff(gene_names_1, related_genes)

cluster_list[[7]] &lt;- sample(other_genes, 100, replace = FALSE)


library(fgsea)
out &lt;- fgsea(pathways = cluster_list,
             stats = tval,
             nperm = 10000)

out</code></pre>
<pre><code>            pval        padj         ES        NES nMoreExtreme size
 1: 0.0001194886 0.001194886  0.5741232  2.0743417            0  100
 2: 0.0006188119 0.001375138 -0.4234979 -2.0246803            0  102
 3: 0.8065479747 0.848997868  0.2166923  0.7829225         6749  100
 4: 0.0006157635 0.001375138 -0.6477103 -3.0872922            0  101
 5: 0.0006123699 0.001375138 -0.4829877 -2.2951245            0  100
 6: 0.0006188119 0.001375138 -0.4124762 -1.9719874            0  102
 7: 0.2954952802 0.369369100  0.3094154  1.1179365         2472  100
 8: 0.4156403941 0.488988699 -0.2117457 -1.0092795          674  101
 9: 0.0024494795 0.004453599 -0.3492849 -1.6597781            3  100
10: 0.0079608083 0.013268014 -0.3208905 -1.5248498           12  100
11: 0.0012247397 0.002449479 -0.3654892 -1.7367796            1  100
12: 0.0798519933 0.114074276  0.3729792  1.3495968          668  101
13: 0.0235392520 0.036214234  0.4124659  1.4902644          196  100
14: 0.0006123699 0.001375138 -0.4875861 -2.3169755            0  100
15: 0.0006123699 0.001375138 -0.4171861 -1.9824397            0  100
16: 0.6063677558 0.673741951  0.2519919  0.9125588         5084  102
17: 0.0001192464 0.001194886  0.6137565  2.2226462            0  102
18: 0.9389413311 0.938941331  0.1867619  0.6747822         7857  100
19: 0.0004882812 0.001375138  0.5217009  1.8555463            3   90
20: 0.2816901408 0.369369100 -0.2258137 -1.0730512          459  100
                                                                                         leadingEdge
 1: ENSG00000215513,ENSG00000174652,ENSG00000203875,ENSG00000099622,ENSG00000152117,ENSG00000127483,
 2: ENSG00000135439,ENSG00000171867,ENSG00000136854,ENSG00000227051,ENSG00000117016,ENSG00000137267,
 3: ENSG00000205362,ENSG00000147872,ENSG00000167772,ENSG00000165507,ENSG00000119185,ENSG00000178878,
 4: ENSG00000259627,ENSG00000075073,ENSG00000116473,ENSG00000213160,ENSG00000213160,ENSG00000111696,
 5: ENSG00000038427,ENSG00000142910,ENSG00000166482,ENSG00000026025,ENSG00000115380,ENSG00000135547,
 6: ENSG00000108379,ENSG00000108379,ENSG00000268751,ENSG00000069667,ENSG00000178184,ENSG00000118402,
 7: ENSG00000223482,ENSG00000204632,ENSG00000236496,ENSG00000183666,ENSG00000268903,ENSG00000132530,
 8: ENSG00000189184,ENSG00000134013,ENSG00000139926,ENSG00000182718,ENSG00000166073,ENSG00000143387,
 9: ENSG00000101439,ENSG00000262967,ENSG00000049089,ENSG00000115993,ENSG00000141540,ENSG00000122545,
10: ENSG00000161013,ENSG00000073350,ENSG00000167986,ENSG00000102837,ENSG00000120756,ENSG00000103018,
11: ENSG00000221857,ENSG00000158079,ENSG00000034971,ENSG00000104067,ENSG00000143842,ENSG00000163113,
12: ENSG00000137959,ENSG00000240342,ENSG00000137965,ENSG00000157601,ENSG00000111331,ENSG00000077150,
13: ENSG00000132141,ENSG00000125618,ENSG00000134202,ENSG00000189269,ENSG00000111254,ENSG00000223839,
14: ENSG00000135940,ENSG00000198336,ENSG00000182809,ENSG00000133065,ENSG00000127184,ENSG00000272030,
15: ENSG00000172382,ENSG00000123159,ENSG00000136810,ENSG00000143369,ENSG00000133710,ENSG00000205420,
16: ENSG00000101187,ENSG00000108342,ENSG00000143570,ENSG00000267607,ENSG00000090339,ENSG00000134470,
17: ENSG00000204525,ENSG00000018280,ENSG00000163220,ENSG00000249437,ENSG00000237683,ENSG00000163221,
18: ENSG00000218510,ENSG00000260065,ENSG00000237940,ENSG00000103226,ENSG00000186275,ENSG00000142102,
19: ENSG00000187010,ENSG00000244734,ENSG00000188536,ENSG00000206172,ENSG00000239839,ENSG00000239839,
20: ENSG00000136872,ENSG00000091583,ENSG00000105697,ENSG00000132541,ENSG00000118137,ENSG00000139547,</code></pre>
<p>The ones with high positive effects are Clusters 17 and 19, which are both shared by blood. There are several clusters with high negative effects such as Cluster 14 (Heart), clusters 2 and 9 (Brain specific), Cluster 4 (Colon, Cervix etc), Cluster 5 (Artery) and Cluster 6 (Skin), which is a wide raneg of tissue specific genes. Blood seems to be the exception, which sort of makes sense, because blood may be contaminated with brain tissues.</p>
<div id="cluster-17-1" class="section level3">
<h3>cluster 17</h3>
<pre class="r"><code>genes_clus &lt;- cluster_list[[17]][1:9]
#genes_clus &lt;- out$leadingEdge[[1]][1:9]

matched_indices &lt;- match(genes_clus, gene_names_1)
par(mfrow = c(3,3))
for(m in 1:length(matched_indices)){
      col=c(rev(rgb(seq(1,0,length=1000),1,seq(1,0,length=1000))),
          rgb(1,seq(1,0,length=1000),seq(1,0,length=1000)))
    image(as.matrix(ash_cor_result[order_index,order_index, matched_indices[m]]),
          col=col, main=paste0(&quot;corshrink:&quot;, genes_clus[m]), cex.main=2,
          xaxt = &quot;n&quot;, yaxt = &quot;n&quot;, zlim=c(-1,1))
    axis(1, at = seq(0, 1, length.out = 53), labels = U, las=2, cex.axis = 0.5)
    axis(2, at = seq(0, 1, length.out = 53), labels = U, las=2, cex.axis = 0.5)
}</code></pre>
<p><img src="figure/gsea_corshrink_corpcor_2.Rmd/unnamed-chunk-15-1.png" width="672" style="display: block; margin: auto;" /></p>
</div>
<div id="cluster-19" class="section level3">
<h3>cluster 19</h3>
<pre class="r"><code>genes_clus &lt;- cluster_list[[19]][1:9]
#genes_clus &lt;- out$leadingEdge[[1]][1:9]

matched_indices &lt;- match(genes_clus, gene_names_1)
par(mfrow = c(3,3))
for(m in 1:length(matched_indices)){
      col=c(rev(rgb(seq(1,0,length=1000),1,seq(1,0,length=1000))),
          rgb(1,seq(1,0,length=1000),seq(1,0,length=1000)))
    image(as.matrix(ash_cor_result[order_index,order_index, matched_indices[m]]),
          col=col, main=paste0(&quot;corshrink:&quot;, genes_clus[m]), cex.main=2,
          xaxt = &quot;n&quot;, yaxt = &quot;n&quot;, zlim=c(-1,1))
    axis(1, at = seq(0, 1, length.out = 53), labels = U, las=2, cex.axis = 0.5)
    axis(2, at = seq(0, 1, length.out = 53), labels = U, las=2, cex.axis = 0.5)
}</code></pre>
<p><img src="figure/gsea_corshrink_corpcor_2.Rmd/unnamed-chunk-16-1.png" width="672" style="display: block; margin: auto;" /></p>
</div>
<div id="cluster-4" class="section level3">
<h3>cluster 4</h3>
<pre class="r"><code>genes_clus &lt;- cluster_list[[4]][1:9]
#genes_clus &lt;- out$leadingEdge[[1]][1:9]

matched_indices &lt;- match(genes_clus, gene_names_1)
par(mfrow = c(3,3))
for(m in 1:length(matched_indices)){
      col=c(rev(rgb(seq(1,0,length=1000),1,seq(1,0,length=1000))),
          rgb(1,seq(1,0,length=1000),seq(1,0,length=1000)))
    image(as.matrix(ash_cor_result[order_index,order_index, matched_indices[m]]),
          col=col, main=paste0(&quot;corshrink:&quot;, genes_clus[m]), cex.main=2,
          xaxt = &quot;n&quot;, yaxt = &quot;n&quot;, zlim=c(-1,1))
    axis(1, at = seq(0, 1, length.out = 53), labels = U, las=2, cex.axis = 0.5)
    axis(2, at = seq(0, 1, length.out = 53), labels = U, las=2, cex.axis = 0.5)
}</code></pre>
<p><img src="figure/gsea_corshrink_corpcor_2.Rmd/unnamed-chunk-17-1.png" width="672" style="display: block; margin: auto;" /></p>
</div>
</div>
<div id="heart-related" class="section level2">
<h2>Heart related</h2>
<pre class="r"><code>tab &lt;- array(0, dim(ash_cor_result)[3])
for(m in 1:dim(ash_cor_result)[3]){
  tab[m] &lt;- ash_cor_result[32, 33 ,m]
}

tval &lt;- (tab - mean(tab))/sd(tab)
names(tval) &lt;- gene_names_1</code></pre>
<pre class="r"><code>cluster_list &lt;- vector(mode = &quot;list&quot;, length = 20)
for(l in 1:20){
  cluster_list[[l]] &lt;- as.character(read.table(paste0(&quot;../utilities/gene_names_clus_&quot;, l, &quot;.txt&quot;))[,1])
}

related_genes &lt;- c();
for(l in 1:length(cluster_list)){
  related_genes &lt;- c(related_genes, cluster_list[[l]]);
}
related_genes &lt;- unique(related_genes)

other_genes &lt;- setdiff(gene_names_1, related_genes)

cluster_list[[7]] &lt;- sample(other_genes, 100, replace = FALSE)


library(fgsea)
out &lt;- fgsea(pathways = cluster_list,
             stats = tval,
             nperm = 10000)

out</code></pre>
<pre><code>            pval        padj         ES        NES nMoreExtreme size
 1: 0.0002072109 0.002072109  0.5537910  2.5449335            0  100
 2: 0.2352696232 0.361953266  0.2444968  1.1262943         1129  102
 3: 0.2579776212 0.368539459  0.2418507  1.1114194         1244  100
 4: 0.2115718419 0.352619736 -0.2497183 -1.1425802         1096  101
 5: 0.3885239567 0.485654946 -0.2265676 -1.0352176         2010  100
 6: 0.1090594345 0.311598384 -0.2675381 -1.2268891          566  102
 7: 0.4414605873 0.519365397 -0.2208321 -1.0090111         2284  100
 8: 0.6358729500 0.669339947  0.2000422  0.9210144         3062  101
 9: 0.9875673436 0.987567344  0.1467320  0.6743033         4765  100
10: 0.5170015456 0.574446162 -0.2129348 -0.9729272         2675  100
11: 0.1726067136 0.352619736  0.2554156  1.1737563          832  100
12: 0.1787419556 0.352619736  0.2545678  1.1720556          860  101
13: 0.1962287609 0.352619736  0.2512739  1.1547232          946  100
14: 0.0001931994 0.002072109 -0.5094508 -2.3277487            0  100
15: 0.0376738794 0.147475528 -0.2987380 -1.3649737          194  100
16: 0.3158442640 0.421125685  0.2327390  1.0721309         1516  102
17: 0.2023735166 0.352619736  0.2499125  1.1512419          971  102
18: 0.0442426584 0.147475528 -0.2951581 -1.3486168          228  100
19: 0.0012383901 0.008255934  0.3812400  1.7216135            5   90
20: 0.0231839258 0.115919629 -0.3118701 -1.4249760          119  100
                                                                                         leadingEdge
 1: ENSG00000215513,ENSG00000203875,ENSG00000117616,ENSG00000013441,ENSG00000167766,ENSG00000108773,
 2: ENSG00000167371,ENSG00000132535,ENSG00000139899,ENSG00000072832,ENSG00000131584,ENSG00000129244,
 3: ENSG00000157150,ENSG00000167772,ENSG00000164056,ENSG00000119185,ENSG00000135678,ENSG00000100336,
 4: ENSG00000156113,ENSG00000121067,ENSG00000182253,ENSG00000269936,ENSG00000073712,ENSG00000163637,
 5: ENSG00000115457,ENSG00000169504,ENSG00000118762,ENSG00000122176,ENSG00000140836,ENSG00000143127,
 6: ENSG00000188508,ENSG00000161249,ENSG00000136826,ENSG00000143537,ENSG00000118402,ENSG00000108379,
 7: ENSG00000251624,ENSG00000269949,ENSG00000134371,ENSG00000109118,ENSG00000246067,ENSG00000090530,
 8: ENSG00000149257,ENSG00000111799,ENSG00000198431,ENSG00000163661,ENSG00000011028,ENSG00000168140,
 9: ENSG00000225972,ENSG00000255823,ENSG00000184007,ENSG00000164402,ENSG00000141540,ENSG00000167191,
10: ENSG00000161013,ENSG00000142959,ENSG00000172831,ENSG00000170421,ENSG00000148795,ENSG00000166920,
11: ENSG00000145675,ENSG00000101347,ENSG00000145390,ENSG00000126391,ENSG00000090006,ENSG00000157368,
12: ENSG00000137959,ENSG00000157601,ENSG00000077150,ENSG00000187608,ENSG00000111331,ENSG00000240342,
13: ENSG00000134202,ENSG00000132141,ENSG00000125618,ENSG00000128944,ENSG00000273142,ENSG00000204536,
14: ENSG00000135940,ENSG00000116688,ENSG00000114784,ENSG00000090266,ENSG00000152234,ENSG00000109846,
15: ENSG00000197191,ENSG00000069020,ENSG00000186806,ENSG00000169474,ENSG00000172382,ENSG00000139289,
16: ENSG00000176907,ENSG00000142748,ENSG00000101187,ENSG00000145506,ENSG00000019991,ENSG00000152527,
17: ENSG00000204525,ENSG00000105639,ENSG00000115590,ENSG00000163221,ENSG00000105835,ENSG00000204936,
18: ENSG00000219073,ENSG00000175535,ENSG00000167653,ENSG00000205213,ENSG00000164266,ENSG00000157017,
19: ENSG00000188536,ENSG00000244734,ENSG00000115523,ENSG00000206172,ENSG00000187010,ENSG00000223609,
20: ENSG00000117594,ENSG00000149131,ENSG00000106927,ENSG00000141505,ENSG00000000971,ENSG00000235910,</code></pre>
<div id="cluster-1" class="section level3">
<h3>cluster 1</h3>
<pre class="r"><code>genes_clus &lt;- cluster_list[[1]][1:9]
#genes_clus &lt;- out$leadingEdge[[1]][1:9]

matched_indices &lt;- match(genes_clus, gene_names_1)
par(mfrow = c(3,3))
for(m in 1:length(matched_indices)){
      col=c(rev(rgb(seq(1,0,length=1000),1,seq(1,0,length=1000))),
          rgb(1,seq(1,0,length=1000),seq(1,0,length=1000)))
    image(as.matrix(ash_cor_result[order_index,order_index, matched_indices[m]]),
          col=col, main=paste0(&quot;corshrink:&quot;, genes_clus[m]), cex.main=2,
          xaxt = &quot;n&quot;, yaxt = &quot;n&quot;, zlim=c(-1,1))
    axis(1, at = seq(0, 1, length.out = 53), labels = U, las=2, cex.axis = 0.5)
    axis(2, at = seq(0, 1, length.out = 53), labels = U, las=2, cex.axis = 0.5)
}</code></pre>
<p><img src="figure/gsea_corshrink_corpcor_2.Rmd/unnamed-chunk-20-1.png" width="672" style="display: block; margin: auto;" /></p>
</div>
<div id="cluster-14" class="section level3">
<h3>cluster 14</h3>
<pre class="r"><code>genes_clus &lt;- cluster_list[[2]][1:9]
#genes_clus &lt;- out$leadingEdge[[1]][1:9]

matched_indices &lt;- match(genes_clus, gene_names_1)
par(mfrow = c(3,3))
for(m in 1:length(matched_indices)){
      col=c(rev(rgb(seq(1,0,length=1000),1,seq(1,0,length=1000))),
          rgb(1,seq(1,0,length=1000),seq(1,0,length=1000)))
    image(as.matrix(ash_cor_result[order_index,order_index, matched_indices[m]]),
          col=col, main=paste0(&quot;corshrink:&quot;, genes_clus[m]), cex.main=2,
          xaxt = &quot;n&quot;, yaxt = &quot;n&quot;, zlim=c(-1,1))
    axis(1, at = seq(0, 1, length.out = 53), labels = U, las=2, cex.axis = 0.5)
    axis(2, at = seq(0, 1, length.out = 53), labels = U, las=2, cex.axis = 0.5)
}</code></pre>
<p><img src="figure/gsea_corshrink_corpcor_2.Rmd/unnamed-chunk-21-1.png" width="672" style="display: block; margin: auto;" /></p>
</div>
</div>
<div id="skin-related" class="section level2">
<h2>Skin related</h2>
<pre class="r"><code>tab &lt;- array(0, dim(ash_cor_result)[3])
for(m in 1:dim(ash_cor_result)[3]){
  tab[m] &lt;- ash_cor_result[44, 45, m]
}

tval &lt;- (tab - mean(tab))/sd(tab)
names(tval) &lt;- gene_names_1</code></pre>
<pre class="r"><code>cluster_list &lt;- vector(mode = &quot;list&quot;, length = 20)
for(l in 1:20){
  cluster_list[[l]] &lt;- as.character(read.table(paste0(&quot;../utilities/gene_names_clus_&quot;, l, &quot;.txt&quot;))[,1])
}

related_genes &lt;- c();
for(l in 1:length(cluster_list)){
  related_genes &lt;- c(related_genes, cluster_list[[l]]);
}
related_genes &lt;- unique(related_genes)

other_genes &lt;- setdiff(gene_names_1, related_genes)

cluster_list[[7]] &lt;- sample(other_genes, 100, replace = FALSE)


library(fgsea)
out &lt;- fgsea(pathways = cluster_list,
             stats = tval,
             nperm = 10000)

out</code></pre>
<pre><code>            pval        padj         ES        NES nMoreExtreme size
 1: 0.8397953159 0.883995069  0.1857203  0.8238636         4266  100
 2: 0.9725946372 0.972594637  0.1606194  0.7140541         4932  102
 3: 0.0007872466 0.003148986  0.3893288  1.7270800            3  100
 4: 0.0002030045 0.001016054 -0.5943756 -2.6325496            0  101
 5: 0.0002032107 0.001016054 -0.4528034 -2.0011214            0  100
 6: 0.0918864097 0.167066200 -0.2824580 -1.2544084          452  102
 7: 0.0719365983 0.143873197 -0.2908295 -1.2852932          353  100
 8: 0.0025610717 0.007317348  0.3630862  1.6123555           12  101
 9: 0.2826215312 0.434802356  0.2454625  1.0888830         1435  100
10: 0.4839598504 0.645279801  0.2216913  0.9834329         2458  100
11: 0.4420389687 0.631484241  0.2262474  1.0036439         2245  100
12: 0.0025610717 0.007317348  0.3632494  1.6130801           12  101
13: 0.8114204430 0.883995069 -0.1886961 -0.8339245         3992  100
14: 0.0002032107 0.001016054 -0.4742809 -2.0960393            0  100
15: 0.7256655151 0.853724135 -0.1985958 -0.8776754         3570  100
16: 0.0102523659 0.025630915  0.3372326  1.4992109           51  102
17: 0.0001971609 0.001016054  0.4283507  1.9042880            0  102
18: 0.7120645542 0.853724135  0.1999975  0.8871981         3617  100
19: 0.2158486103 0.359747684  0.2623648  1.1408387         1094   90
20: 0.0352292856 0.078287301  0.3083349  1.3677875          178  100
                                                                                         leadingEdge
 1: ENSG00000203875,ENSG00000215513,ENSG00000092068,ENSG00000174652,ENSG00000113369,ENSG00000137077,
 2: ENSG00000112139,ENSG00000139899,ENSG00000227051,ENSG00000163032,ENSG00000160014,ENSG00000160014,
 3: ENSG00000135821,ENSG00000117289,ENSG00000196715,ENSG00000205362,ENSG00000112964,ENSG00000135678,
 4: ENSG00000010803,ENSG00000151240,ENSG00000092841,ENSG00000163017,ENSG00000157110,ENSG00000163637,
 5: ENSG00000197380,ENSG00000122176,ENSG00000163453,ENSG00000245067,ENSG00000172348,ENSG00000169504,
 6: ENSG00000167768,ENSG00000171680,ENSG00000186395,ENSG00000143367,ENSG00000173338,ENSG00000223989,
 7: ENSG00000187952,ENSG00000249435,ENSG00000143776,ENSG00000091436,ENSG00000162004,ENSG00000230772,
 8: ENSG00000107984,ENSG00000091136,ENSG00000163661,ENSG00000272761,ENSG00000138119,ENSG00000091986,
 9: ENSG00000225972,ENSG00000225630,ENSG00000237973,ENSG00000168309,ENSG00000255823,ENSG00000143772,
10: ENSG00000147804,ENSG00000167600,ENSG00000104267,ENSG00000114650,ENSG00000211895,ENSG00000196365,
11: ENSG00000119138,ENSG00000145675,ENSG00000107372,ENSG00000101347,ENSG00000070731,ENSG00000134121,
12: ENSG00000077150,ENSG00000023445,ENSG00000146232,ENSG00000100297,ENSG00000240342,ENSG00000231389,
13: ENSG00000087460,ENSG00000260001,ENSG00000219435,ENSG00000204390,ENSG00000089199,ENSG00000259384,
14: ENSG00000189043,ENSG00000127472,ENSG00000159251,ENSG00000163644,ENSG00000175206,ENSG00000126267,
15: ENSG00000135046,ENSG00000111215,ENSG00000162078,ENSG00000169509,ENSG00000143556,ENSG00000170477,
16: ENSG00000101187,ENSG00000145506,ENSG00000108691,ENSG00000073756,ENSG00000174640,ENSG00000090339,
17: ENSG00000204525,ENSG00000249437,ENSG00000134686,ENSG00000141574,ENSG00000018280,ENSG00000177663,
18: ENSG00000171105,ENSG00000114115,ENSG00000187840,ENSG00000171766,ENSG00000112312,ENSG00000260065,
19: ENSG00000187010,ENSG00000103148,ENSG00000133606,ENSG00000206172,ENSG00000188536,ENSG00000256269,
20: ENSG00000169738,ENSG00000167711,ENSG00000166741,ENSG00000130649,ENSG00000104635,ENSG00000138356,</code></pre>
</div>
<div id="session-information" class="section level2">
<h2>Session information</h2>
<!-- Insert the session information into the document -->
<pre class="r"><code>sessionInfo()</code></pre>
<pre><code>R version 3.3.3 (2017-03-06)
Platform: x86_64-apple-darwin13.4.0 (64-bit)
Running under: macOS Sierra 10.12

locale:
[1] en_US.UTF-8/en_US.UTF-8/en_US.UTF-8/C/en_US.UTF-8/en_US.UTF-8

attached base packages:
[1] stats     graphics  grDevices utils     datasets  methods   base     

other attached packages:
[1] fgsea_1.1.2  Rcpp_0.12.11

loaded via a namespace (and not attached):
 [1] knitr_1.15.1       magrittr_1.5       munsell_0.4.3     
 [4] BiocParallel_1.8.2 colorspace_1.3-2   rlang_0.1.1.9000  
 [7] fastmatch_1.1-0    stringr_1.2.0      plyr_1.8.4        
[10] tools_3.3.3        parallel_3.3.3     grid_3.3.3        
[13] data.table_1.10.4  gtable_0.2.0       git2r_0.18.0      
[16] htmltools_0.3.6    yaml_2.1.14        lazyeval_0.2.0    
[19] rprojroot_1.2      digest_0.6.12      tibble_1.3.1      
[22] gridExtra_2.2.1    ggplot2_2.2.1      evaluate_0.10     
[25] rmarkdown_1.5      stringi_1.1.5      scales_0.4.1      
[28] backports_1.0.5   </code></pre>
</div>

<hr>
<p>
    This <a href="http://rmarkdown.rstudio.com">R Markdown</a> site was created with <a href="https://github.com/jdblischak/workflowr">workflowr</a>
</p>
<hr>

<!-- To enable disqus, uncomment the section below and provide your disqus_shortname -->

<!-- disqus
  <div id="disqus_thread"></div>
    <script type="text/javascript">
        /* * * CONFIGURATION VARIABLES: EDIT BEFORE PASTING INTO YOUR WEBPAGE * * */
        var disqus_shortname = 'rmarkdown'; // required: replace example with your forum shortname

        /* * * DON'T EDIT BELOW THIS LINE * * */
        (function() {
            var dsq = document.createElement('script'); dsq.type = 'text/javascript'; dsq.async = true;
            dsq.src = '//' + disqus_shortname + '.disqus.com/embed.js';
            (document.getElementsByTagName('head')[0] || document.getElementsByTagName('body')[0]).appendChild(dsq);
        })();
    </script>
    <noscript>Please enable JavaScript to view the <a href="http://disqus.com/?ref_noscript">comments powered by Disqus.</a></noscript>
    <a href="http://disqus.com" class="dsq-brlink">comments powered by <span class="logo-disqus">Disqus</span></a>
-->


<!-- dynamically load mathjax for compatibility with self-contained -->
<script>
  (function () {
    var script = document.createElement("script");
    script.type = "text/javascript";
    script.src  = "https://mathjax.rstudio.com/latest/MathJax.js?config=TeX-AMS-MML_HTMLorMML";
    document.getElementsByTagName("head")[0].appendChild(script);
  })();
</script>

</body>
</html>
