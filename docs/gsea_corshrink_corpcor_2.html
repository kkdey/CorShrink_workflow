<!DOCTYPE html>

<html xmlns="http://www.w3.org/1999/xhtml">

<head>

<meta charset="utf-8" />
<meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
<meta name="generator" content="pandoc" />


<meta name="author" content="Kushal K Dey" />


<title>GSEA CorShrink vs CountClust part 2</title>

<script src="site_libs/jquery-1.11.3/jquery.min.js"></script>
<meta name="viewport" content="width=device-width, initial-scale=1" />
<link href="site_libs/bootstrap-3.3.5/css/cosmo.min.css" rel="stylesheet" />
<script src="site_libs/bootstrap-3.3.5/js/bootstrap.min.js"></script>
<script src="site_libs/bootstrap-3.3.5/shim/html5shiv.min.js"></script>
<script src="site_libs/bootstrap-3.3.5/shim/respond.min.js"></script>
<script src="site_libs/jqueryui-1.11.4/jquery-ui.min.js"></script>
<link href="site_libs/tocify-1.9.1/jquery.tocify.css" rel="stylesheet" />
<script src="site_libs/tocify-1.9.1/jquery.tocify.js"></script>
<script src="site_libs/navigation-1.1/tabsets.js"></script>
<link href="site_libs/highlightjs-1.1/textmate.css" rel="stylesheet" />
<script src="site_libs/highlightjs-1.1/highlight.js"></script>
<link href="site_libs/font-awesome-4.5.0/css/font-awesome.min.css" rel="stylesheet" />

<style type="text/css">code{white-space: pre;}</style>
<style type="text/css">
  pre:not([class]) {
    background-color: white;
  }
</style>
<script type="text/javascript">
if (window.hljs && document.readyState && document.readyState === "complete") {
   window.setTimeout(function() {
      hljs.initHighlighting();
   }, 0);
}
</script>



<style type="text/css">
h1 {
  font-size: 34px;
}
h1.title {
  font-size: 38px;
}
h2 {
  font-size: 30px;
}
h3 {
  font-size: 24px;
}
h4 {
  font-size: 18px;
}
h5 {
  font-size: 16px;
}
h6 {
  font-size: 12px;
}
.table th:not([align]) {
  text-align: left;
}
</style>


</head>

<body>

<style type = "text/css">
.main-container {
  max-width: 940px;
  margin-left: auto;
  margin-right: auto;
}
code {
  color: inherit;
  background-color: rgba(0, 0, 0, 0.04);
}
img {
  max-width:100%;
  height: auto;
}
.tabbed-pane {
  padding-top: 12px;
}
button.code-folding-btn:focus {
  outline: none;
}
</style>


<style type="text/css">
/* padding for bootstrap navbar */
body {
  padding-top: 51px;
  padding-bottom: 40px;
}
/* offset scroll position for anchor links (for fixed navbar)  */
.section h1 {
  padding-top: 56px;
  margin-top: -56px;
}

.section h2 {
  padding-top: 56px;
  margin-top: -56px;
}
.section h3 {
  padding-top: 56px;
  margin-top: -56px;
}
.section h4 {
  padding-top: 56px;
  margin-top: -56px;
}
.section h5 {
  padding-top: 56px;
  margin-top: -56px;
}
.section h6 {
  padding-top: 56px;
  margin-top: -56px;
}
</style>

<script>
// manage active state of menu based on current page
$(document).ready(function () {
  // active menu anchor
  href = window.location.pathname
  href = href.substr(href.lastIndexOf('/') + 1)
  if (href === "")
    href = "index.html";
  var menuAnchor = $('a[href="' + href + '"]');

  // mark it active
  menuAnchor.parent().addClass('active');

  // if it's got a parent navbar menu mark it active as well
  menuAnchor.closest('li.dropdown').addClass('active');
});
</script>


<div class="container-fluid main-container">

<!-- tabsets -->
<script>
$(document).ready(function () {
  window.buildTabsets("TOC");
});
</script>

<!-- code folding -->




<script>
$(document).ready(function ()  {

    // move toc-ignore selectors from section div to header
    $('div.section.toc-ignore')
        .removeClass('toc-ignore')
        .children('h1,h2,h3,h4,h5').addClass('toc-ignore');

    // establish options
    var options = {
      selectors: "h1,h2,h3",
      theme: "bootstrap3",
      context: '.toc-content',
      hashGenerator: function (text) {
        return text.replace(/[.\\/?&!#<>]/g, '').replace(/\s/g, '_').toLowerCase();
      },
      ignoreSelector: ".toc-ignore",
      scrollTo: 0
    };
    options.showAndHide = true;
    options.smoothScroll = true;

    // tocify
    var toc = $("#TOC").tocify(options).data("toc-tocify");
});
</script>

<style type="text/css">

#TOC {
  margin: 25px 0px 20px 0px;
}
@media (max-width: 768px) {
#TOC {
  position: relative;
  width: 100%;
}
}


.toc-content {
  padding-left: 30px;
  padding-right: 40px;
}

div.main-container {
  max-width: 1200px;
}

div.tocify {
  width: 20%;
  max-width: 260px;
  max-height: 85%;
}

@media (min-width: 768px) and (max-width: 991px) {
  div.tocify {
    width: 25%;
  }
}

@media (max-width: 767px) {
  div.tocify {
    width: 100%;
    max-width: none;
  }
}

.tocify ul, .tocify li {
  line-height: 20px;
}

.tocify-subheader .tocify-item {
  font-size: 0.90em;
  padding-left: 25px;
  text-indent: 0;
}

.tocify .list-group-item {
  border-radius: 0px;
}


</style>

<!-- setup 3col/9col grid for toc_float and main content  -->
<div class="row-fluid">
<div class="col-xs-12 col-sm-4 col-md-3">
<div id="TOC" class="tocify">
</div>
</div>

<div class="toc-content col-xs-12 col-sm-8 col-md-9">




<div class="navbar navbar-default  navbar-fixed-top" role="navigation">
  <div class="container">
    <div class="navbar-header">
      <button type="button" class="navbar-toggle collapsed" data-toggle="collapse" data-target="#navbar">
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
      </button>
      <a class="navbar-brand" href="index.html">CorShrink-workflow</a>
    </div>
    <div id="navbar" class="navbar-collapse collapse">
      <ul class="nav navbar-nav">
        <li>
  <a href="index.html">Home</a>
</li>
<li>
  <a href="about.html">About</a>
</li>
<li>
  <a href="license.html">License</a>
</li>
      </ul>
      <ul class="nav navbar-nav navbar-right">
        <li>
  <a href="https://github.com/jdblischak/workflowr">
    <span class="fa fa-github"></span>
     
  </a>
</li>
      </ul>
    </div><!--/.nav-collapse -->
  </div><!--/.container -->
</div><!--/.navbar -->

<div class="fluid-row" id="header">



<h1 class="title toc-ignore">GSEA CorShrink vs CountClust part 2</h1>
<h4 class="author"><em>Kushal K Dey</em></h4>
<h4 class="date"><em>5/12/2017</em></h4>

</div>


<!-- The file analysis/chunks.R contains chunks that define default settings
shared across the workflowr files. -->
<!-- Update knitr chunk options -->
<!-- Insert the date the file was last updated -->
<p><strong>Last updated:</strong> 2017-05-18</p>
<!-- Insert the code version (Git commit SHA1) if Git repository exists and R
 package git2r is installed -->
<p><strong>Code version:</strong> 9489f00</p>
<pre class="r"><code>cor_result &lt;- get(load(&quot;../output/ash_cor_only_gtex_tissues.rda&quot;))
common_samples &lt;- get(load(&quot;../output/common_samples.rda&quot;))
tissue_labels &lt;- read.table(file = &quot;../data/GTEX_V6/samples_id.txt&quot;)[,3]

#library(data.table)
#data &lt;- data.frame(fread(&quot;../data/GTEX_V6/cis_gene_expression.txt&quot;))
#matdata &lt;- t(data[,-c(1,2)])

gene_names &lt;- as.character(read.table(file = &quot;../data/GTEX_V6/gene_names_GTEX_V6.txt&quot;)[,1])
gene_names_1 &lt;- as.character(sapply(gene_names, function(x) return(strsplit(x, &quot;[.]&quot;)[[1]][1])))


U &lt;- unique(tissue_labels)</code></pre>
<pre class="r"><code>cluster_list &lt;- vector(mode = &quot;list&quot;, length = 20)
for(l in 1:20){
  cluster_list[[l]] &lt;- as.character(read.table(paste0(&quot;../utilities/gene_names_clus_&quot;, l, &quot;.txt&quot;))[,1])
}

tab &lt;- array(0, dim(cor_result)[3])
for(m in 1:dim(cor_result)[3]){
  z &lt;- as.matrix(cor_result[order_index[1:13],order_index[1:13],m])
  vec_z &lt;- z[row(z) &gt; col(z)]
  tab[m] &lt;- length(which(vec_z &gt; 0.2))
}

tval &lt;- (tab - mean(tab))/sd(tab)
names(tval) &lt;- gene_names_1

library(fgsea)</code></pre>
<pre><code>Loading required package: Rcpp</code></pre>
<pre class="r"><code>out &lt;- fgsea(pathways = cluster_list,
             stats = tval,
             nperm = 10000)

out</code></pre>
<pre><code>            pval        padj         ES        NES nMoreExtreme size
 1: 0.0006843066 0.002281022  0.4043216  1.7489062            2  100
 2: 0.5892531876 0.589253188  0.2171500  0.9436138         2587  102
 3: 0.0041058394 0.010264599  0.3648524  1.5781811           17  100
 4: 0.0001782531 0.001138434 -0.4804052 -2.0041542            0  101
 5: 0.2180491278 0.290732170 -0.2713824 -1.1316849         1224  100
 6: 0.0620320856 0.103386809 -0.3107526 -1.2987242          347  102
 7: 0.2960784314 0.334042985 -0.2584277 -1.0800432         1660  102
 8: 0.1413934426 0.217528373  0.2717941  1.1794291          620  101
 9: 0.0001779993 0.001138434 -0.5598668 -2.3346866            0  100
10: 0.3006386861 0.334042985  0.2475786  1.0709093         1317  100
11: 0.1628693485 0.232670498 -0.2824878 -1.1779952          914  100
12: 0.0195810565 0.043513459  0.3260173  1.4147263           85  101
13: 0.5028479886 0.529313672 -0.2340231 -0.9758939         2824  100
14: 0.0444998220 0.088999644 -0.3213927 -1.3402315          249  100
15: 0.2906021898 0.334042985  0.2487477  1.0759660         1273  100
16: 0.0002276867 0.001138434  0.5293683  2.3003424            0  102
17: 0.0002276867 0.001138434  0.7479725  3.2502753            0  102
18: 0.0604470803 0.103386809  0.2987732  1.2923530          264  100
19: 0.0004489338 0.001795735  0.4252605  1.8102855            1   90
20: 0.0015967153 0.004562044  0.3782419  1.6360974            6  100
                                                                                         leadingEdge
 1: ENSG00000215513,ENSG00000099622,ENSG00000120738,ENSG00000174652,ENSG00000173209,ENSG00000177606,
 2: ENSG00000171130,ENSG00000198668,ENSG00000198668,ENSG00000008277,ENSG00000247556,ENSG00000160469,
 3: ENSG00000147872,ENSG00000167772,ENSG00000146674,ENSG00000165507,ENSG00000178878,ENSG00000205362,
 4: ENSG00000118496,ENSG00000165995,ENSG00000259627,ENSG00000261616,ENSG00000112658,ENSG00000118257,
 5: ENSG00000232415,ENSG00000006016,ENSG00000077943,ENSG00000122176,ENSG00000111341,ENSG00000119681,
 6: ENSG00000146648,ENSG00000173338,ENSG00000185567,ENSG00000161642,ENSG00000173801,ENSG00000074410,
 7: ENSG00000136717,ENSG00000154358,ENSG00000171992,ENSG00000166343,ENSG00000185482,ENSG00000164309,
 8: ENSG00000149257,ENSG00000148926,ENSG00000173530,ENSG00000175592,ENSG00000105281,ENSG00000044574,
 9: ENSG00000087250,ENSG00000149557,ENSG00000167123,ENSG00000179195,ENSG00000147533,ENSG00000170915,
10: ENSG00000090920,ENSG00000197142,ENSG00000066230,ENSG00000178623,ENSG00000146205,ENSG00000231852,
11: ENSG00000115306,ENSG00000138593,ENSG00000158079,ENSG00000266964,ENSG00000158887,ENSG00000238018,
12: ENSG00000077150,ENSG00000105246,ENSG00000231389,ENSG00000137959,ENSG00000137965,ENSG00000089127,
13: ENSG00000099338,ENSG00000115257,ENSG00000087460,ENSG00000007516,ENSG00000050767,ENSG00000143443,
14: ENSG00000092054,ENSG00000111716,ENSG00000129170,ENSG00000272030,ENSG00000114738,ENSG00000132688,
15: ENSG00000163209,ENSG00000170477,ENSG00000171401,ENSG00000229732,ENSG00000106211,ENSG00000167553,
16: ENSG00000068001,ENSG00000090339,ENSG00000101187,ENSG00000108342,ENSG00000128016,ENSG00000128342,
17: ENSG00000115590,ENSG00000143110,ENSG00000162511,ENSG00000171051,ENSG00000180353,ENSG00000249437,
18: ENSG00000260065,ENSG00000142102,ENSG00000100219,ENSG00000112312,ENSG00000103226,ENSG00000243480,
19: ENSG00000132002,ENSG00000187010,ENSG00000011422,ENSG00000115523,ENSG00000135245,ENSG00000187837,
20: ENSG00000171236,ENSG00000047457,ENSG00000100197,ENSG00000105697,ENSG00000197249,ENSG00000167711,</code></pre>
<pre class="r"><code>tab &lt;- array(0, dim(cor_result)[3])
for(m in 1:dim(cor_result)[3]){
  z &lt;- as.matrix(cor_result[order_index[1:13],order_index[1:13],m])
  vec_z &lt;- z[row(z) &gt; col(z)]
  tab[m] &lt;- quantile(vec_z, 0.4)
}

tval &lt;- (tab - mean(tab))/sd(tab)
names(tval) &lt;- gene_names_1

out &lt;- fgsea(pathways = cluster_list,
             stats = tval,
             nperm = 10000)
out</code></pre>
<pre><code>            pval         padj         ES        NES nMoreExtreme size
 1: 0.0006561680 0.0018747657  0.4702791  1.7502899            4  100
 2: 0.8409576742 0.8409576742 -0.1903715 -0.8508034         1966  102
 3: 0.0001312336 0.0006678242  0.4866145  1.8110875            0  100
 4: 0.0004210526 0.0014035088 -0.4718133 -2.1103325            0  101
 5: 0.2292191436 0.3056255248 -0.2487950 -1.1104205          545  100
 6: 0.1081658829 0.1545226898 -0.2683804 -1.1994387          252  102
 7: 0.4547827222 0.4787186549  0.2690981  1.0050716         3484  102
 8: 0.0508719025 0.0782644653  0.3699932  1.3786562          387  101
 9: 0.0004198153 0.0014035088 -0.4529034 -2.0213961            0  100
10: 0.2531496063 0.3164370079  0.3038743  1.1309628         1928  100
11: 0.4357682620 0.4787186549 -0.2256717 -1.0072168         1037  100
12: 0.0263537433 0.0527074866  0.3898495  1.4526445          200  101
13: 0.4077427822 0.4787186549  0.2766371  1.0295909         3106  100
14: 0.0041981528 0.0093292285 -0.3410733 -1.5222767            9  100
15: 0.0409448819 0.0682414698  0.3769812  1.4030529          311  100
16: 0.0001304972 0.0006678242  0.6107901  2.2812792            0  102
17: 0.0001304972 0.0006678242  0.8228442  3.0732936            0  102
18: 0.0368766404 0.0670484371  0.3805203  1.4162248          280  100
19: 0.0001335648 0.0006678242  0.5571949  2.0390494            0   90
20: 0.0011811024 0.0029527559  0.4611785  1.7164192            8  100
                                                                                         leadingEdge
 1: ENSG00000215513,ENSG00000120738,ENSG00000174652,ENSG00000112715,ENSG00000177606,ENSG00000113369,
 2: ENSG00000127561,ENSG00000160460,ENSG00000109107,ENSG00000187189,ENSG00000112139,ENSG00000250510,
 3: ENSG00000165507,ENSG00000205362,ENSG00000178878,ENSG00000167772,ENSG00000100336,ENSG00000147872,
 4: ENSG00000139718,ENSG00000075624,ENSG00000065882,ENSG00000118496,ENSG00000163637,ENSG00000116473,
 5: ENSG00000232415,ENSG00000041982,ENSG00000229124,ENSG00000137693,ENSG00000135547,ENSG00000152601,
 6: ENSG00000198039,ENSG00000166483,ENSG00000143367,ENSG00000188508,ENSG00000179859,ENSG00000186395,
 7: ENSG00000060138,ENSG00000004799,ENSG00000151929,ENSG00000099875,ENSG00000125414,ENSG00000112096,
 8: ENSG00000173530,ENSG00000149257,ENSG00000175592,ENSG00000148926,ENSG00000105281,ENSG00000106366,
 9: ENSG00000173786,ENSG00000049089,ENSG00000122545,ENSG00000112851,ENSG00000107902,ENSG00000026652,
10: ENSG00000197142,ENSG00000090920,ENSG00000231852,ENSG00000155850,ENSG00000066230,ENSG00000178623,
11: ENSG00000143344,ENSG00000221857,ENSG00000079819,ENSG00000152818,ENSG00000157368,ENSG00000163069,
12: ENSG00000077150,ENSG00000137959,ENSG00000231389,ENSG00000105246,ENSG00000137804,ENSG00000137965,
13: ENSG00000115138,ENSG00000132141,ENSG00000134202,ENSG00000172179,ENSG00000122304,ENSG00000259384,
14: ENSG00000198336,ENSG00000153531,ENSG00000126267,ENSG00000133065,ENSG00000050165,ENSG00000129170,
15: ENSG00000143546,ENSG00000149573,ENSG00000106211,ENSG00000134531,ENSG00000258232,ENSG00000229732,
16: ENSG00000101187,ENSG00000108342,ENSG00000128016,ENSG00000128342,ENSG00000134470,ENSG00000267607,
17: ENSG00000018280,ENSG00000204525,ENSG00000163221,ENSG00000163220,ENSG00000185201,ENSG00000171051,
18: ENSG00000260065,ENSG00000100219,ENSG00000142102,ENSG00000112312,ENSG00000103226,ENSG00000175535,
19: ENSG00000244734,ENSG00000132002,ENSG00000135245,ENSG00000206172,ENSG00000239839,ENSG00000239839,
20: ENSG00000047457,ENSG00000171236,ENSG00000105697,ENSG00000197249,ENSG00000100197,ENSG00000124253,</code></pre>
<pre class="r"><code>######################    all tissue -tissue  enrichment    #################################

tab &lt;- array(0, dim(cor_result)[3])
for(m in 1:dim(cor_result)[3]){
  z &lt;- as.matrix(cor_result[order_index,order_index,m])
  vec_z &lt;- z[row(z) &gt; col(z)]
  tab[m] &lt;- quantile(vec_z, 0.8)
}

cluster_list &lt;- vector(mode = &quot;list&quot;, length = 20)
for(l in 1:20){
  cluster_list[[l]] &lt;- as.character(read.table(paste0(&quot;../utilities/gene_names_clus_&quot;, l, &quot;.txt&quot;))[,1])
}

tval &lt;- (tab - mean(tab))/sd(tab)
names(tval) &lt;- gene_names_1

out &lt;- fgsea(pathways = cluster_list,
             stats = tval,
             nperm = 100000)

out</code></pre>
<pre><code>            pval         padj         ES        NES nMoreExtreme size
 1: 1.347110e-05 8.716648e-05  0.5454688  1.9661896            0  100
 2: 3.922492e-05 8.716648e-05 -0.4324922 -1.8460520            0  102
 3: 6.886425e-02 1.059450e-01  0.3704344  1.3352629         5111  100
 4: 3.898180e-05 8.716648e-05 -0.6695173 -2.8544236            0  101
 5: 3.880632e-05 8.716648e-05 -0.4627316 -1.9683018            0  100
 6: 3.922492e-05 8.716648e-05 -0.4582840 -1.9561416            0  102
 7: 3.832667e-01 4.258518e-01 -0.2410044 -1.0287046         9770  102
 8: 4.502787e-01 4.739776e-01 -0.2345563 -1.0000084        11550  101
 9: 3.337343e-03 6.674687e-03 -0.3675744 -1.5635356           85  100
10: 1.152548e-02 1.920913e-02 -0.3398469 -1.4455922          296  100
11: 5.588110e-03 1.016020e-02 -0.3565956 -1.5168357          143  100
12: 1.067129e-01 1.333912e-01  0.3531496  1.2747031         7933  101
13: 7.434699e-02 1.062100e-01  0.3674237  1.3244107         5518  100
14: 3.880632e-05 8.716648e-05 -0.4282973 -1.8218301            0  100
15: 3.880632e-05 8.716648e-05 -0.4230865 -1.7996652            0  100
16: 9.327857e-02 1.243714e-01  0.3575488  1.2926830         6949  102
17: 1.342138e-05 8.716648e-05  0.7036381  2.5439351            0  102
18: 6.805076e-01 6.805076e-01 -0.2139962 -0.9102667        17535  100
19: 2.738638e-05 8.716648e-05  0.5448503  1.9341747            1   90
20: 1.772527e-01 2.085326e-01  0.3319277  1.1964623        13157  100
                                                                                         leadingEdge
 1: ENSG00000215513,ENSG00000203875,ENSG00000174652,ENSG00000152117,ENSG00000092068,ENSG00000213366,
 2: ENSG00000184702,ENSG00000159164,ENSG00000008710,ENSG00000104888,ENSG00000145362,ENSG00000187189,
 3: ENSG00000205362,ENSG00000167772,ENSG00000165507,ENSG00000157150,ENSG00000117289,ENSG00000147872,
 4: ENSG00000018408,ENSG00000151240,ENSG00000182095,ENSG00000157110,ENSG00000163431,ENSG00000116473,
 5: ENSG00000169504,ENSG00000148671,ENSG00000124225,ENSG00000106624,ENSG00000100345,ENSG00000125868,
 6: ENSG00000188508,ENSG00000162738,ENSG00000185963,ENSG00000178184,ENSG00000149527,ENSG00000112378,
 7: ENSG00000163995,ENSG00000145358,ENSG00000178104,ENSG00000105048,ENSG00000164309,ENSG00000185482,
 8: ENSG00000106080,ENSG00000135318,ENSG00000130635,ENSG00000168542,ENSG00000143387,ENSG00000100097,
 9: ENSG00000107829,ENSG00000115993,ENSG00000108387,ENSG00000126878,ENSG00000135720,ENSG00000146535,
10: ENSG00000085662,ENSG00000204344,ENSG00000120756,ENSG00000065154,ENSG00000157617,ENSG00000128298,
11: ENSG00000197147,ENSG00000104728,ENSG00000115306,ENSG00000185920,ENSG00000232767,ENSG00000104213,
12: ENSG00000137959,ENSG00000240342,ENSG00000157601,ENSG00000231389,ENSG00000137965,ENSG00000111331,
13: ENSG00000125618,ENSG00000132141,ENSG00000189269,ENSG00000134202,ENSG00000223839,ENSG00000111254,
14: ENSG00000173598,ENSG00000120049,ENSG00000148677,ENSG00000172346,ENSG00000109846,ENSG00000121769,
15: ENSG00000169474,ENSG00000084207,ENSG00000065613,ENSG00000186806,ENSG00000205420,ENSG00000198561,
16: ENSG00000101187,ENSG00000108342,ENSG00000142748,ENSG00000134470,ENSG00000267607,ENSG00000090339,
17: ENSG00000204525,ENSG00000018280,ENSG00000115590,ENSG00000163221,ENSG00000163220,ENSG00000237683,
18: ENSG00000157315,ENSG00000174951,ENSG00000114115,ENSG00000159197,ENSG00000139540,ENSG00000205213,
19: ENSG00000187010,ENSG00000244734,ENSG00000206172,ENSG00000188536,ENSG00000239839,ENSG00000239839,
20: ENSG00000167711,ENSG00000171236,ENSG00000166741,ENSG00000118514,ENSG00000104635,ENSG00000100197,</code></pre>
<pre class="r"><code>col=c(rev(rgb(seq(1,0,length=1000),1,seq(1,0,length=1000))),
      rgb(1,seq(1,0,length=1000),seq(1,0,length=1000)))
image(as.matrix(cor_result[order_index,order_index, grep(&quot;ENSG00000109846&quot;, gene_names_1)]),
      col=col, main=paste0(&quot;corshrink: &quot;), cex.main=2,
      xaxt = &quot;n&quot;, yaxt = &quot;n&quot;, zlim=c(-1,1))
axis(1, at = seq(0, 1, length.out = 53), labels = U[order_index], las=2, cex.axis = 1)
axis(2, at = seq(0, 1, length.out = 53), labels = U[order_index], las=2, cex.axis = 1)</code></pre>
<p><img src="figure/gsea_corshrink_corpcor_2.Rmd/unnamed-chunk-5-1.png" width="672" style="display: block; margin: auto;" /></p>
<pre class="r"><code>###################  number of tissues with corr  &gt; thresh  ###########################

tab &lt;- array(0, dim(cor_result)[3])
for(m in 1:dim(cor_result)[3]){
  z &lt;- as.matrix(cor_result[order_index,order_index,m])
  vec_z &lt;- z[row(z) &gt; col(z)]
  tab[m] &lt;- length(which(vec_z &gt; 0.5))
}

tval &lt;- (tab - mean(tab))/sd(tab)
names(tval) &lt;- gene_names_1

out &lt;- fgsea(pathways = cluster_list,
             stats = tval,
             nperm = 100000)

out </code></pre>
<pre><code>            pval         padj         ES        NES nMoreExtreme size
 1: 2.938770e-02 0.1469384757  0.6302231  1.6075388         2800  100
 2: 9.345577e-01 0.9345577149  0.1789397  0.4566396        89253  102
 3: 1.017291e-01 0.3628384374  0.5695018  1.4526544         9695  100
 4: 1.638628e-02 0.1092418615 -0.2400086 -1.5908655           74  101
 5: 9.257386e-01 0.9345577149  0.1845082  0.4706334        88233  100
 6: 8.986116e-01 0.9345577149  0.2042282  0.5211736        85820  102
 7: 4.893722e-01 0.8897675871  0.4027709  1.0278385        46736  102
 8: 7.544669e-01 0.9345577149  0.2833524  0.7230414        71994  101
 9: 6.660232e-01 0.9345577149  0.3261284  0.8318707        63479  100
10: 8.338719e-01 0.9345577149  0.2413030  0.6155026        79477  100
11: 6.587943e-01 0.9345577149  0.3297899  0.8412102        62790  100
12: 4.735866e-01 0.8897675871  0.4089868  1.0436279        45191  101
13: 1.269935e-01 0.3628384374  0.5544516  1.4142651        12103  100
14: 3.430704e-01 0.7623785833 -0.1625439 -1.0749517         1608  100
15: 5.448002e-01 0.9080003917  0.3809671  0.9717503        51925  100
16: 1.190003e-01 0.3628384374  0.5575138  1.4227299        11364  102
17: 1.047077e-05 0.0002094153  0.8331630  2.1261640            0  102
18: 7.929747e-01 0.9345577149  0.2632605  0.6715106        75579  100
19: 2.813791e-03 0.0281379076  0.7097980  1.8054111          264   90
20: 1.769976e-01 0.4424941246  0.5287107  1.3486066        16869  100
                                                                                         leadingEdge
 1: ENSG00000215513,ENSG00000203875,ENSG00000174652,ENSG00000152117,ENSG00000092068,ENSG00000213366,
 2:                  ENSG00000139899,ENSG00000112139,ENSG00000167371,ENSG00000129244,ENSG00000152154
 3: ENSG00000205362,ENSG00000167772,ENSG00000165507,ENSG00000157150,ENSG00000117289,ENSG00000135821,
 4: ENSG00000237886,ENSG00000261616,ENSG00000007866,ENSG00000072110,ENSG00000087448,ENSG00000145012,
 5: ENSG00000100242,ENSG00000099860,ENSG00000143127,ENSG00000198959,ENSG00000161638,ENSG00000106823,
 6: ENSG00000126368,ENSG00000167968,ENSG00000142178,ENSG00000172867,ENSG00000136826,ENSG00000114315,
 7: ENSG00000004799,ENSG00000060138,ENSG00000112096,ENSG00000112096,ENSG00000214872,ENSG00000109061,
 8: ENSG00000175592,ENSG00000149257,ENSG00000173530,ENSG00000106366,ENSG00000198431,ENSG00000160691,
 9: ENSG00000225972,ENSG00000237973,ENSG00000225630,ENSG00000168309,ENSG00000229344,ENSG00000271043,
10: ENSG00000066230,ENSG00000174236,ENSG00000090920,ENSG00000231852,ENSG00000197142,ENSG00000178623,
11: ENSG00000101347,ENSG00000119138,ENSG00000168209,ENSG00000269926,ENSG00000008311,ENSG00000107372,
12: ENSG00000137959,ENSG00000111331,ENSG00000157601,ENSG00000077150,ENSG00000231389,ENSG00000137965,
13: ENSG00000125618,ENSG00000132141,ENSG00000189269,ENSG00000134202,ENSG00000223839,ENSG00000111254,
14: ENSG00000090266,ENSG00000116688,ENSG00000127472,ENSG00000154723,ENSG00000163644,ENSG00000164919,
15: ENSG00000143546,ENSG00000149573,ENSG00000134107,ENSG00000167553,ENSG00000258232,ENSG00000111215,
16: ENSG00000101187,ENSG00000108342,ENSG00000142748,ENSG00000134470,ENSG00000176907,ENSG00000267607,
17: ENSG00000204525,ENSG00000018280,ENSG00000115590,ENSG00000163221,ENSG00000163220,ENSG00000237683,
18: ENSG00000260065,ENSG00000218510,ENSG00000103226,ENSG00000142102,ENSG00000259799,ENSG00000169347,
19: ENSG00000187010,ENSG00000244734,ENSG00000206172,ENSG00000188536,ENSG00000239839,ENSG00000239839,
20: ENSG00000167711,ENSG00000171236,ENSG00000166741,ENSG00000118514,ENSG00000198848,ENSG00000104635,</code></pre>
<pre class="r"><code>col=c(rev(rgb(seq(1,0,length=1000),1,seq(1,0,length=1000))),
      rgb(1,seq(1,0,length=1000),seq(1,0,length=1000)))
image(as.matrix(cor_result[order_index,order_index, grep(&quot;ENSG00000109846&quot;, gene_names_1)]),
      col=col, main=paste0(&quot;corshrink: &quot;), cex.main=2,
      xaxt = &quot;n&quot;, yaxt = &quot;n&quot;, zlim=c(-1,1))
axis(1, at = seq(0, 1, length.out = 53), labels = U[order_index], las=2, cex.axis = 1)
axis(2, at = seq(0, 1, length.out = 53), labels = U[order_index], las=2, cex.axis = 1)</code></pre>
<p><img src="figure/gsea_corshrink_corpcor_2.Rmd/unnamed-chunk-6-1.png" width="672" style="display: block; margin: auto;" /></p>
<pre class="r"><code>#####################   Heart compare (Ventricle vs Appendage) ###########################

tab &lt;- array(0, dim(cor_result)[3])
for(m in 1:dim(cor_result)[3]){
  tab[m] &lt;- cor_result[order_index[26],order_index[27],m]
}

tval &lt;- (tab - mean(tab))/sd(tab)
names(tval) &lt;- gene_names_1

out &lt;- fgsea(pathways = cluster_list,
             stats = tval,
             nperm = 100000)
out</code></pre>
<pre><code>            pval         padj         ES        NES nMoreExtreme size
 1: 1.125161e-03 0.0037505358  0.3919772  1.6650621           41  100
 2: 1.039190e-01 0.1726136111 -0.3126288 -1.2450939         6530  102
 3: 1.875268e-04 0.0009376339  0.4117201  1.7489271            6  100
 4: 1.142475e-01 0.1726136111 -0.3099574 -1.2326521         7171  101
 5: 7.977790e-05 0.0005318527 -0.4626847 -1.8367181            4  100
 6: 1.603895e-02 0.0356421150 -0.3637429 -1.4486642         1007  102
 7: 3.182332e-05 0.0003191116 -0.4948192 -1.9706966            1  102
 8: 1.687428e-01 0.2249904422 -0.2962733 -1.1782325        10592  101
 9: 9.968089e-01 0.9968088841 -0.1569995 -0.6232404        62473  100
10: 3.122826e-01 0.3469806725 -0.2711275 -1.0762938        19571  100
11: 3.065795e-01 0.3469806725  0.2512309  1.0671925        11443  100
12: 1.208295e-01 0.1726136111  0.2825808  1.2019619         4497  101
13: 5.773950e-01 0.6077841947  0.2233867  0.9489141        21552  100
14: 4.467562e-04 0.0017870249 -0.4359734 -1.7306820           27  100
15: 3.191116e-05 0.0003191116 -0.4925169 -1.9551426            1  100
16: 1.955053e-01 0.2443816445  0.2662461  1.1344853         7263  102
17: 1.566411e-02 0.0356421150  0.3347486  1.4263770          581  102
18: 3.246960e-02 0.0649392092 -0.3482802 -1.3825668         2034  100
19: 5.867354e-02 0.1066791572  0.3125777  1.3031387         2231   90
20: 7.100233e-03 0.0202863799 -0.3827850 -1.5195405          444  100
                                                                                         leadingEdge
 1: ENSG00000215513,ENSG00000167766,ENSG00000117616,ENSG00000099622,ENSG00000152117,ENSG00000108773,
 2: ENSG00000198825,ENSG00000058404,ENSG00000008735,ENSG00000171617,ENSG00000160469,ENSG00000160460,
 3: ENSG00000157150,ENSG00000135678,ENSG00000117289,ENSG00000167772,ENSG00000100336,ENSG00000110799,
 4: ENSG00000213949,ENSG00000182175,ENSG00000075624,ENSG00000163681,ENSG00000157110,ENSG00000166444,
 5: ENSG00000169504,ENSG00000072952,ENSG00000101665,ENSG00000006638,ENSG00000106624,ENSG00000115457,
 6: ENSG00000176845,ENSG00000136826,ENSG00000196407,ENSG00000188508,ENSG00000223573,ENSG00000104881,
 7: ENSG00000086967,ENSG00000168530,ENSG00000175564,ENSG00000154553,ENSG00000163157,ENSG00000185482,
 8: ENSG00000151348,ENSG00000168542,ENSG00000142871,ENSG00000183160,ENSG00000141756,ENSG00000115414,
 9: ENSG00000100364,ENSG00000087250,ENSG00000162734,ENSG00000105290,ENSG00000116574,ENSG00000013297,
10: ENSG00000161013,ENSG00000148795,ENSG00000160882,ENSG00000065154,ENSG00000163694,ENSG00000215187,
11: ENSG00000145675,ENSG00000154263,ENSG00000101347,ENSG00000157368,ENSG00000145390,ENSG00000008311,
12: ENSG00000137959,ENSG00000157601,ENSG00000077150,ENSG00000111331,ENSG00000137965,ENSG00000069493,
13: ENSG00000132141,ENSG00000125618,ENSG00000273142,ENSG00000134202,ENSG00000130518,ENSG00000010318,
14: ENSG00000198336,ENSG00000135940,ENSG00000014641,ENSG00000189043,ENSG00000108946,ENSG00000241837,
15: ENSG00000136689,ENSG00000123159,ENSG00000124107,ENSG00000172382,ENSG00000169474,ENSG00000164284,
16: ENSG00000142748,ENSG00000176907,ENSG00000145506,ENSG00000101187,ENSG00000116260,ENSG00000019991,
17: ENSG00000204525,ENSG00000204936,ENSG00000115590,ENSG00000105639,ENSG00000163221,ENSG00000185201,
18: ENSG00000149577,ENSG00000080493,ENSG00000172023,ENSG00000115386,ENSG00000204983,ENSG00000164266,
19: ENSG00000188536,ENSG00000206172,ENSG00000244734,ENSG00000239839,ENSG00000239839,ENSG00000239839,
20: ENSG00000118137,ENSG00000179761,ENSG00000149131,ENSG00000135744,ENSG00000130208,ENSG00000130203,</code></pre>
<pre class="r"><code>###################    Brain vs non brain compare  ################################

tab &lt;- array(0, dim(cor_result)[3])
for(m in 1:dim(cor_result)[3]){
  tab[m] &lt;- median(cor_result[order_index[1:13], order_index[-(1:13)],m])
}

tval &lt;- (tab - mean(tab))/sd(tab)
names(tval) &lt;- gene_names_1

out &lt;- fgsea(pathways = cluster_list,
             stats = tval,
             nperm = 100000)
out</code></pre>
<pre><code>            pval         padj         ES        NES nMoreExtreme size
 1: 1.736285e-02 0.0496081523  0.5855185  1.6048669         1660  100
 2: 2.384359e-04 0.0007947862 -0.3770119 -2.2437230            0  102
 3: 2.618540e-02 0.0572246066  0.5709579  1.5649573         2504  100
 4: 2.355713e-04 0.0007947862 -0.4099026 -2.4281048            0  101
 5: 2.141540e-01 0.3059342686 -0.1931555 -1.1414965          928  100
 6: 2.861230e-02 0.0572246066 -0.2476185 -1.4736600          119  102
 7: 6.018078e-01 0.7522597278  0.3343542  0.9172022        57657  102
 8: 6.399219e-01 0.7528492772  0.3221047  0.8833223        61276  101
 9: 2.305210e-04 0.0007947862 -0.3367400 -1.9900420            0  100
10: 7.895760e-01 0.8297896805  0.2667087  0.7310307        75533  100
11: 8.297897e-01 0.8297896805  0.2487001  0.6816704        79380  100
12: 2.065019e-01 0.3059342686  0.4619138  1.2667270        19773  101
13: 2.061486e-01 0.3059342686  0.4625758  1.2678891        19720  100
14: 2.305210e-04 0.0007947862 -0.4556389 -2.6927025            0  100
15: 8.012941e-01 0.8297896805  0.2615748  0.7169589        76654  100
16: 2.298347e-02 0.0572246066  0.5738502  1.5741890         2201  102
17: 1.043754e-05 0.0002087508  0.8254622  2.2644122            0  102
18: 5.985742e-01 0.7522597278  0.3354328  0.9193989        57261  100
19: 1.057541e-04 0.0007947862  0.7075514  1.9276971            9   90
20: 1.691023e-01 0.3059342686  0.4778168  1.3096637        16176  100
                                                                                         leadingEdge
 1: ENSG00000215513,ENSG00000203875,ENSG00000174652,ENSG00000152117,ENSG00000173209,ENSG00000099622,
 2: ENSG00000128656,ENSG00000117016,ENSG00000020129,ENSG00000159164,ENSG00000171867,ENSG00000088899,
 3: ENSG00000205362,ENSG00000165507,ENSG00000147872,ENSG00000167772,ENSG00000178878,ENSG00000117289,
 4: ENSG00000114861,ENSG00000023902,ENSG00000166166,ENSG00000125503,ENSG00000163431,ENSG00000151240,
 5: ENSG00000148671,ENSG00000038427,ENSG00000136999,ENSG00000142279,ENSG00000125868,ENSG00000163453,
 6: ENSG00000137699,ENSG00000108578,ENSG00000114270,ENSG00000108379,ENSG00000108379,ENSG00000179388,
 7: ENSG00000004799,ENSG00000060138,ENSG00000112096,ENSG00000112096,ENSG00000099875,ENSG00000214872,
 8: ENSG00000175592,ENSG00000173530,ENSG00000106366,ENSG00000160691,ENSG00000148926,ENSG00000137801,
 9: ENSG00000131095,ENSG00000184007,ENSG00000164402,ENSG00000198835,ENSG00000068903,ENSG00000110315,
10: ENSG00000174236,ENSG00000066230,ENSG00000231852,ENSG00000144381,ENSG00000178623,ENSG00000167608,
11: ENSG00000269926,ENSG00000168209,ENSG00000119138,ENSG00000101347,ENSG00000126391,ENSG00000105559,
12: ENSG00000137959,ENSG00000240342,ENSG00000137965,ENSG00000089127,ENSG00000111335,ENSG00000111331,
13: ENSG00000189269,ENSG00000125618,ENSG00000134202,ENSG00000132141,ENSG00000111254,ENSG00000157578,
14: ENSG00000140740,ENSG00000090266,ENSG00000109846,ENSG00000197616,ENSG00000121577,ENSG00000014641,
15: ENSG00000143546,ENSG00000149573,ENSG00000171195,ENSG00000167553,ENSG00000258232,ENSG00000228314,
16: ENSG00000101187,ENSG00000108342,ENSG00000134470,ENSG00000068001,ENSG00000267607,ENSG00000090339,
17: ENSG00000204525,ENSG00000018280,ENSG00000163221,ENSG00000163220,ENSG00000185201,ENSG00000237683,
18: ENSG00000260065,ENSG00000218510,ENSG00000142102,ENSG00000237940,ENSG00000103226,ENSG00000138161,
19: ENSG00000187010,ENSG00000244734,ENSG00000206172,ENSG00000239839,ENSG00000239839,ENSG00000239839,
20: ENSG00000118514,ENSG00000171236,ENSG00000100197,ENSG00000167711,ENSG00000166741,ENSG00000047457,</code></pre>
<pre class="r"><code>#####################  Brain high, others low  ############################

tab &lt;- array(0, dim(cor_result)[3])
for(m in 1:dim(cor_result)[3]){
  tab[m] &lt;- median(cor_result[order_index[1:13], order_index[(1:13)],m])/median(cor_result[order_index[-(1:13)], order_index[-(1:13)],m])
}

tval &lt;- (tab - mean(tab))/sd(tab)
names(tval) &lt;- gene_names_1

out &lt;- fgsea(pathways = cluster_list,
             stats = tval,
             nperm = 100000)
out</code></pre>
<pre><code>            pval         padj         ES        NES nMoreExtreme size
 1: 1.200784e-01 1.715406e-01 -0.2259500 -1.2178248          795  100
 2: 1.068387e-05 5.354867e-05  0.7559112  2.3136630            0  102
 3: 5.778973e-02 8.890727e-02  0.4987828  1.5238953         5395  100
 4: 1.069839e-05 5.354867e-05  0.7701022  2.3547428            0  101
 5: 1.070973e-05 5.354867e-05  0.7188426  2.1962280            0  100
 6: 2.211562e-03 7.371874e-03  0.6385757  1.9545274          206  102
 7: 3.286360e-02 5.477266e-02  0.5308606  1.6248370         3075  102
 8: 7.103732e-03 1.420746e-02  0.6034165  1.8450677          663  101
 9: 2.940112e-01 3.458955e-01 -0.1995845 -1.0757201         1948  100
10: 1.472588e-02 2.677434e-02  0.5776607  1.7648852         1374  100
11: 3.394986e-03 7.929809e-03  0.6287550  1.9209899          316  100
12: 2.122454e-01 2.829938e-01  0.4050329  1.2384697        19838  101
13: 2.311910e-01 2.889888e-01  0.3982246  1.2166669        21586  100
14: 3.373566e-03 7.929809e-03  0.6291739  1.9222698          314  100
15: 1.070973e-05 5.354867e-05  0.7994702  2.4425638            0  100
16: 3.568414e-03 7.929809e-03  0.6248674  1.9125695          333  102
17: 7.196551e-01 7.196551e-01  0.2607717  0.7981597        67358  102
18: 3.311236e-01 3.679151e-01  0.3654653  1.1165800        30917  100
19: 6.550228e-01 6.894977e-01  0.2790184  0.8449711        60229   90
20: 5.783256e-04 2.313303e-03  0.6743758  2.0603719           53  100
                                                                                         leadingEdge
 1: ENSG00000007392,ENSG00000146067,ENSG00000100650,ENSG00000257621,ENSG00000120458,ENSG00000256586,
 2: ENSG00000130294,ENSG00000127561,ENSG00000104435,ENSG00000100505,ENSG00000132639,ENSG00000127585,
 3: ENSG00000166819,ENSG00000017427,ENSG00000197766,ENSG00000184254,ENSG00000167676,ENSG00000146674,
 4: ENSG00000213949,ENSG00000163017,ENSG00000182175,ENSG00000106772,ENSG00000182253,ENSG00000183963,
 5: ENSG00000072952,ENSG00000054598,ENSG00000149591,ENSG00000049323,ENSG00000173546,ENSG00000076706,
 6: ENSG00000170345,ENSG00000163347,ENSG00000168350,ENSG00000096696,ENSG00000074410,ENSG00000130940,
 7: ENSG00000101210,ENSG00000128591,ENSG00000197321,ENSG00000104369,ENSG00000130600,ENSG00000253549,
 8: ENSG00000115414,ENSG00000134013,ENSG00000163430,ENSG00000111799,ENSG00000166147,ENSG00000164932,
 9: ENSG00000170113,ENSG00000255823,ENSG00000198835,ENSG00000146063,ENSG00000147533,ENSG00000021300,
10: ENSG00000197142,ENSG00000095932,ENSG00000162896,ENSG00000171345,ENSG00000155850,ENSG00000104267,
11: ENSG00000132470,ENSG00000249906,ENSG00000181409,ENSG00000064300,ENSG00000121653,ENSG00000116985,
12:  ENSG00000159958,ENSG00000260655,ENSG00000137804,ENSG00000232810,ENSG00000138623,ENSG00000128815
13: ENSG00000089199,ENSG00000154040,ENSG00000219435,ENSG00000185133,ENSG00000088836,ENSG00000260001,
14: ENSG00000118729,ENSG00000134775,ENSG00000159251,ENSG00000127472,ENSG00000109846,ENSG00000121769,
15: ENSG00000142627,ENSG00000189334,ENSG00000171346,ENSG00000169509,ENSG00000175793,ENSG00000205420,
16: ENSG00000213626,ENSG00000256261,ENSG00000149564,ENSG00000128567,ENSG00000013588,ENSG00000166292,
17: ENSG00000107738,ENSG00000125753,ENSG00000123146,ENSG00000137642,ENSG00000140678,ENSG00000051523,
18: ENSG00000095203,ENSG00000080493,ENSG00000112312,ENSG00000166123,ENSG00000235481,ENSG00000051108,
19: ENSG00000153814,ENSG00000188042,ENSG00000218018,ENSG00000132819,ENSG00000136732,ENSG00000173868,
20: ENSG00000105697,ENSG00000124253,ENSG00000130203,ENSG00000000971,ENSG00000130208,ENSG00000025423,</code></pre>
<pre class="r"><code>###########################  without brain  ###############################

tab &lt;- array(0, dim(cor_result)[3])
for(m in 1:dim(cor_result)[3]){
  tab[m] &lt;- median(cor_result[order_index[-(1:13)], order_index[-(1:13)],m])
}

tval &lt;- (tab - mean(tab))/sd(tab)
names(tval) &lt;- gene_names_1

out &lt;- fgsea(pathways = cluster_list,
             stats = tval,
             nperm = 100000)

out</code></pre>
<pre><code>            pval         padj         ES        NES nMoreExtreme size
 1: 0.0005953103 0.0014882757  0.5329209  1.7997450           53  100
 2: 0.0001103266 0.0003152188 -0.3825225 -1.9386792            0  102
 3: 0.2654642869 0.3123109258  0.3433404  1.1595063        24079  100
 4: 0.0001088376 0.0003152188 -0.6697534 -3.3869652            0  101
 5: 0.0001076079 0.0003152188 -0.5084349 -2.5642227            0  100
 6: 0.0001103266 0.0003152188 -0.3836335 -1.9443099            0  102
 7: 0.0410414828 0.0630274708 -0.2639560 -1.3377671          371  102
 8: 0.0032651284 0.0060651712 -0.3184123 -1.6102216           29  101
 9: 0.0441192295 0.0630274708 -0.2641481 -1.3321955          409  100
10: 0.0033358442 0.0060651712 -0.3188256 -1.6079540           30  100
11: 0.0066716884 0.0111194806 -0.3063304 -1.5449361           61  100
12: 0.1072081397 0.1340101746  0.3909931  1.3217779         9735  101
13: 0.0531038816 0.0708051755  0.4201180  1.4187947         4816  100
14: 0.0001076079 0.0003152188 -0.3915596 -1.9747779            0  100
15: 0.0001076079 0.0003152188 -0.5235536 -2.6404719            0  100
16: 0.7333406884 0.7719375668 -0.1756363 -0.8901499         6646  102
17: 0.0000109965 0.0002199301  0.6499505  2.1996406            0  102
18: 0.9601583084 0.9601583084  0.1786165  0.6032118        87094  100
19: 0.0017139400 0.0038087557  0.5225276  1.7438814          152   90
20: 0.5800085989 0.6444539988  0.2765756  0.9340327        52611  100
                                                                                         leadingEdge
 1: ENSG00000215513,ENSG00000203875,ENSG00000174652,ENSG00000152117,ENSG00000213366,ENSG00000167766,
 2: ENSG00000154146,ENSG00000184702,ENSG00000197535,ENSG00000105696,ENSG00000104888,ENSG00000088899,
 3: ENSG00000157150,ENSG00000205362,ENSG00000167772,ENSG00000135821,ENSG00000117289,ENSG00000147872,
 4: ENSG00000166166,ENSG00000118496,ENSG00000243244,ENSG00000101452,ENSG00000064999,ENSG00000116473,
 5: ENSG00000133026,ENSG00000175183,ENSG00000140836,ENSG00000136999,ENSG00000125868,ENSG00000074181,
 6: ENSG00000185963,ENSG00000178184,ENSG00000188508,ENSG00000189001,ENSG00000179859,ENSG00000118402,
 7: ENSG00000196218,ENSG00000183386,ENSG00000163050,ENSG00000138768,ENSG00000135766,ENSG00000179262,
 8: ENSG00000164442,ENSG00000128595,ENSG00000057019,ENSG00000100097,ENSG00000120708,ENSG00000177311,
 9: ENSG00000021300,ENSG00000262967,ENSG00000126878,ENSG00000105290,ENSG00000146122,ENSG00000136237,
10: ENSG00000128298,ENSG00000085662,ENSG00000163694,ENSG00000108272,ENSG00000140459,ENSG00000120756,
11: ENSG00000197147,ENSG00000104213,ENSG00000111087,ENSG00000179403,ENSG00000185920,ENSG00000070731,
12: ENSG00000137959,ENSG00000240342,ENSG00000231389,ENSG00000137965,ENSG00000157601,ENSG00000111331,
13: ENSG00000189269,ENSG00000125618,ENSG00000132141,ENSG00000134202,ENSG00000111254,ENSG00000223839,
14: ENSG00000120053,ENSG00000133065,ENSG00000151729,ENSG00000129170,ENSG00000172346,ENSG00000050165,
15: ENSG00000186806,ENSG00000159763,ENSG00000134755,ENSG00000118898,ENSG00000084207,ENSG00000116044,
16: ENSG00000185303,ENSG00000076067,ENSG00000159588,ENSG00000010610,ENSG00000122679,ENSG00000256013,
17: ENSG00000204525,ENSG00000018280,ENSG00000115590,ENSG00000237683,ENSG00000171051,ENSG00000249437,
18: ENSG00000260065,ENSG00000218510,ENSG00000103226,ENSG00000259799,ENSG00000237940,ENSG00000233806,
19: ENSG00000187010,ENSG00000244734,ENSG00000206172,ENSG00000188536,ENSG00000239839,ENSG00000239839,
20: ENSG00000167711,ENSG00000166741,ENSG00000118514,ENSG00000100197,ENSG00000104635,ENSG00000160282,</code></pre>
<pre class="r"><code>###########################  within brain  ###############################

tab &lt;- array(0, dim(cor_result)[3])
for(m in 1:dim(cor_result)[3]){
  tab[m] &lt;- median(cor_result[order_index[(1:13)], order_index[(1:13)],m])
}

tval &lt;- (tab - mean(tab))/sd(tab)
names(tval) &lt;- gene_names_1

out &lt;- fgsea(pathways = cluster_list,
             stats = tval,
             nperm = 100000)

out</code></pre>
<pre><code>            pval         padj         ES        NES nMoreExtreme size
 1: 3.103477e-03 0.0077586922  0.4132348  1.6104473          186  100
 2: 4.471689e-01 0.4608414239  0.2560608  1.0012459        27008  102
 3: 3.651149e-04 0.0012170498  0.4538034  1.7685497           21  100
 4: 2.517623e-05 0.0001007049 -0.4758119 -1.9916230            0  101
 5: 4.608414e-01 0.4608414239  0.2550681  0.9940441        27767  100
 6: 3.262461e-02 0.0543743582 -0.3237287 -1.3569568         1291  102
 7: 4.501987e-01 0.4608414239  0.2556649  0.9996979        27191  102
 8: 1.534455e-02 0.0340989940  0.3761468  1.4682080          924  101
 9: 2.515913e-05 0.0001007049 -0.4978291 -2.0803466            0  100
10: 3.112107e-01 0.4045356256  0.2764900  1.0775290        18751  100
11: 3.323773e-01 0.4045356256 -0.2522163 -1.0539707        13210  100
12: 2.559636e-02 0.0465388432  0.3635964  1.4192202         1542  101
13: 3.438553e-01 0.4045356256  0.2714631  1.0579383        20718  100
14: 4.543739e-02 0.0649105593 -0.3168152 -1.3239188         1805  100
15: 3.541615e-02 0.0544863816  0.3553421  1.3848292         2133  100
16: 1.655629e-05 0.0001007049  0.6001492  2.3466963            0  102
17: 1.655629e-05 0.0001007049  0.8172494  3.1955987            0  102
18: 2.350012e-02 0.0465388432  0.3667750  1.4293852         1415  100
19: 1.679712e-05 0.0001007049  0.5173104  1.9831479            0   90
20: 6.472492e-04 0.0018492834  0.4428213  1.7257509           38  100
                                                                                         leadingEdge
 1: ENSG00000215513,ENSG00000120738,ENSG00000113369,ENSG00000174652,ENSG00000177606,ENSG00000112715,
 2: ENSG00000197535,ENSG00000125814,ENSG00000198668,ENSG00000198668,ENSG00000247556,ENSG00000171130,
 3: ENSG00000165507,ENSG00000178878,ENSG00000205362,ENSG00000167772,ENSG00000110799,ENSG00000100336,
 4: ENSG00000139718,ENSG00000116729,ENSG00000117569,ENSG00000073712,ENSG00000072110,ENSG00000182175,
 5: ENSG00000099860,ENSG00000198959,ENSG00000171223,ENSG00000161638,ENSG00000143127,ENSG00000134871,
 6: ENSG00000223573,ENSG00000237101,ENSG00000074410,ENSG00000179859,ENSG00000173801,ENSG00000198039,
 7: ENSG00000060138,ENSG00000004799,ENSG00000151929,ENSG00000099875,ENSG00000125414,ENSG00000112096,
 8: ENSG00000173530,ENSG00000149257,ENSG00000175592,ENSG00000148926,ENSG00000105281,ENSG00000106366,
 9: ENSG00000150459,ENSG00000049089,ENSG00000087250,ENSG00000026652,ENSG00000122545,ENSG00000173786,
10: ENSG00000197142,ENSG00000090920,ENSG00000155850,ENSG00000231852,ENSG00000066230,ENSG00000163694,
11: ENSG00000149212,ENSG00000115306,ENSG00000179403,ENSG00000203485,ENSG00000138593,ENSG00000113296,
12: ENSG00000077150,ENSG00000137959,ENSG00000231389,ENSG00000105246,ENSG00000137804,ENSG00000137965,
13: ENSG00000115138,ENSG00000132141,ENSG00000259384,ENSG00000172179,ENSG00000125618,ENSG00000134202,
14: ENSG00000106631,ENSG00000092054,ENSG00000131730,ENSG00000182809,ENSG00000121577,ENSG00000010282,
15: ENSG00000143546,ENSG00000149573,ENSG00000106211,ENSG00000258232,ENSG00000134531,ENSG00000167553,
16: ENSG00000101187,ENSG00000108342,ENSG00000128016,ENSG00000134470,ENSG00000100906,ENSG00000090339,
17: ENSG00000018280,ENSG00000204525,ENSG00000163220,ENSG00000163221,ENSG00000185201,ENSG00000171051,
18: ENSG00000260065,ENSG00000100219,ENSG00000204983,ENSG00000169347,ENSG00000112312,ENSG00000175535,
19: ENSG00000135245,ENSG00000244734,ENSG00000132002,ENSG00000206172,ENSG00000188536,ENSG00000239839,
20: ENSG00000047457,ENSG00000105697,ENSG00000171236,ENSG00000197249,ENSG00000100197,ENSG00000124253,</code></pre>
<div id="session-information" class="section level2">
<h2>Session information</h2>
<!-- Insert the session information into the document -->
<pre class="r"><code>sessionInfo()</code></pre>
<pre><code>R version 3.3.3 (2017-03-06)
Platform: x86_64-apple-darwin13.4.0 (64-bit)
Running under: macOS Sierra 10.12

locale:
[1] en_US.UTF-8/en_US.UTF-8/en_US.UTF-8/C/en_US.UTF-8/en_US.UTF-8

attached base packages:
[1] stats     graphics  grDevices utils     datasets  methods   base     

other attached packages:
[1] fgsea_1.1.2      Rcpp_0.12.10     softImpute_1.4   Matrix_1.2-8    
[5] knitr_1.15.1     CorShrink_0.99.0 workflowr_0.4.0  rmarkdown_1.5   

loaded via a namespace (and not attached):
 [1] bitops_1.0-6               devtools_1.13.1.9000      
 [3] doParallel_1.0.10          RColorBrewer_1.1-2        
 [5] httr_1.2.1                 rprojroot_1.2             
 [7] GenomeInfoDb_1.10.1        tools_3.3.3               
 [9] backports_1.0.5            R6_2.2.1                  
[11] rpart_4.1-10               Hmisc_4.0-2               
[13] DBI_0.6-1                  lazyeval_0.2.0            
[15] BiocGenerics_0.20.0        colorspace_1.3-2          
[17] nnet_7.3-12                withr_1.0.2               
[19] gridExtra_2.2.1            processx_1.0.0.9000       
[21] curl_2.6                   git2r_0.18.0              
[23] chron_2.3-50               Biobase_2.34.0            
[25] htmlTable_1.9              expm_0.999-2              
[27] rtracklayer_1.34.1         scales_0.4.1              
[29] checkmate_1.8.2            SQUAREM_2016.8-2          
[31] callr_1.0.0.9000           stringr_1.2.0             
[33] digest_0.6.12              Rsamtools_1.26.1          
[35] foreign_0.8-67             XVector_0.14.0            
[37] pscl_1.4.9                 base64enc_0.1-3           
[39] htmltools_0.3.6            highr_0.6                 
[41] htmlwidgets_0.8            rlang_0.1.1.9000          
[43] RSQLite_1.1-2              jsonlite_1.4              
[45] REBayes_0.73               BiocParallel_1.8.2        
[47] acepack_1.4.1              RCurl_1.95-4.8            
[49] magrittr_1.5               Formula_1.2-1             
[51] munsell_0.4.3              S4Vectors_0.12.0          
[53] proto_1.0.0                sqldf_0.4-10              
[55] stringi_1.1.5              yaml_2.1.14               
[57] debugme_1.0.2              MASS_7.3-45               
[59] SummarizedExperiment_1.4.0 zlibbioc_1.20.0           
[61] pkgbuild_0.0.0.9000        plyr_1.8.4                
[63] grid_3.3.3                 parallel_3.3.3            
[65] crayon_1.3.2               lattice_0.20-35           
[67] Biostrings_2.42.0          splines_3.3.3             
[69] GenomicFeatures_1.26.0     GenomicRanges_1.26.1      
[71] corpcor_1.6.9              reshape2_1.4.2.9000       
[73] codetools_0.2-15           biomaRt_2.30.0            
[75] stats4_3.3.3               pkgload_0.0.0.9000        
[77] fastmatch_1.1-0            XML_3.98-1.6              
[79] evaluate_0.10              latticeExtra_0.6-28       
[81] data.table_1.10.4          foreach_1.4.3             
[83] gtable_0.2.0               assertthat_0.2.0          
[85] gsubfn_0.6-6               ashr_2.0.5                
[87] ggplot2_2.2.1              rsconnect_0.7             
[89] survival_2.41-3            glasso_1.8                
[91] truncnorm_1.0-7            tibble_1.3.1              
[93] mygene_1.10.0              iterators_1.0.8           
[95] GenomicAlignments_1.10.1   AnnotationDbi_1.36.0      
[97] memoise_1.1.0              IRanges_2.8.1             
[99] cluster_2.0.6             </code></pre>
</div>

<hr>
<p>
    This <a href="http://rmarkdown.rstudio.com">R Markdown</a> site was created with <a href="https://github.com/jdblischak/workflowr">workflowr</a>
</p>
<hr>

<!-- To enable disqus, uncomment the section below and provide your disqus_shortname -->

<!-- disqus
  <div id="disqus_thread"></div>
    <script type="text/javascript">
        /* * * CONFIGURATION VARIABLES: EDIT BEFORE PASTING INTO YOUR WEBPAGE * * */
        var disqus_shortname = 'rmarkdown'; // required: replace example with your forum shortname

        /* * * DON'T EDIT BELOW THIS LINE * * */
        (function() {
            var dsq = document.createElement('script'); dsq.type = 'text/javascript'; dsq.async = true;
            dsq.src = '//' + disqus_shortname + '.disqus.com/embed.js';
            (document.getElementsByTagName('head')[0] || document.getElementsByTagName('body')[0]).appendChild(dsq);
        })();
    </script>
    <noscript>Please enable JavaScript to view the <a href="http://disqus.com/?ref_noscript">comments powered by Disqus.</a></noscript>
    <a href="http://disqus.com" class="dsq-brlink">comments powered by <span class="logo-disqus">Disqus</span></a>
-->


</div>
</div>

</div>

<script>

// add bootstrap table styles to pandoc tables
function bootstrapStylePandocTables() {
  $('tr.header').parent('thead').parent('table').addClass('table table-condensed');
}
$(document).ready(function () {
  bootstrapStylePandocTables();
});


</script>

<!-- dynamically load mathjax for compatibility with self-contained -->
<script>
  (function () {
    var script = document.createElement("script");
    script.type = "text/javascript";
    script.src  = "https://mathjax.rstudio.com/latest/MathJax.js?config=TeX-AMS-MML_HTMLorMML";
    document.getElementsByTagName("head")[0].appendChild(script);
  })();
</script>

</body>
</html>
