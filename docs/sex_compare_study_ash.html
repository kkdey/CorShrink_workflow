<!DOCTYPE html>

<html xmlns="http://www.w3.org/1999/xhtml">

<head>

<meta charset="utf-8" />
<meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
<meta name="generator" content="pandoc" />

<meta name="viewport" content="width=device-width, initial-scale=1">

<meta name="author" content="Kushal K Dey" />


<title>Sex comparison with ash</title>

<link href="site_libs/highlightjs-1.1/textmate.css" rel="stylesheet" />
<script src="site_libs/highlightjs-1.1/highlight.js"></script>

<style type="text/css">code{white-space: pre;}</style>
<script type="text/javascript">
if (window.hljs && document.readyState && document.readyState === "complete") {
   window.setTimeout(function() {
      hljs.initHighlighting();
   }, 0);
}
</script>




<link rel="stylesheet" href="cosmo.css" type="text/css" />

</head>

<body>


<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <link href="https://fonts.googleapis.com/css?family=Open+Sans:100,300,400,600" rel="stylesheet" type="text/css">
    <link href="../docs/cosmo.css" rel="stylesheet">
    <link href="../docs/cosmo.min.css" rel="stylesheet">
</head>
<script src="https://ajax.googleapis.com/ajax/libs/jquery/1.12.4/jquery.min.js"></script>
<script src="../docs/bootstrap/js/bootstrap.min.js"></script>

<body>

<div class = "nav" align = "middle">
<div class= "p1"></div>
<p>
  <a class="btn btn-large btn btn-primary" type="button" href = "corshrink_front.html">HOME</a> 
  &nbsp &nbsp
  <a class="btn btn-large btn btn-primary" type="button" href = "workflow.html">WORKFLOW</a> 
  &nbsp &nbsp
  <a class="btn btn-large btn btn-primary" type="button" href = "tissue_corr.html">GTEx DEMO</a> 
  &nbsp &nbsp
  <a class="btn btn-large btn btn-primary" type="button" href = "about.html">METHODS</a> 
  &nbsp &nbsp
  <a class="btn btn-large btn btn-primary" type="button" href = "https://github.com/kkdey/CorShrink">SOFTWARE</a> 
  &nbsp &nbsp
  <a class="btn btn-large btn btn-primary" type="button" href = "license.html">LICENSE</a> 
   &nbsp &nbsp
  <a class="btn btn-large btn btn-primary" type="button" href = "https://github.com/kkdey/CorShrink_workflow">GITHUB</a> 
 </p>
</div>  
<!-- <div class="nav">
  <a href="index.html">Home page</a> &nbsp &nbsp
  <a href="musings.html">Musings</a> &nbsp &nbsp
  <a href="town.html">My town</a> &nbsp &nbsp
  <a href="links.html">Links</a>
</div> -->

<!-- Main content -->
</body>
</html>


<h1 class="title toc-ignore">Sex comparison with ash</h1>
<h4 class="author"><em>Kushal K Dey</em></h4>
<h4 class="date"><em>6/8/2017</em></h4>


<div id="TOC">
<ul>
<li><a href="#lfsr-threshold-0.05">lfsr threshold 0.05</a></li>
<li><a href="#lfsr-threshold-0.1">lfsr threshold 0.1</a></li>
<li><a href="#review-of-genes">Review of genes</a></li>
<li><a href="#ensg00000225490">ENSG00000225490</a></li>
<li><a href="#ensg00000149531">ENSG00000149531</a></li>
<li><a href="#ensg00000236698">ENSG00000236698</a></li>
<li><a href="#ensg00000258484-or-spesp1">ENSG00000258484 or SPESP1</a></li>
</ul>
</div>

<p>In this script, we look at the SEX comparison problem in the context of using lfsr for the adaptive shrinkage on the tissues for each gene. Adaptive shrinkage is performed using a normal distribution centered about 0.</p>
<pre class="r"><code>ash_cor_mat &lt;- get(load(&quot;../output/ash_cor_only_voom_pearson_halfuniform_gtex_tissues.rda&quot;))</code></pre>
<pre class="r"><code>common_samples &lt;- get(load(&quot;../output/common_samples.rda&quot;))
tissue_labels &lt;- read.table(file = &quot;../data/GTEX_V6/samples_id.txt&quot;)[,3]

#library(data.table)
#data &lt;- data.frame(fread(&quot;../data/GTEX_V6/cis_gene_expression.txt&quot;))
#matdata &lt;- t(data[,-c(1,2)])

gene_names &lt;- as.character(read.table(file = &quot;../data/GTEX_V6/gene_names_GTEX_V6.txt&quot;)[,1])
gene_names_1 &lt;- as.character(sapply(gene_names, function(x) return(strsplit(x, &quot;[.]&quot;)[[1]][1])))


U &lt;- unique(tissue_labels)</code></pre>
<pre class="r"><code>person_tissue_genes &lt;- get(load(&quot;../output/person_tissue_genes_voom.rda&quot;))
betahat_sebetahat &lt;- get(load(&quot;../output/sex_cor_ash.rda&quot;))
sample_attributes &lt;- get(load(&quot;../output/sample_attributes_filtered.rda&quot;))
person_tissue_genes &lt;- get(load(&quot;../output/person_tissue_genes_voom.rda&quot;))</code></pre>
<pre class="r"><code>betahat_mat &lt;- betahat_sebetahat$post.mean
sebetahat_mat &lt;- betahat_sebetahat$post.sd
lfsr_mat &lt;- betahat_sebetahat$post.lfsr</code></pre>
<div id="lfsr-threshold-0.05" class="section level2">
<h2>lfsr threshold 0.05</h2>
<p>We look at which genes have the most number of lfsr values below a chosen threshold.</p>
<pre class="r"><code>num_lfsr_below_thresh &lt;- apply(lfsr_mat, 2, function(x) return(length(which(x &lt; 0.05))))

imp_genes &lt;- order(num_lfsr_below_thresh, decreasing = TRUE)[1:10]
num_lfsr_below_thresh[imp_genes]</code></pre>
<pre><code>## ENSG00000225490 ENSG00000149531 ENSG00000236698 ENSG00000258484 
##              43              39              36              36 
## ENSG00000080007 ENSG00000180574 ENSG00000172460 ENSG00000247516 
##              33              33              24              17 
## ENSG00000105146 ENSG00000198848 
##              10              10</code></pre>
<pre class="r"><code>names &lt;- colnames(betahat_mat)[imp_genes]</code></pre>
<pre class="r"><code>write.table(names, file = &quot;../utilities/sex_ash/sex_genes_ash_0_05.txt&quot;, quote = FALSE, row.names = FALSE, col.names = FALSE)
out &lt;- mygene::queryMany(names,  scopes=&quot;ensembl.gene&quot;, fields=c(&quot;name&quot;, &quot;summary&quot;), species=&quot;human&quot;);</code></pre>
<pre><code>## Finished
## Pass returnall=TRUE to return lists of duplicate or missing query terms.</code></pre>
<pre class="r"><code>cbind.data.frame(out$name, out$summary)</code></pre>
<pre><code>##                                                                      out$name
## 1                                                                        &lt;NA&gt;
## 2                              FSHD region gene 1 family member B, pseudogene
## 3          eukaryotic translation initiation factor 1A, X-linked pseudogene 1
## 4                                          sperm equatorial segment protein 1
## 5                                                        DEAD-box helicase 43
## 6  Putative eukaryotic translation initiation factor 2 subunit 3-like protein
## 7                                             protease, serine, 30 pseudogene
## 8                                                           MIR4458 host gene
## 9                                                             aurora kinase C
## 10                                                         carboxylesterase 1
##                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                           out$summary
## 1                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                &lt;NA&gt;
## 2                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                &lt;NA&gt;
## 3                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                &lt;NA&gt;
## 4                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                The encoded protein is a human alloantigen involved in sperm-egg binding and fusion.
## 5                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                    The protein encoded by this gene is an ATP-dependent RNA helicase in the DEAD-box family and displays tumor-specific expression.
## 6                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                &lt;NA&gt;
## 7                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                &lt;NA&gt;
## 8                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                &lt;NA&gt;
## 9                                                                                                                        This gene encodes a member of the Aurora subfamily of serine/threonine protein kinases. The encoded protein is a chromosomal passenger protein that forms complexes with Aurora-B and inner centromere proteins and may play a role in organizing microtubules in relation to centrosome/spindle function during mitosis. This gene is overexpressed in several cancer cell lines, suggesting an involvement in oncogenic signal transduction. Alternative splicing results in multiple transcript variants.
## 10 This gene encodes a member of the carboxylesterase large family. The family members are responsible for the hydrolysis or transesterification of various xenobiotics, such as cocaine and heroin, and endogenous substrates with ester, thioester, or amide bonds. They may participate in fatty acyl and cholesterol ester metabolism, and may play a role in the blood-brain barrier system. This enzyme is the major liver enzyme and functions in liver drug clearance. Mutations of this gene cause carboxylesterase 1 deficiency. Three transcript variants encoding three different isoforms have been found for this gene.</code></pre>
<pre class="r"><code>pathway2 &lt;- read.delim(&quot;../utilities/sex_ash/sex_genes_ash_0_05_pathways_1.tab&quot;)</code></pre>
<pre><code>## Warning in read.table(file = file, header = header, sep = sep, quote =
## quote, : incomplete final line found by readTableHeader on &#39;../utilities/
## sex_ash/sex_genes_ash_0_05_pathways_1.tab&#39;</code></pre>
<pre class="r"><code>if(length(which(pathway2$q.value &lt; 0.05)) &gt; 2){
  pathway2 &lt;- pathway2[which(pathway2$q.value &lt; 0.05),]
}
maxpath = 75
pathway &lt;- pathway2[1:min(maxpath, dim(pathway2)[1]), ]
ensembl_genes &lt;- pathway$members_input_overlap
pathway_list_genes &lt;- sapply(ensembl_genes, function(x) return(strsplit(as.character(x), &quot;; &quot;)))
all_genes &lt;- Reduce(union, pathway_list_genes)
pathway_mat &lt;- matrix(0, length(pathway_list_genes), length(all_genes))
for(l in 1:dim(pathway_mat)[1]){
  pathway_mat[l, match(pathway_list_genes[[l]], all_genes)] &lt;- 1
}

pathway_bimat &lt;- (pathway_mat)%*%t(pathway_mat)
pathway_bimat_prop &lt;- diag(1/sqrt(diag(pathway_bimat)), dim(pathway_bimat)[1]) %*% pathway_bimat %*% diag(1/sqrt(diag(pathway_bimat)), dim(pathway_bimat)[1])

col=c(rev(rgb(seq(1,0,length=1000),1,seq(1,0,length=1000))),
      rgb(1,seq(1,0,length=1000),seq(1,0,length=1000)))
heatmap(pathway_bimat_prop, labRow = pathway$pathway, labCol = pathway$pathway, cexRow = 1, cexCol = 1, col = col, zlim = c(-1,1),
        scale = &quot;none&quot;, margins = c(5, 5))</code></pre>
<p><img src="sex_compare_study_ash_files/figure-html/unnamed-chunk-8-1.png" width="672" /></p>
<pre class="r"><code>num_lfsr_below_thresh &lt;- apply(lfsr_mat, 2, function(x) return(length(which(x &lt; 0.05))))

imp_genes &lt;- order(num_lfsr_below_thresh, decreasing = TRUE)[1:25]
num_lfsr_below_thresh[imp_genes]</code></pre>
<pre><code>## ENSG00000225490 ENSG00000149531 ENSG00000236698 ENSG00000258484 
##              43              39              36              36 
## ENSG00000080007 ENSG00000180574 ENSG00000172460 ENSG00000247516 
##              33              33              24              17 
## ENSG00000105146 ENSG00000198848 ENSG00000249790 ENSG00000186281 
##              10              10               8               7 
## ENSG00000134882 ENSG00000175701 ENSG00000204837 ENSG00000224881 
##               6               6               6               6 
## ENSG00000087076 ENSG00000105357 ENSG00000116663 ENSG00000117594 
##               5               5               5               5 
## ENSG00000159212 ENSG00000164944 ENSG00000168734 ENSG00000233223 
##               5               5               5               5 
## ENSG00000069702 
##               4</code></pre>
<pre class="r"><code>names &lt;- colnames(betahat_mat)[imp_genes]</code></pre>
<pre class="r"><code>write.table(names, file = &quot;../utilities/sex_ash/sex_genes_ash_0_05_2.txt&quot;, quote = FALSE, row.names = FALSE, col.names = FALSE)
out &lt;- mygene::queryMany(names,  scopes=&quot;ensembl.gene&quot;, fields=c(&quot;name&quot;, &quot;summary&quot;), species=&quot;human&quot;);</code></pre>
<pre><code>## Finished
## Pass returnall=TRUE to return lists of duplicate or missing query terms.</code></pre>
<pre class="r"><code>cbind.data.frame(out$name, out$summary)</code></pre>
<pre><code>##                                                                      out$name
## 1                                                                        &lt;NA&gt;
## 2                              FSHD region gene 1 family member B, pseudogene
## 3          eukaryotic translation initiation factor 1A, X-linked pseudogene 1
## 4                                          sperm equatorial segment protein 1
## 5                                                        DEAD-box helicase 43
## 6  Putative eukaryotic translation initiation factor 2 subunit 3-like protein
## 7                                             protease, serine, 30 pseudogene
## 8                                                           MIR4458 host gene
## 9                                                             aurora kinase C
## 10                                                         carboxylesterase 1
## 11                                                                       &lt;NA&gt;
## 12                      glycerol-3-phosphate acyltransferase 2, mitochondrial
## 13                                                    UBA domain containing 2
## 14                                 long intergenic non-protein coding RNA 116
## 15                                    fibroblast growth factor 7 pseudogene 3
## 16                                                                       &lt;NA&gt;
## 17                                    hydroxysteroid 17-beta dehydrogenase 14
## 18                                                      myosin heavy chain 14
## 19                                                            F-box protein 6
## 20                                     hydroxysteroid 11-beta dehydrogenase 1
## 21                                           chloride intracellular channel 6
## 22                                  vir like m6A methyltransferase associated
## 23                              cAMP-dependent protein kinase inhibitor gamma
## 24                                               uncharacterized LOC100996842
## 25                                 transforming growth factor beta receptor 3
##                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                         out$summary
## 1                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                              &lt;NA&gt;
## 2                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                              &lt;NA&gt;
## 3                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                              &lt;NA&gt;
## 4                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                              The encoded protein is a human alloantigen involved in sperm-egg binding and fusion.
## 5                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                  The protein encoded by this gene is an ATP-dependent RNA helicase in the DEAD-box family and displays tumor-specific expression.
## 6                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                              &lt;NA&gt;
## 7                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                              &lt;NA&gt;
## 8                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                              &lt;NA&gt;
## 9                                                                                                                                                                                                                                                      This gene encodes a member of the Aurora subfamily of serine/threonine protein kinases. The encoded protein is a chromosomal passenger protein that forms complexes with Aurora-B and inner centromere proteins and may play a role in organizing microtubules in relation to centrosome/spindle function during mitosis. This gene is overexpressed in several cancer cell lines, suggesting an involvement in oncogenic signal transduction. Alternative splicing results in multiple transcript variants.
## 10                                                                                                                               This gene encodes a member of the carboxylesterase large family. The family members are responsible for the hydrolysis or transesterification of various xenobiotics, such as cocaine and heroin, and endogenous substrates with ester, thioester, or amide bonds. They may participate in fatty acyl and cholesterol ester metabolism, and may play a role in the blood-brain barrier system. This enzyme is the major liver enzyme and functions in liver drug clearance. Mutations of this gene cause carboxylesterase 1 deficiency. Three transcript variants encoding three different isoforms have been found for this gene.
## 11                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                             &lt;NA&gt;
## 12                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                             &lt;NA&gt;
## 13                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                             &lt;NA&gt;
## 14                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                             &lt;NA&gt;
## 15                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                             &lt;NA&gt;
## 16                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                             &lt;NA&gt;
## 17                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                       17-beta-hydroxysteroid dehydrogenases, such as HSD17B14, are primarily involved in metabolism of steroids at the C17 position and also of other substrates, such as fatty acids, prostaglandins, and xenobiotics (Lukacik et al., 2007 [PubMed 17067289]).
## 18                                                                                                                                                                                                                                                         This gene encodes a member of the myosin superfamily. The protein represents a conventional non-muscle myosin; it should not be confused with the unconventional myosin-14 (MYO14). Myosins are actin-dependent motor proteins with diverse functions including regulation of cytokinesis, cell motility, and cell polarity. Mutations in this gene result in one form of autosomal dominant hearing impairment. Multiple transcript variants encoding different isoforms have been found for this gene.
## 19 This gene encodes a member of the F-box protein family which is characterized by an approximately 40 amino acid motif, the F-box. The F-box proteins constitute one of the four subunits of the ubiquitin protein ligase complex called SCFs (SKP1-cullin-F-box), which function in phosphorylation-dependent ubiquitination. The F-box proteins are divided into 3 classes: Fbws containing WD-40 domains, Fbls containing leucine-rich repeats, and Fbxs containing either different protein-protein interaction modules or no recognizable motifs. The protein encoded by this gene belongs to the Fbxs class, and its C-terminal region is highly similar to that of rat NFB42 (neural F Box 42 kDa) which may be involved in the control of the cell cycle.
## 20                                                                                          The protein encoded by this gene is a microsomal enzyme that catalyzes the conversion of the stress hormone cortisol to the inactive metabolite cortisone. In addition, the encoded protein can catalyze the reverse reaction, the conversion of cortisone to cortisol. Too much cortisol can lead to central obesity, and a particular variation in this gene has been associated with obesity and insulin resistance in children. Mutations in this gene and H6PD (hexose-6-phosphate dehydrogenase (glucose 1-dehydrogenase)) are the cause of cortisone reductase deficiency. Alternate splicing results in multiple transcript variants encoding the same protein.
## 21                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                 This gene encodes a member of the chloride intracellular channel family of proteins. The gene is part of a large triplicated region found on chromosomes 1, 6, and 21. Alternative splicing results in multiple transcript variants encoding different isoforms.
## 22                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                             &lt;NA&gt;
## 23                                                                                                                                                                                                                                                                                                                                                                            This gene encodes a member of the protein kinase inhibitor family. Studies of a similar protein in mice suggest that this protein acts as a potent competitive cAMP-dependent protein kinase inhibitor, and is a predominant form of inhibitor in various tissues. The encoded protein may be involved in osteogenesis. Alternative splicing results in multiple transcript variants.
## 24                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                             &lt;NA&gt;
## 25                                                                                                                                                                                                                                                                     This locus encodes the transforming growth factor (TGF)-beta type III receptor. The encoded receptor is a membrane proteoglycan that often functions as a co-receptor with other TGF-beta receptor superfamily members. Ectodomain shedding produces soluble TGFBR3, which may inhibit TGFB signaling. Decreased expression of this receptor has been observed in various cancers. Alternatively spliced transcript variants encoding different isoforms have been identified for this gene.</code></pre>
<pre class="r"><code>pathway2 &lt;- read.delim(&quot;../utilities/sex_ash/sex_genes_ash_0_05_pathways_2.tab&quot;)</code></pre>
<pre><code>## Warning in read.table(file = file, header = header, sep = sep, quote =
## quote, : incomplete final line found by readTableHeader on &#39;../utilities/
## sex_ash/sex_genes_ash_0_05_pathways_2.tab&#39;</code></pre>
<pre class="r"><code>if(length(which(pathway2$q.value &lt; 0.05)) &gt; 2){
  pathway2 &lt;- pathway2[which(pathway2$q.value &lt; 0.05),]
}
maxpath = 75
pathway &lt;- pathway2[1:min(maxpath, dim(pathway2)[1]), ]
ensembl_genes &lt;- pathway$members_input_overlap
pathway_list_genes &lt;- sapply(ensembl_genes, function(x) return(strsplit(as.character(x), &quot;; &quot;)))
all_genes &lt;- Reduce(union, pathway_list_genes)
pathway_mat &lt;- matrix(0, length(pathway_list_genes), length(all_genes))
for(l in 1:dim(pathway_mat)[1]){
  pathway_mat[l, match(pathway_list_genes[[l]], all_genes)] &lt;- 1
}

pathway_bimat &lt;- (pathway_mat)%*%t(pathway_mat)
pathway_bimat_prop &lt;- diag(1/sqrt(diag(pathway_bimat)), dim(pathway_bimat)[1]) %*% pathway_bimat %*% diag(1/sqrt(diag(pathway_bimat)), dim(pathway_bimat)[1])

col=c(rev(rgb(seq(1,0,length=1000),1,seq(1,0,length=1000))),
      rgb(1,seq(1,0,length=1000),seq(1,0,length=1000)))
heatmap(pathway_bimat_prop, labRow = pathway$pathway, labCol = pathway$pathway, cexRow = 1, cexCol = 1, col = col, zlim = c(-1,1),
        scale = &quot;none&quot;, margins = c(5, 5))</code></pre>
<p><img src="sex_compare_study_ash_files/figure-html/unnamed-chunk-11-1.png" width="672" /></p>
</div>
<div id="lfsr-threshold-0.1" class="section level2">
<h2>lfsr threshold 0.1</h2>
<p>We look at which genes have the most number of lfsr values below a chosen threshold.</p>
<pre class="r"><code>num_lfsr_below_thresh &lt;- apply(lfsr_mat, 2, function(x) return(length(which(x &lt; 0.1))))

imp_genes &lt;- order(num_lfsr_below_thresh, decreasing = TRUE)[1:25]
num_lfsr_below_thresh[imp_genes]</code></pre>
<pre><code>## ENSG00000225490 ENSG00000149531 ENSG00000180574 ENSG00000080007 
##              44              41              37              36 
## ENSG00000236698 ENSG00000258484 ENSG00000172460 ENSG00000247516 
##              36              36              31              20 
## ENSG00000105146 ENSG00000198848 ENSG00000204837 ENSG00000186281 
##              14              10              10               9 
## ENSG00000224881 ENSG00000249790 ENSG00000134882 ENSG00000215548 
##               8               8               7               7 
## ENSG00000095932 ENSG00000118046 ENSG00000159212 ENSG00000167100 
##               6               6               6               6 
## ENSG00000168734 ENSG00000175701 ENSG00000233223 ENSG00000237238 
##               6               6               6               6 
## ENSG00000071051 
##               5</code></pre>
<pre class="r"><code>names &lt;- colnames(betahat_mat)[imp_genes]</code></pre>
<pre class="r"><code>write.table(names, file = &quot;../utilities/sex_ash/sex_genes_ash_0_1.txt&quot;, quote = FALSE, row.names = FALSE, col.names = FALSE)
out &lt;- mygene::queryMany(names,  scopes=&quot;ensembl.gene&quot;, fields=c(&quot;name&quot;, &quot;summary&quot;), species=&quot;human&quot;);</code></pre>
<pre><code>## Finished
## Pass returnall=TRUE to return lists of duplicate or missing query terms.</code></pre>
<pre class="r"><code>cbind.data.frame(out$name, out$summary)</code></pre>
<pre><code>##                                                                      out$name
## 1                                                                        &lt;NA&gt;
## 2                              FSHD region gene 1 family member B, pseudogene
## 3  Putative eukaryotic translation initiation factor 2 subunit 3-like protein
## 4                                                        DEAD-box helicase 43
## 5          eukaryotic translation initiation factor 1A, X-linked pseudogene 1
## 6                                          sperm equatorial segment protein 1
## 7                                             protease, serine, 30 pseudogene
## 8                                                           MIR4458 host gene
## 9                                                             aurora kinase C
## 10                                                         carboxylesterase 1
## 11                                    fibroblast growth factor 7 pseudogene 3
## 12                      glycerol-3-phosphate acyltransferase 2, mitochondrial
## 13                                                                       &lt;NA&gt;
## 14                                                                       &lt;NA&gt;
## 15                                                    UBA domain containing 2
## 16                             FSHD region gene 1 family member J, pseudogene
## 17                                         small integral membrane protein 24
## 18                                                 serine/threonine kinase 11
## 19                                           chloride intracellular channel 6
## 20                                   sterile alpha motif domain containing 14
## 21                              cAMP-dependent protein kinase inhibitor gamma
## 22                                 long intergenic non-protein coding RNA 116
## 23                                               uncharacterized LOC100996842
## 24                             BMS1, ribosome biogenesis factor pseudogene 10
## 25                                                      NCK adaptor protein 2
##                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                           out$summary
## 1                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                &lt;NA&gt;
## 2                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                &lt;NA&gt;
## 3                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                &lt;NA&gt;
## 4                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                    The protein encoded by this gene is an ATP-dependent RNA helicase in the DEAD-box family and displays tumor-specific expression.
## 5                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                &lt;NA&gt;
## 6                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                The encoded protein is a human alloantigen involved in sperm-egg binding and fusion.
## 7                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                &lt;NA&gt;
## 8                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                &lt;NA&gt;
## 9                                                                                                                        This gene encodes a member of the Aurora subfamily of serine/threonine protein kinases. The encoded protein is a chromosomal passenger protein that forms complexes with Aurora-B and inner centromere proteins and may play a role in organizing microtubules in relation to centrosome/spindle function during mitosis. This gene is overexpressed in several cancer cell lines, suggesting an involvement in oncogenic signal transduction. Alternative splicing results in multiple transcript variants.
## 10 This gene encodes a member of the carboxylesterase large family. The family members are responsible for the hydrolysis or transesterification of various xenobiotics, such as cocaine and heroin, and endogenous substrates with ester, thioester, or amide bonds. They may participate in fatty acyl and cholesterol ester metabolism, and may play a role in the blood-brain barrier system. This enzyme is the major liver enzyme and functions in liver drug clearance. Mutations of this gene cause carboxylesterase 1 deficiency. Three transcript variants encoding three different isoforms have been found for this gene.
## 11                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                               &lt;NA&gt;
## 12                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                               &lt;NA&gt;
## 13                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                               &lt;NA&gt;
## 14                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                               &lt;NA&gt;
## 15                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                               &lt;NA&gt;
## 16                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                               &lt;NA&gt;
## 17                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                               &lt;NA&gt;
## 18                                                                                                                             This gene, which encodes a member of the serine/threonine kinase family, regulates cell polarity and functions as a tumor suppressor. Mutations in this gene have been associated with Peutz-Jeghers syndrome, an autosomal dominant disorder characterized by the growth of polyps in the gastrointestinal tract, pigmented macules on the skin and mouth, and other neoplasms. Alternate transcriptional splice variants of this gene have been observed but have not been thoroughly characterized.
## 19                                                                                                                                                                                                                                                                                                                                                                   This gene encodes a member of the chloride intracellular channel family of proteins. The gene is part of a large triplicated region found on chromosomes 1, 6, and 21. Alternative splicing results in multiple transcript variants encoding different isoforms.
## 20                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                               &lt;NA&gt;
## 21                                                                                                                                                                                                                                              This gene encodes a member of the protein kinase inhibitor family. Studies of a similar protein in mice suggest that this protein acts as a potent competitive cAMP-dependent protein kinase inhibitor, and is a predominant form of inhibitor in various tissues. The encoded protein may be involved in osteogenesis. Alternative splicing results in multiple transcript variants.
## 22                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                               &lt;NA&gt;
## 23                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                               &lt;NA&gt;
## 24                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                               &lt;NA&gt;
## 25                                                                                                          This gene encodes a member of the NCK family of adaptor proteins. The protein contains three SH3 domains and one SH2 domain. The protein has no known catalytic function but has been shown to bind and recruit various proteins involved in the regulation of receptor protein tyrosine kinases. It is through these regulatory activities that this protein is believed to be involved in cytoskeletal reorganization. Alternate transcriptional splice variants, encoding different isoforms, have been characterized.</code></pre>
<pre class="r"><code>pathway2 &lt;- read.delim(&quot;../utilities/sex_ash/sex_genes_ash_0_1_pathways.tab&quot;)
if(length(which(pathway2$q.value &lt; 0.05)) &gt; 2){
  pathway2 &lt;- pathway2[which(pathway2$q.value &lt; 0.05),]
}
maxpath = 75
pathway &lt;- pathway2[1:min(maxpath, dim(pathway2)[1]), ]
ensembl_genes &lt;- pathway$members_input_overlap
pathway_list_genes &lt;- sapply(ensembl_genes, function(x) return(strsplit(as.character(x), &quot;; &quot;)))
all_genes &lt;- Reduce(union, pathway_list_genes)
pathway_mat &lt;- matrix(0, length(pathway_list_genes), length(all_genes))
for(l in 1:dim(pathway_mat)[1]){
  pathway_mat[l, match(pathway_list_genes[[l]], all_genes)] &lt;- 1
}

pathway_bimat &lt;- (pathway_mat)%*%t(pathway_mat)
pathway_bimat_prop &lt;- diag(1/sqrt(diag(pathway_bimat)), dim(pathway_bimat)[1]) %*% pathway_bimat %*% diag(1/sqrt(diag(pathway_bimat)), dim(pathway_bimat)[1])

col=c(rev(rgb(seq(1,0,length=1000),1,seq(1,0,length=1000))),
      rgb(1,seq(1,0,length=1000),seq(1,0,length=1000)))
heatmap(pathway_bimat_prop, labRow = pathway$pathway, labCol = pathway$pathway, cexRow = 0.3, cexCol = 0.3, col = col, zlim = c(-1,1),
        scale = &quot;none&quot;, margins = c(5, 5))</code></pre>
<p><img src="sex_compare_study_ash_files/figure-html/unnamed-chunk-14-1.png" width="672" /></p>
</div>
<div id="review-of-genes" class="section level2">
<h2>Review of genes</h2>
<p>A sex based study across tissues for genes (that misses pseudogenes) is in the following <a href="http://biorxiv.org/content/biorxiv/early/2016/10/20/082289.full.pdf">Article</a>.</p>
<p>The important genes are <strong>ENSG00000225490</strong>, <strong>ENSG00000149531</strong>, <strong>ENSG00000236698</strong>, <strong>ENSG00000258484</strong>, <strong>ENSG00000080007</strong> and <strong>ENSG00000180574</strong>.</p>
<p>We know very little about ENSG00000225490 as it does not appear to be a valid gene. I mainly found this <a href="http://www.bcgsc.ca/people/malachig/htdocs/alexa_platform/alexa_seq/Oligo/genes/chr20_2/ENSG00000225490.htm">Article</a>.</p>
<p>FRG1BP or ENSG00000149531 is another pseudoegene.</p>
<p>ENSG00000236698 or EIF1AXP1 is X-linked pseudogene. <a href="http://www.bcgsc.ca/people/malachig/htdocs/alexa_platform/alexa_seq/AllenBrain/genes/chr1_2/ENSG00000236698.htm">Article</a>.</p>
<p>SPESP1 (sperm equatorial segment protein 1) or ENSG00000258484 is a gene enriched in Testis <a href="http://www.proteinatlas.org/ENSG00000258484-SPESP1/tissue">Page</a>.</p>
<p><a href="http://biorxiv.org/content/biorxiv/early/2016/10/20/082289.full.pdf">Article</a> looks into some of these genes to have shared sexual effects across tissues.</p>
<p>DDX43 or ENSG00000080007 is highly expressed in human tissues.</p>
<p>ENSG00000180574 or AC068775.1 is an eukaryotic translation initiation factor.</p>
</div>
<div id="ensg00000225490" class="section level2">
<h2>ENSG00000225490</h2>
<p>Check the read expression profile in GTEx here</p>
<p><a href="https://gtexportal.org/home/gene/ENSG00000225490">ENSG00000225490</a></p>
<pre class="r"><code>betahat_sebetahat_2 &lt;- get(load(&quot;../output/sex_cor_nonmash.rda&quot;))
tmat &lt;- betahat_sebetahat_2$betahat/betahat_sebetahat_2$sebetahat</code></pre>
<pre class="r"><code>indices &lt;- match(&quot;ENSG00000225490&quot;, colnames(betahat_mat))</code></pre>
<pre class="r"><code>plot(tmat[, indices], col=&quot;red&quot;)
abline(0,0)</code></pre>
<p><img src="sex_compare_study_ash_files/figure-html/unnamed-chunk-17-1.png" width="672" /></p>
<p>Which are the tissues with lowest lfsr</p>
<pre class="r"><code>sort(lfsr_mat[,indices], decreasing = FALSE)[1:5]</code></pre>
<pre><code>## Adipose - Subcutaneous         Artery - Aorta        Artery - Tibial 
##                      0                      0                      0 
##     Colon - Transverse Esophagus - Muscularis 
##                      0                      0</code></pre>
<pre class="r"><code>par(mfrow = c(3,3))
for(j in 1:53){
  ll &lt;-lm(person_tissue_genes[,j,indices] ~ sample_attributes$SEX)
  temp1 &lt;- person_tissue_genes[,j,indices]
  temp2 &lt;- sample_attributes$SEX
  temp11 &lt;- temp1[which(!is.na(temp1))]
  temp21 &lt;- temp2[which(!is.na(temp1))]
  temp1_M  &lt;- temp11[which(temp21 == 1)]
  temp1_F  &lt;- temp11[which(temp21 == 2)]
  plot(temp11, col=factor(temp21), ylab = dimnames(person_tissue_genes)[[2]][j])
}</code></pre>
<p><img src="sex_compare_study_ash_files/figure-html/unnamed-chunk-19-1.png" width="672" /><img src="sex_compare_study_ash_files/figure-html/unnamed-chunk-19-2.png" width="672" /><img src="sex_compare_study_ash_files/figure-html/unnamed-chunk-19-3.png" width="672" /><img src="sex_compare_study_ash_files/figure-html/unnamed-chunk-19-4.png" width="672" /><img src="sex_compare_study_ash_files/figure-html/unnamed-chunk-19-5.png" width="672" /><img src="sex_compare_study_ash_files/figure-html/unnamed-chunk-19-6.png" width="672" /></p>
<pre class="r"><code>col=c(rev(rgb(seq(1,0,length=1000),1,seq(1,0,length=1000))),
      rgb(1,seq(1,0,length=1000),seq(1,0,length=1000)))
image(as.matrix(ash_cor_mat[order_index,order_index, indices]),
      col=col, main=paste0(&quot;corshrink: &quot;), cex.main=2,
      xaxt = &quot;n&quot;, yaxt = &quot;n&quot;, zlim=c(-1,1))
axis(1, at = seq(0, 1, length.out = 53), labels = U[order_index], las=2, cex.axis = 0.5)
axis(2, at = seq(0, 1, length.out = 53), labels = U[order_index], las=2, cex.axis = 0.5)</code></pre>
<p><img src="sex_compare_study_ash_files/figure-html/unnamed-chunk-20-1.png" width="672" /></p>
</div>
<div id="ensg00000149531" class="section level2">
<h2>ENSG00000149531</h2>
<p>Check the read expression profile in GTEx here</p>
<p><a href="https://gtexportal.org/home/gene/ENSG00000149531">ENSG00000149531</a></p>
<pre class="r"><code>betahat_sebetahat_2 &lt;- get(load(&quot;../output/sex_cor_nonmash.rda&quot;))
tmat &lt;- betahat_sebetahat_2$betahat/betahat_sebetahat_2$sebetahat</code></pre>
<pre class="r"><code>indices &lt;- match(&quot;ENSG00000149531&quot;, colnames(betahat_mat))</code></pre>
<pre class="r"><code>plot(tmat[, indices], col=&quot;red&quot;)
abline(0,0)</code></pre>
<p><img src="sex_compare_study_ash_files/figure-html/unnamed-chunk-23-1.png" width="672" /></p>
<p>Which are the tissues with lowest lfsr</p>
<pre class="r"><code>sort(lfsr_mat[,indices], decreasing = FALSE)[1:5]</code></pre>
<pre><code>## Adipose - Subcutaneous                Thyroid        Artery - Tibial 
##          -2.220446e-16           1.110223e-16           1.443290e-15 
##      Muscle - Skeletal     Esophagus - Mucosa 
##           8.104628e-15           1.010303e-14</code></pre>
<pre class="r"><code>par(mfrow = c(3,3))
for(j in 1:53){
  ll &lt;-lm(person_tissue_genes[,j,indices] ~ sample_attributes$SEX)
  temp1 &lt;- person_tissue_genes[,j,indices]
  temp2 &lt;- sample_attributes$SEX
  temp11 &lt;- temp1[which(!is.na(temp1))]
  temp21 &lt;- temp2[which(!is.na(temp1))]
  temp1_M  &lt;- temp11[which(temp21 == 1)]
  temp1_F  &lt;- temp11[which(temp21 == 2)]
  plot(temp11, col=factor(temp21), ylab = dimnames(person_tissue_genes)[[2]][j])
}</code></pre>
<p><img src="sex_compare_study_ash_files/figure-html/unnamed-chunk-25-1.png" width="672" /><img src="sex_compare_study_ash_files/figure-html/unnamed-chunk-25-2.png" width="672" /><img src="sex_compare_study_ash_files/figure-html/unnamed-chunk-25-3.png" width="672" /><img src="sex_compare_study_ash_files/figure-html/unnamed-chunk-25-4.png" width="672" /><img src="sex_compare_study_ash_files/figure-html/unnamed-chunk-25-5.png" width="672" /><img src="sex_compare_study_ash_files/figure-html/unnamed-chunk-25-6.png" width="672" /></p>
<pre class="r"><code>col=c(rev(rgb(seq(1,0,length=1000),1,seq(1,0,length=1000))),
      rgb(1,seq(1,0,length=1000),seq(1,0,length=1000)))
image(as.matrix(ash_cor_mat[order_index,order_index, indices]),
      col=col, main=paste0(&quot;corshrink: &quot;), cex.main=2,
      xaxt = &quot;n&quot;, yaxt = &quot;n&quot;, zlim=c(-1,1))
axis(1, at = seq(0, 1, length.out = 53), labels = U[order_index], las=2, cex.axis = 0.5)
axis(2, at = seq(0, 1, length.out = 53), labels = U[order_index], las=2, cex.axis = 0.5)</code></pre>
<p><img src="sex_compare_study_ash_files/figure-html/unnamed-chunk-26-1.png" width="672" /></p>
</div>
<div id="ensg00000236698" class="section level2">
<h2>ENSG00000236698</h2>
<p>Check the read expression profile in GTEx here</p>
<p><a href="https://gtexportal.org/home/gene/ENSG00000236698">ENSG00000236698</a></p>
<pre class="r"><code>betahat_sebetahat_2 &lt;- get(load(&quot;../output/sex_cor_nonmash.rda&quot;))
tmat &lt;- betahat_sebetahat_2$betahat/betahat_sebetahat_2$sebetahat</code></pre>
<pre class="r"><code>indices &lt;- match(&quot;ENSG00000236698&quot;, colnames(betahat_mat))</code></pre>
<pre class="r"><code>plot(tmat[, indices], col=&quot;red&quot;)
abline(0,0)</code></pre>
<p><img src="sex_compare_study_ash_files/figure-html/unnamed-chunk-29-1.png" width="672" /></p>
<p>Which are the tissues with lowest lfsr</p>
<pre class="r"><code>sort(lfsr_mat[,indices], decreasing = FALSE)[1:5]</code></pre>
<pre><code>##                     Artery - Tibial              Adipose - Subcutaneous 
##                        9.940260e-49                        5.388627e-45 
## Cells - EBV-transformed lymphocytes                      Nerve - Tibial 
##                        2.300956e-31                        5.922918e-31 
##     Cells - Transformed fibroblasts 
##                        9.184953e-30</code></pre>
<pre class="r"><code>par(mfrow = c(3,3))
for(j in 1:53){
  ll &lt;-lm(person_tissue_genes[,j,indices] ~ sample_attributes$SEX)
  temp1 &lt;- person_tissue_genes[,j,indices]
  temp2 &lt;- sample_attributes$SEX
  temp11 &lt;- temp1[which(!is.na(temp1))]
  temp21 &lt;- temp2[which(!is.na(temp1))]
  temp1_M  &lt;- temp11[which(temp21 == 1)]
  temp1_F  &lt;- temp11[which(temp21 == 2)]
  plot(temp11, col=factor(temp21), ylab = dimnames(person_tissue_genes)[[2]][j])
}</code></pre>
<p><img src="sex_compare_study_ash_files/figure-html/unnamed-chunk-31-1.png" width="672" /><img src="sex_compare_study_ash_files/figure-html/unnamed-chunk-31-2.png" width="672" /><img src="sex_compare_study_ash_files/figure-html/unnamed-chunk-31-3.png" width="672" /><img src="sex_compare_study_ash_files/figure-html/unnamed-chunk-31-4.png" width="672" /><img src="sex_compare_study_ash_files/figure-html/unnamed-chunk-31-5.png" width="672" /><img src="sex_compare_study_ash_files/figure-html/unnamed-chunk-31-6.png" width="672" /></p>
<pre class="r"><code>col=c(rev(rgb(seq(1,0,length=1000),1,seq(1,0,length=1000))),
      rgb(1,seq(1,0,length=1000),seq(1,0,length=1000)))
image(as.matrix(ash_cor_mat[order_index,order_index, indices]),
      col=col, main=paste0(&quot;corshrink: &quot;), cex.main=2,
      xaxt = &quot;n&quot;, yaxt = &quot;n&quot;, zlim=c(-1,1))
axis(1, at = seq(0, 1, length.out = 53), labels = U[order_index], las=2, cex.axis = 0.5)
axis(2, at = seq(0, 1, length.out = 53), labels = U[order_index], las=2, cex.axis = 0.5)</code></pre>
<p><img src="sex_compare_study_ash_files/figure-html/unnamed-chunk-32-1.png" width="672" /></p>
</div>
<div id="ensg00000258484-or-spesp1" class="section level2">
<h2>ENSG00000258484 or SPESP1</h2>
<p>Check the read expression profile in GTEx here</p>
<p><a href="https://gtexportal.org/home/gene/ENSG00000258484">ENSG00000258484</a></p>
<pre class="r"><code>betahat_sebetahat_2 &lt;- get(load(&quot;../output/sex_cor_nonmash.rda&quot;))
tmat &lt;- betahat_sebetahat_2$betahat/betahat_sebetahat_2$sebetahat</code></pre>
<pre class="r"><code>indices &lt;- match(&quot;ENSG00000258484&quot;, colnames(betahat_mat))</code></pre>
<pre class="r"><code>plot(tmat[, indices], col=&quot;red&quot;)
abline(0,0)</code></pre>
<p><img src="sex_compare_study_ash_files/figure-html/unnamed-chunk-35-1.png" width="672" /></p>
<p>Which are the tissues with lowest lfsr</p>
<pre class="r"><code>sort(lfsr_mat[,indices], decreasing = FALSE)[1:5]</code></pre>
<pre><code>##       Adipose - Subcutaneous            Muscle - Skeletal 
##                 0.000000e+00                 0.000000e+00 
##                      Thyroid               Nerve - Tibial 
##                 2.220446e-15                 8.637535e-14 
## Adipose - Visceral (Omentum) 
##                 1.037392e-12</code></pre>
<pre class="r"><code>par(mfrow = c(3,3))
for(j in 1:53){
  ll &lt;-lm(person_tissue_genes[,j,indices] ~ sample_attributes$SEX)
  temp1 &lt;- person_tissue_genes[,j,indices]
  temp2 &lt;- sample_attributes$SEX
  temp11 &lt;- temp1[which(!is.na(temp1))]
  temp21 &lt;- temp2[which(!is.na(temp1))]
  temp1_M  &lt;- temp11[which(temp21 == 1)]
  temp1_F  &lt;- temp11[which(temp21 == 2)]
  plot(temp11, col=factor(temp21), ylab = dimnames(person_tissue_genes)[[2]][j])
}</code></pre>
<p><img src="sex_compare_study_ash_files/figure-html/unnamed-chunk-37-1.png" width="672" /><img src="sex_compare_study_ash_files/figure-html/unnamed-chunk-37-2.png" width="672" /><img src="sex_compare_study_ash_files/figure-html/unnamed-chunk-37-3.png" width="672" /><img src="sex_compare_study_ash_files/figure-html/unnamed-chunk-37-4.png" width="672" /><img src="sex_compare_study_ash_files/figure-html/unnamed-chunk-37-5.png" width="672" /><img src="sex_compare_study_ash_files/figure-html/unnamed-chunk-37-6.png" width="672" /></p>
<pre class="r"><code>col=c(rev(rgb(seq(1,0,length=1000),1,seq(1,0,length=1000))),
      rgb(1,seq(1,0,length=1000),seq(1,0,length=1000)))
image(as.matrix(ash_cor_mat[order_index,order_index, indices]),
      col=col, main=paste0(&quot;corshrink: &quot;), cex.main=2,
      xaxt = &quot;n&quot;, yaxt = &quot;n&quot;, zlim=c(-1,1))
axis(1, at = seq(0, 1, length.out = 53), labels = U[order_index], las=2, cex.axis = 0.5)
axis(2, at = seq(0, 1, length.out = 53), labels = U[order_index], las=2, cex.axis = 0.5)</code></pre>
<p><img src="sex_compare_study_ash_files/figure-html/unnamed-chunk-38-1.png" width="672" /></p>
</div>

<hr>
<p>
    This <a href="http://rmarkdown.rstudio.com">R Markdown</a> site was created with <a href="https://github.com/jdblischak/workflowr">workflowr</a>
</p>
<hr>

<!-- To enable disqus, uncomment the section below and provide your disqus_shortname -->

<!-- disqus
  <div id="disqus_thread"></div>
    <script type="text/javascript">
        /* * * CONFIGURATION VARIABLES: EDIT BEFORE PASTING INTO YOUR WEBPAGE * * */
        var disqus_shortname = 'rmarkdown'; // required: replace example with your forum shortname

        /* * * DON'T EDIT BELOW THIS LINE * * */
        (function() {
            var dsq = document.createElement('script'); dsq.type = 'text/javascript'; dsq.async = true;
            dsq.src = '//' + disqus_shortname + '.disqus.com/embed.js';
            (document.getElementsByTagName('head')[0] || document.getElementsByTagName('body')[0]).appendChild(dsq);
        })();
    </script>
    <noscript>Please enable JavaScript to view the <a href="http://disqus.com/?ref_noscript">comments powered by Disqus.</a></noscript>
    <a href="http://disqus.com" class="dsq-brlink">comments powered by <span class="logo-disqus">Disqus</span></a>
-->


<!-- dynamically load mathjax for compatibility with self-contained -->
<script>
  (function () {
    var script = document.createElement("script");
    script.type = "text/javascript";
    script.src  = "https://mathjax.rstudio.com/latest/MathJax.js?config=TeX-AMS-MML_HTMLorMML";
    document.getElementsByTagName("head")[0].appendChild(script);
  })();
</script>

</body>
</html>
