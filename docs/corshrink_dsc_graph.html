<!DOCTYPE html>

<html xmlns="http://www.w3.org/1999/xhtml">

<head>

<meta charset="utf-8" />
<meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
<meta name="generator" content="pandoc" />

<meta name="viewport" content="width=device-width, initial-scale=1">

<meta name="author" content="Kushal K Dey" />


<title>CorShrink on dsc simulated data (graph data maker)</title>

<link href="site_libs/highlightjs-1.1/textmate.css" rel="stylesheet" />
<script src="site_libs/highlightjs-1.1/highlight.js"></script>

<style type="text/css">code{white-space: pre;}</style>
<script type="text/javascript">
if (window.hljs && document.readyState && document.readyState === "complete") {
   window.setTimeout(function() {
      hljs.initHighlighting();
   }, 0);
}
</script>




<link rel="stylesheet" href="cosmo.css" type="text/css" />

</head>

<body>


<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <link href="https://fonts.googleapis.com/css?family=Open+Sans:100,300,400,600" rel="stylesheet" type="text/css">
    <link href="../docs/cosmo.css" rel="stylesheet">
    <link href="../docs/cosmo.min.css" rel="stylesheet">
</head>
<script src="https://ajax.googleapis.com/ajax/libs/jquery/1.12.4/jquery.min.js"></script>
<script src="../docs/bootstrap/js/bootstrap.min.js"></script>

<body>

<div class = "nav" align = "middle">
<div class= "p1"></div>
<p>
  <a class="btn btn-large btn btn-primary" type="button" href = "corshrink_front.html">HOME</a> 
  &nbsp &nbsp
  <a class="btn btn-large btn btn-primary" type="button" href = "workflow.html">WORKFLOW</a> 
  &nbsp &nbsp
  <a class="btn btn-large btn btn-primary" type="button" href = "tissue_corr.html">GTEx DEMO</a> 
  &nbsp &nbsp
  <a class="btn btn-large btn btn-primary" type="button" href = "about.html">METHODS</a> 
  &nbsp &nbsp
  <a class="btn btn-large btn btn-primary" type="button" href = "https://github.com/kkdey/CorShrink">SOFTWARE</a> 
  &nbsp &nbsp
  <a class="btn btn-large btn btn-primary" type="button" href = "license.html">LICENSE</a> 
   &nbsp &nbsp
  <a class="btn btn-large btn btn-primary" type="button" href = "https://github.com/kkdey/CorShrink_workflow">GITHUB</a> 
 </p>
</div>  
<!-- <div class="nav">
  <a href="index.html">Home page</a> &nbsp &nbsp
  <a href="musings.html">Musings</a> &nbsp &nbsp
  <a href="town.html">My town</a> &nbsp &nbsp
  <a href="links.html">Links</a>
</div> -->

<!-- Main content -->
</body>
</html>


<h1 class="title toc-ignore">CorShrink on dsc simulated data (graph data maker)</h1>
<h4 class="author"><em>Kushal K Dey</em></h4>
<h4 class="date"><em>6/22/2017</em></h4>


<div id="TOC">
<ul>
<li><a href="#dm-graph-band">DM graph (band)</a><ul>
<li><a href="#n-10-p100">n = 10, P=100</a></li>
<li><a href="#n-50-p100">n = 50, P=100</a></li>
<li><a href="#n-5-p100">n = 5, P=100</a></li>
</ul></li>
<li><a href="#dm-graph-cluster">DM graph (cluster)</a><ul>
<li><a href="#n-10-p100-1">n = 10, P=100</a></li>
<li><a href="#n-50-p100-1">n = 50, P=100</a></li>
<li><a href="#n-5-p100-1">n = 5, P=100</a></li>
</ul></li>
<li><a href="#dm-graph-dense-edors-renyi-graph">DM graph (dense Edors Renyi graph)</a><ul>
<li><a href="#n-10-p100-2">n = 10, P=100</a></li>
<li><a href="#n-50-p100-2">n = 50, P=100</a></li>
<li><a href="#n-5-p100-2">n = 5, P=100</a></li>
</ul></li>
<li><a href="#dm-graph-sparse-edors-renyi-graph">DM graph (sparse Edors Renyi graph)</a><ul>
<li><a href="#n-10-p100-3">n = 10, P=100</a></li>
<li><a href="#n-50-p100-3">n = 50, P=100</a></li>
<li><a href="#n-5-p100-3">n = 5, P=100</a></li>
</ul></li>
<li><a href="#dm-graph-hub-graph">DM graph (hub graph)</a><ul>
<li><a href="#n-10-p100-4">n = 10, P=100</a></li>
<li><a href="#n-50-p100-4">n = 50, P=100</a></li>
<li><a href="#n-5-p100-4">n = 5, P=100</a></li>
</ul></li>
<li><a href="#dm-graph-scale-free-graph">DM graph (scale free graph)</a><ul>
<li><a href="#n-10-p100-5">n = 10, P=100</a></li>
<li><a href="#n-50-p100-5">n = 50, P=100</a></li>
<li><a href="#n-5-p100-5">n = 5, P=100</a></li>
</ul></li>
</ul>
</div>

<pre class="r"><code>library(spcov)
library(CorShrink)
library(corpcor)
library(glasso)
library(huge)</code></pre>
<pre><code>## Loading required package: Matrix</code></pre>
<pre><code>## Loading required package: lattice</code></pre>
<pre><code>## Loading required package: igraph</code></pre>
<pre><code>## 
## Attaching package: &#39;igraph&#39;</code></pre>
<pre><code>## The following objects are masked from &#39;package:stats&#39;:
## 
##     decompose, spectrum</code></pre>
<pre><code>## The following object is masked from &#39;package:base&#39;:
## 
##     union</code></pre>
<pre><code>## Loading required package: MASS</code></pre>
<pre class="r"><code>DM_graph = function(n,P,g_type = NULL,para = NULL){
  library(huge)
  index1=sort(sample(seq(1:n),(n/2)))
  index2=seq(1:n)[-index1]
  if(is.null(g_type)){
    # default is random graph
    data_list = huge.generator(n = n, d = P, prob = para, vis = TRUE)
  }else{
    data_list = huge.generator(n = n, d = P, graph = g_type, g = para, vis = TRUE)
  }
  data = data_list$data
  Xtest = data[index2,]
  Xtrain = data[index1,]
  Sigma = data_list$sigma
  return(list(Xtrain = Xtrain, Xtest = Xtest, Sigma = Sigma))
}</code></pre>
<div id="dm-graph-band" class="section level2">
<h2>DM graph (band)</h2>
<div id="n-10-p100" class="section level3">
<h3>n = 10, P=100</h3>
<pre class="r"><code>n &lt;- 10
P &lt;- 100
ll &lt;- DM_graph(n,P,g_type = &quot;band&quot;,para = 3)</code></pre>
<pre><code>## Generating data from the multivariate normal distribution with the band graph structure....</code></pre>
<p><img src="corshrink_dsc_graph_files/figure-html/unnamed-chunk-3-1.png" width="672" /></p>
<pre><code>## done.</code></pre>
<pre class="r"><code>data &lt;- rbind(ll$Xtrain, ll$Xtest)
Sigma &lt;- ll$Sigma
corSigma &lt;- cov2cor(Sigma)</code></pre>
<pre class="r"><code>col=c(rev(rgb(seq(1,0,length=1000),1,seq(1,0,length=1000))),
      rgb(1,seq(1,0,length=1000),seq(1,0,length=1000)))
image(as.matrix(corSigma),
      col=col, main=paste0(&quot;pop corr: &quot;), cex.main=2,
      xaxt = &quot;n&quot;, yaxt = &quot;n&quot;, zlim=c(-1,1))</code></pre>
<p><img src="corshrink_dsc_graph_files/figure-html/unnamed-chunk-4-1.png" width="576" /></p>
<pre class="r"><code>Pat &lt;- matrix(1, P, P)
diag(Pat) &lt;- 0</code></pre>
<pre class="r"><code>lam &lt;- 0.06
step.size &lt;- 100
tol &lt;- 1e-4
covmat &lt;- cov(data)
mm &lt;- spcov(Sigma=covmat+0.1*diag(1,P), S=covmat+0.1*diag(1,P), lambda=lam * Pat,step.size=step.size, n.inner.steps=200, thr.inner=0, tol.outer=tol, trace=1)</code></pre>
<pre><code>## ---
## using Nesterov, backtracking line search
## ---
## objective:  71.58441
## step size given to GGDescent/Nesterov: 100
## objective:  -38.01335  ( 200 iterations, max step size: 0.0064 )
## Reducing step size to 20
## step size given to GGDescent/Nesterov: 20
## objective:  -39.45003  ( 200 iterations, max step size: 0.0064 )
## Reducing step size to 4
## step size given to GGDescent/Nesterov: 4
## objective:  -39.46565  ( 200 iterations, max step size: 0.00128 )
## Reducing step size to 0.8
## step size given to GGDescent/Nesterov: 0.8
## objective:  -39.46736  ( 200 iterations, max step size: 0.00128 )
## Reducing step size to 0.16
## step size given to GGDescent/Nesterov: 0.16
## objective:  -39.46776  ( 200 iterations, max step size: 0.00128 )
## Reducing step size to 0.032
## step size given to GGDescent/Nesterov: 0.032
## objective:  -39.46788  ( 200 iterations, max step size: 0.00128 )
## step size given to GGDescent/Nesterov: 0.032
## objective:  -39.46791  ( 200 iterations, max step size: 0.00128 )
## MM converged in 7 steps!</code></pre>
<pre class="r"><code>spcor_mat &lt;- cov2cor(mm$Sigma)</code></pre>
<pre class="r"><code>#devtools::install_github(&quot;kkdey/CorShrink&quot;)
#library(CorShrink)
#sessionInfo()
cov_mat &lt;- cov(data);
system.time(strimmer_sample &lt;- corpcor::cov.shrink(data))</code></pre>
<pre><code>## Estimating optimal shrinkage intensity lambda.var (variance vector): 1 
## 
## Estimating optimal shrinkage intensity lambda (correlation matrix): 0.8449</code></pre>
<pre><code>##    user  system elapsed 
##   0.003   0.000   0.006</code></pre>
<pre class="r"><code>system.time(glasso_sample_005 &lt;- glasso::glasso(cov_mat, rho = 0.05))</code></pre>
<pre><code>##    user  system elapsed 
##   0.397   0.001   0.402</code></pre>
<pre class="r"><code>system.time(glasso_sample_05 &lt;- glasso::glasso(cov_mat, rho = 0.5))</code></pre>
<pre><code>##    user  system elapsed 
##   0.029   0.000   0.029</code></pre>
<pre class="r"><code>system.time(glasso_sample_1 &lt;- glasso::glasso(cov_mat, rho = 1))</code></pre>
<pre><code>##    user  system elapsed 
##   0.002   0.000   0.002</code></pre>
<pre class="r"><code>system.time(glasso_sample_10 &lt;- glasso::glasso(cov_mat, rho = 10))</code></pre>
<pre><code>##    user  system elapsed 
##   0.002   0.000   0.002</code></pre>
<pre class="r"><code>system.time(cov_sample_ML &lt;-  CorShrinkML(cov2cor(cov_mat), nsamp_mat = matrix(n, P, P), sd_boot = FALSE, ash.control = list(mixcompdist = &quot;normal&quot;, nullweight = 10)))</code></pre>
<pre><code>## ash cor only and ash cor PD matrices are different</code></pre>
<pre><code>##    user  system elapsed 
##   0.817   0.037   0.875</code></pre>
<pre class="r"><code>col=c(rev(rgb(seq(1,0,length=1000),1,seq(1,0,length=1000))),
      rgb(1,seq(1,0,length=1000),seq(1,0,length=1000)))
image(as.matrix(cov2cor(cov_mat)),
      col=col, main=paste0(&quot;sample corr: &quot;), cex.main=2,
      xaxt = &quot;n&quot;, yaxt = &quot;n&quot;, zlim=c(-1,1))</code></pre>
<p><img src="corshrink_dsc_graph_files/figure-html/unnamed-chunk-9-1.png" width="576" /></p>
<pre class="r"><code>col=c(rev(rgb(seq(1,0,length=1000),1,seq(1,0,length=1000))),
      rgb(1,seq(1,0,length=1000),seq(1,0,length=1000)))
image(as.matrix(cov2cor(strimmer_sample)),
      col=col, main=paste0(&quot;shafer strimmer: &quot;), cex.main=2,
      xaxt = &quot;n&quot;, yaxt = &quot;n&quot;, zlim=c(-1,1))</code></pre>
<p><img src="corshrink_dsc_graph_files/figure-html/unnamed-chunk-10-1.png" width="576" /></p>
<pre class="r"><code>col=c(rev(rgb(seq(1,0,length=1000),1,seq(1,0,length=1000))),
      rgb(1,seq(1,0,length=1000),seq(1,0,length=1000)))
image(as.matrix(cov_sample_ML$ash_cor_only),
      col=col, main=paste0(&quot;corshrink: &quot;), cex.main=2,
      xaxt = &quot;n&quot;, yaxt = &quot;n&quot;, zlim=c(-1,1))</code></pre>
<p><img src="corshrink_dsc_graph_files/figure-html/unnamed-chunk-10-2.png" width="576" /></p>
<pre class="r"><code>col=c(rev(rgb(seq(1,0,length=1000),1,seq(1,0,length=1000))),
      rgb(1,seq(1,0,length=1000),seq(1,0,length=1000)))
image(as.matrix(cov2cor(glasso_sample_005$w)),
      col=col, main=paste0(&quot;glasso 0.05: &quot;), cex.main=2,
      xaxt = &quot;n&quot;, yaxt = &quot;n&quot;, zlim=c(-1,1))</code></pre>
<p><img src="corshrink_dsc_graph_files/figure-html/unnamed-chunk-10-3.png" width="576" /></p>
<pre class="r"><code>col=c(rev(rgb(seq(1,0,length=1000),1,seq(1,0,length=1000))),
      rgb(1,seq(1,0,length=1000),seq(1,0,length=1000)))
image(as.matrix(cov2cor(glasso_sample_05$w)),
      col=col, main=paste0(&quot;glasso 0.5: &quot;), cex.main=2,
      xaxt = &quot;n&quot;, yaxt = &quot;n&quot;, zlim=c(-1,1))</code></pre>
<p><img src="corshrink_dsc_graph_files/figure-html/unnamed-chunk-10-4.png" width="576" /></p>
<pre class="r"><code>col=c(rev(rgb(seq(1,0,length=1000),1,seq(1,0,length=1000))),
      rgb(1,seq(1,0,length=1000),seq(1,0,length=1000)))
image(as.matrix(spcor_mat),
      col=col, main=paste0(&quot;spcov:&quot;, expression(lambda), &quot;=&quot;, lam), cex.main=2,
      xaxt = &quot;n&quot;, yaxt = &quot;n&quot;, zlim=c(-1,1))</code></pre>
<p><img src="corshrink_dsc_graph_files/figure-html/unnamed-chunk-11-1.png" width="576" /></p>
</div>
<div id="n-50-p100" class="section level3">
<h3>n = 50, P=100</h3>
<pre class="r"><code>n &lt;- 50
P &lt;- 100
ll &lt;- DM_graph(n,P,g_type = &quot;band&quot;,para = 3)</code></pre>
<pre><code>## Generating data from the multivariate normal distribution with the band graph structure....</code></pre>
<p><img src="corshrink_dsc_graph_files/figure-html/unnamed-chunk-12-1.png" width="672" /></p>
<pre><code>## done.</code></pre>
<pre class="r"><code>data &lt;- rbind(ll$Xtrain, ll$Xtest)
Sigma &lt;- ll$Sigma
corSigma &lt;- cov2cor(Sigma)</code></pre>
<pre class="r"><code>Pat &lt;- matrix(1, P, P)
diag(Pat) &lt;- 0</code></pre>
<pre class="r"><code>lam &lt;- 0.06
step.size &lt;- 100
tol &lt;- 1e-4
covmat &lt;- cov(data)
mm &lt;- spcov(Sigma=covmat+0.1*diag(1,P), S=covmat+0.1*diag(1,P), lambda=lam * Pat,step.size=step.size, n.inner.steps=200, thr.inner=0, tol.outer=tol, trace=1)</code></pre>
<pre><code>## ---
## using Nesterov, backtracking line search
## ---
## objective:  75.20115
## step size given to GGDescent/Nesterov: 100
## objective:  42.36049  ( 200 iterations, max step size: 0.0064 )
## Reducing step size to 20
## step size given to GGDescent/Nesterov: 20
## objective:  41.4754  ( 200 iterations, max step size: 0.0064 )
## Reducing step size to 4
## step size given to GGDescent/Nesterov: 4
## objective:  41.41366  ( 200 iterations, max step size: 0.0064 )
## Reducing step size to 0.8
## step size given to GGDescent/Nesterov: 0.8
## objective:  41.40577  ( 200 iterations, max step size: 0.0064 )
## Reducing step size to 0.16
## step size given to GGDescent/Nesterov: 0.16
## objective:  41.40408  ( 200 iterations, max step size: 0.0064 )
## Reducing step size to 0.032
## step size given to GGDescent/Nesterov: 0.032
## objective:  41.4036  ( 200 iterations, max step size: 0.0064 )
## step size given to GGDescent/Nesterov: 0.032
## objective:  41.40345  ( 200 iterations, max step size: 0.0064 )
## step size given to GGDescent/Nesterov: 0.032
## objective:  41.4034  ( 200 iterations, max step size: 0.0064 )
## MM converged in 8 steps!</code></pre>
<pre class="r"><code>spcor_mat &lt;- cov2cor(mm$Sigma)</code></pre>
<pre class="r"><code>#devtools::install_github(&quot;kkdey/CorShrink&quot;)
#library(CorShrink)
#sessionInfo()
cov_mat &lt;- cov(data);
system.time(strimmer_sample &lt;- corpcor::cov.shrink(data))</code></pre>
<pre><code>## Estimating optimal shrinkage intensity lambda.var (variance vector): 1 
## 
## Estimating optimal shrinkage intensity lambda (correlation matrix): 0.839</code></pre>
<pre><code>##    user  system elapsed 
##   0.005   0.000   0.006</code></pre>
<pre class="r"><code>system.time(glasso_sample_005 &lt;- glasso::glasso(cov_mat, rho = 0.05))</code></pre>
<pre><code>##    user  system elapsed 
##   0.139   0.000   0.139</code></pre>
<pre class="r"><code>system.time(glasso_sample_05 &lt;- glasso::glasso(cov_mat, rho = 0.5))</code></pre>
<pre><code>##    user  system elapsed 
##   0.002   0.000   0.001</code></pre>
<pre class="r"><code>system.time(glasso_sample_1 &lt;- glasso::glasso(cov_mat, rho = 1))</code></pre>
<pre><code>##    user  system elapsed 
##   0.002   0.000   0.003</code></pre>
<pre class="r"><code>system.time(glasso_sample_10 &lt;- glasso::glasso(cov_mat, rho = 10))</code></pre>
<pre><code>##    user  system elapsed 
##   0.001   0.000   0.002</code></pre>
<pre class="r"><code>system.time(cov_sample_ML &lt;-  CorShrinkML(cov2cor(cov_mat), nsamp_mat = matrix(n, P, P), sd_boot = FALSE, ash.control = list(mixcompdist = &quot;normal&quot;, nullweight = 10)))</code></pre>
<pre><code>## ash cor only and ash cor PD matrices are different</code></pre>
<pre><code>##    user  system elapsed 
##   1.019   0.057   1.093</code></pre>
<pre class="r"><code>col=c(rev(rgb(seq(1,0,length=1000),1,seq(1,0,length=1000))),
      rgb(1,seq(1,0,length=1000),seq(1,0,length=1000)))
image(as.matrix(cov2cor(cov_mat)),
      col=col, main=paste0(&quot;sample corr: &quot;), cex.main=2,
      xaxt = &quot;n&quot;, yaxt = &quot;n&quot;, zlim=c(-1,1))</code></pre>
<p><img src="corshrink_dsc_graph_files/figure-html/unnamed-chunk-17-1.png" width="576" /></p>
<pre class="r"><code>col=c(rev(rgb(seq(1,0,length=1000),1,seq(1,0,length=1000))),
      rgb(1,seq(1,0,length=1000),seq(1,0,length=1000)))
image(as.matrix(cov2cor(strimmer_sample)),
      col=col, main=paste0(&quot;shafer strimmer: &quot;), cex.main=2,
      xaxt = &quot;n&quot;, yaxt = &quot;n&quot;, zlim=c(-1,1))</code></pre>
<p><img src="corshrink_dsc_graph_files/figure-html/unnamed-chunk-18-1.png" width="576" /></p>
<pre class="r"><code>col=c(rev(rgb(seq(1,0,length=1000),1,seq(1,0,length=1000))),
      rgb(1,seq(1,0,length=1000),seq(1,0,length=1000)))
image(as.matrix(cov_sample_ML$ash_cor_only),
      col=col, main=paste0(&quot;corshrink: &quot;), cex.main=2,
      xaxt = &quot;n&quot;, yaxt = &quot;n&quot;, zlim=c(-1,1))</code></pre>
<p><img src="corshrink_dsc_graph_files/figure-html/unnamed-chunk-18-2.png" width="576" /></p>
<pre class="r"><code>col=c(rev(rgb(seq(1,0,length=1000),1,seq(1,0,length=1000))),
      rgb(1,seq(1,0,length=1000),seq(1,0,length=1000)))
image(as.matrix(cov2cor(glasso_sample_005$w)),
      col=col, main=paste0(&quot;glasso 0.05: &quot;), cex.main=2,
      xaxt = &quot;n&quot;, yaxt = &quot;n&quot;, zlim=c(-1,1))</code></pre>
<p><img src="corshrink_dsc_graph_files/figure-html/unnamed-chunk-18-3.png" width="576" /></p>
<pre class="r"><code>col=c(rev(rgb(seq(1,0,length=1000),1,seq(1,0,length=1000))),
      rgb(1,seq(1,0,length=1000),seq(1,0,length=1000)))
image(as.matrix(cov2cor(glasso_sample_05$w)),
      col=col, main=paste0(&quot;glasso 0.5: &quot;), cex.main=2,
      xaxt = &quot;n&quot;, yaxt = &quot;n&quot;, zlim=c(-1,1))</code></pre>
<p><img src="corshrink_dsc_graph_files/figure-html/unnamed-chunk-18-4.png" width="576" /></p>
<pre class="r"><code>col=c(rev(rgb(seq(1,0,length=1000),1,seq(1,0,length=1000))),
      rgb(1,seq(1,0,length=1000),seq(1,0,length=1000)))
image(as.matrix(spcor_mat),
      col=col, main=paste0(&quot;spcov:&quot;, expression(lambda), &quot;=&quot;, lam), cex.main=2,
      xaxt = &quot;n&quot;, yaxt = &quot;n&quot;, zlim=c(-1,1))</code></pre>
<p><img src="corshrink_dsc_graph_files/figure-html/unnamed-chunk-19-1.png" width="576" /></p>
</div>
<div id="n-5-p100" class="section level3">
<h3>n = 5, P=100</h3>
<pre class="r"><code>n &lt;- 5
P &lt;- 100
ll &lt;- DM_graph(n,P,g_type = &quot;band&quot;,para = 3)</code></pre>
<pre><code>## Generating data from the multivariate normal distribution with the band graph structure....</code></pre>
<p><img src="corshrink_dsc_graph_files/figure-html/unnamed-chunk-20-1.png" width="672" /></p>
<pre><code>## done.</code></pre>
<pre class="r"><code>data &lt;- rbind(ll$Xtrain, ll$Xtest)
Sigma &lt;- ll$Sigma
corSigma &lt;- cov2cor(Sigma)</code></pre>
<pre class="r"><code>Pat &lt;- matrix(1, P, P)
diag(Pat) &lt;- 0</code></pre>
<pre class="r"><code>lam &lt;- 0.06
step.size &lt;- 100
tol &lt;- 1e-4
covmat &lt;- cov(data)
mm &lt;- spcov(Sigma=covmat+0.1*diag(1,P), S=covmat+0.1*diag(1,P), lambda=lam * Pat,step.size=step.size, n.inner.steps=200, thr.inner=0, tol.outer=tol, trace=1)</code></pre>
<pre><code>## ---
## using Nesterov, backtracking line search
## ---
## objective:  120.8319
## step size given to GGDescent/Nesterov: 100
## objective:  -57.83396  ( 200 iterations, max step size: 0.0064 )
## Reducing step size to 20
## step size given to GGDescent/Nesterov: 20
## objective:  -62.06624  ( 200 iterations, max step size: 0.032 )
## Reducing step size to 4
## step size given to GGDescent/Nesterov: 4
## objective:  -62.08867  ( 200 iterations, max step size: 0.00128 )
## Reducing step size to 0.8
## step size given to GGDescent/Nesterov: 0.8
## objective:  -62.0903  ( 200 iterations, max step size: 0.00128 )
## Reducing step size to 0.16
## step size given to GGDescent/Nesterov: 0.16
## objective:  -62.09069  ( 200 iterations, max step size: 0.00128 )
## Reducing step size to 0.032
## step size given to GGDescent/Nesterov: 0.032
## objective:  -62.0908  ( 200 iterations, max step size: 0.00128 )
## step size given to GGDescent/Nesterov: 0.032
## objective:  -62.09083  ( 200 iterations, max step size: 0.00128 )
## MM converged in 7 steps!</code></pre>
<pre class="r"><code>spcor_mat &lt;- cov2cor(mm$Sigma)</code></pre>
<pre class="r"><code>#devtools::install_github(&quot;kkdey/CorShrink&quot;)
#library(CorShrink)
#sessionInfo()
cov_mat &lt;- cov(data);
system.time(strimmer_sample &lt;- corpcor::cov.shrink(data))</code></pre>
<pre><code>## Estimating optimal shrinkage intensity lambda.var (variance vector): 0.9574 
## 
## Estimating optimal shrinkage intensity lambda (correlation matrix): 0.7252</code></pre>
<pre><code>##    user  system elapsed 
##   0.002   0.000   0.002</code></pre>
<pre class="r"><code>system.time(glasso_sample_005 &lt;- glasso::glasso(cov_mat, rho = 0.05))</code></pre>
<pre><code>##    user  system elapsed 
##   0.628   0.002   0.630</code></pre>
<pre class="r"><code>system.time(glasso_sample_05 &lt;- glasso::glasso(cov_mat, rho = 0.5))</code></pre>
<pre><code>##    user  system elapsed 
##   0.057   0.000   0.057</code></pre>
<pre class="r"><code>system.time(glasso_sample_1 &lt;- glasso::glasso(cov_mat, rho = 1))</code></pre>
<pre><code>##    user  system elapsed 
##   0.011   0.000   0.010</code></pre>
<pre class="r"><code>system.time(glasso_sample_10 &lt;- glasso::glasso(cov_mat, rho = 10))</code></pre>
<pre><code>##    user  system elapsed 
##   0.001   0.000   0.001</code></pre>
<pre class="r"><code>system.time(cov_sample_ML &lt;-  CorShrinkML(cov2cor(cov_mat), nsamp_mat = matrix(n, P, P), sd_boot = FALSE, ash.control = list(mixcompdist = &quot;normal&quot;, nullweight = 10)))</code></pre>
<pre><code>## ash cor only and ash cor PD matrices are different</code></pre>
<pre><code>##    user  system elapsed 
##  12.468   0.958  13.467</code></pre>
<pre class="r"><code>col=c(rev(rgb(seq(1,0,length=1000),1,seq(1,0,length=1000))),
      rgb(1,seq(1,0,length=1000),seq(1,0,length=1000)))
image(as.matrix(cov2cor(cov_mat)),
      col=col, main=paste0(&quot;sample corr: &quot;), cex.main=2,
      xaxt = &quot;n&quot;, yaxt = &quot;n&quot;, zlim=c(-1,1))</code></pre>
<p><img src="corshrink_dsc_graph_files/figure-html/unnamed-chunk-25-1.png" width="576" /></p>
<pre class="r"><code>col=c(rev(rgb(seq(1,0,length=1000),1,seq(1,0,length=1000))),
      rgb(1,seq(1,0,length=1000),seq(1,0,length=1000)))
image(as.matrix(cov2cor(strimmer_sample)),
      col=col, main=paste0(&quot;shafer strimmer: &quot;), cex.main=2,
      xaxt = &quot;n&quot;, yaxt = &quot;n&quot;, zlim=c(-1,1))</code></pre>
<p><img src="corshrink_dsc_graph_files/figure-html/unnamed-chunk-26-1.png" width="576" /></p>
<pre class="r"><code>col=c(rev(rgb(seq(1,0,length=1000),1,seq(1,0,length=1000))),
      rgb(1,seq(1,0,length=1000),seq(1,0,length=1000)))
image(as.matrix(cov_sample_ML$ash_cor_only),
      col=col, main=paste0(&quot;corshrink: &quot;), cex.main=2,
      xaxt = &quot;n&quot;, yaxt = &quot;n&quot;, zlim=c(-1,1))</code></pre>
<p><img src="corshrink_dsc_graph_files/figure-html/unnamed-chunk-26-2.png" width="576" /></p>
<pre class="r"><code>col=c(rev(rgb(seq(1,0,length=1000),1,seq(1,0,length=1000))),
      rgb(1,seq(1,0,length=1000),seq(1,0,length=1000)))
image(as.matrix(cov2cor(glasso_sample_005$w)),
      col=col, main=paste0(&quot;glasso 0.05: &quot;), cex.main=2,
      xaxt = &quot;n&quot;, yaxt = &quot;n&quot;, zlim=c(-1,1))</code></pre>
<p><img src="corshrink_dsc_graph_files/figure-html/unnamed-chunk-26-3.png" width="576" /></p>
<pre class="r"><code>col=c(rev(rgb(seq(1,0,length=1000),1,seq(1,0,length=1000))),
      rgb(1,seq(1,0,length=1000),seq(1,0,length=1000)))
image(as.matrix(cov2cor(glasso_sample_05$w)),
      col=col, main=paste0(&quot;glasso 0.5: &quot;), cex.main=2,
      xaxt = &quot;n&quot;, yaxt = &quot;n&quot;, zlim=c(-1,1))</code></pre>
<p><img src="corshrink_dsc_graph_files/figure-html/unnamed-chunk-26-4.png" width="576" /></p>
<pre class="r"><code>col=c(rev(rgb(seq(1,0,length=1000),1,seq(1,0,length=1000))),
      rgb(1,seq(1,0,length=1000),seq(1,0,length=1000)))
image(as.matrix(spcor_mat),
      col=col, main=paste0(&quot;spcov:&quot;, expression(lambda), &quot;=&quot;, lam), cex.main=2,
      xaxt = &quot;n&quot;, yaxt = &quot;n&quot;, zlim=c(-1,1))</code></pre>
<p><img src="corshrink_dsc_graph_files/figure-html/unnamed-chunk-27-1.png" width="576" /></p>
</div>
</div>
<div id="dm-graph-cluster" class="section level2">
<h2>DM graph (cluster)</h2>
<div id="n-10-p100-1" class="section level3">
<h3>n = 10, P=100</h3>
<pre class="r"><code>n &lt;- 10
P &lt;- 100
ll &lt;- DM_graph(n,P,g_type = &quot;cluster&quot;, para = 5)</code></pre>
<pre><code>## Generating data from the multivariate normal distribution with the cluster graph structure....</code></pre>
<p><img src="corshrink_dsc_graph_files/figure-html/unnamed-chunk-28-1.png" width="672" /></p>
<pre><code>## done.</code></pre>
<pre class="r"><code>data &lt;- rbind(ll$Xtrain, ll$Xtest)
Sigma &lt;- ll$Sigma
corSigma &lt;- cov2cor(Sigma)</code></pre>
<pre class="r"><code>col=c(rev(rgb(seq(1,0,length=1000),1,seq(1,0,length=1000))),
      rgb(1,seq(1,0,length=1000),seq(1,0,length=1000)))
image(as.matrix(corSigma),
      col=col, main=paste0(&quot;pop corr: &quot;), cex.main=2,
      xaxt = &quot;n&quot;, yaxt = &quot;n&quot;, zlim=c(-1,1))</code></pre>
<p><img src="corshrink_dsc_graph_files/figure-html/unnamed-chunk-29-1.png" width="576" /></p>
<pre class="r"><code>Pat &lt;- matrix(1, P, P)
diag(Pat) &lt;- 0</code></pre>
<pre class="r"><code>lam &lt;- 0.06
step.size &lt;- 100
tol &lt;- 1e-4
covmat &lt;- cov(data)
mm &lt;- spcov(Sigma=covmat+0.1*diag(1,P), S=covmat+0.1*diag(1,P), lambda=lam * Pat,step.size=step.size, n.inner.steps=200, thr.inner=0, tol.outer=tol, trace=1)</code></pre>
<pre><code>## ---
## using Nesterov, backtracking line search
## ---
## objective:  55.75957
## step size given to GGDescent/Nesterov: 100
## objective:  -42.2612  ( 200 iterations, max step size: 0.0064 )
## Reducing step size to 20
## step size given to GGDescent/Nesterov: 20
## objective:  -42.97646  ( 200 iterations, max step size: 0.0064 )
## Reducing step size to 4
## step size given to GGDescent/Nesterov: 4
## objective:  -42.98923  ( 200 iterations, max step size: 0.00128 )
## Reducing step size to 0.8
## step size given to GGDescent/Nesterov: 0.8
## objective:  -42.99083  ( 200 iterations, max step size: 0.00128 )
## Reducing step size to 0.16
## step size given to GGDescent/Nesterov: 0.16
## objective:  -42.99122  ( 200 iterations, max step size: 0.00128 )
## Reducing step size to 0.032
## step size given to GGDescent/Nesterov: 0.032
## objective:  -42.99132  ( 200 iterations, max step size: 0.00128 )
## step size given to GGDescent/Nesterov: 0.032
## objective:  -42.99135  ( 200 iterations, max step size: 0.00128 )
## MM converged in 7 steps!</code></pre>
<pre class="r"><code>spcor_mat &lt;- cov2cor(mm$Sigma)</code></pre>
<pre class="r"><code>#devtools::install_github(&quot;kkdey/CorShrink&quot;)
#library(CorShrink)
#sessionInfo()
cov_mat &lt;- cov(data);
system.time(strimmer_sample &lt;- corpcor::cov.shrink(data))</code></pre>
<pre><code>## Estimating optimal shrinkage intensity lambda.var (variance vector): 0.9377 
## 
## Estimating optimal shrinkage intensity lambda (correlation matrix): 0.8546</code></pre>
<pre><code>##    user  system elapsed 
##   0.002   0.000   0.002</code></pre>
<pre class="r"><code>system.time(glasso_sample_005 &lt;- glasso::glasso(cov_mat, rho = 0.05))</code></pre>
<pre><code>##    user  system elapsed 
##   0.341   0.001   0.341</code></pre>
<pre class="r"><code>system.time(glasso_sample_05 &lt;- glasso::glasso(cov_mat, rho = 0.5))</code></pre>
<pre><code>##    user  system elapsed 
##   0.024   0.000   0.023</code></pre>
<pre class="r"><code>system.time(glasso_sample_1 &lt;- glasso::glasso(cov_mat, rho = 1))</code></pre>
<pre><code>##    user  system elapsed 
##   0.002   0.000   0.002</code></pre>
<pre class="r"><code>system.time(glasso_sample_10 &lt;- glasso::glasso(cov_mat, rho = 10))</code></pre>
<pre><code>##    user  system elapsed 
##   0.001   0.000   0.002</code></pre>
<pre class="r"><code>system.time(cov_sample_ML &lt;-  CorShrinkML(cov2cor(cov_mat), nsamp_mat = matrix(n, P, P), sd_boot = FALSE, ash.control = list(mixcompdist = &quot;normal&quot;, nullweight = 10)))</code></pre>
<pre><code>## ash cor only and ash cor PD matrices are different</code></pre>
<pre><code>##    user  system elapsed 
##   1.092   0.059   1.153</code></pre>
<pre class="r"><code>col=c(rev(rgb(seq(1,0,length=1000),1,seq(1,0,length=1000))),
      rgb(1,seq(1,0,length=1000),seq(1,0,length=1000)))
image(as.matrix(cov2cor(cov_mat)),
      col=col, main=paste0(&quot;sample corr: &quot;), cex.main=2,
      xaxt = &quot;n&quot;, yaxt = &quot;n&quot;, zlim=c(-1,1))</code></pre>
<p><img src="corshrink_dsc_graph_files/figure-html/unnamed-chunk-34-1.png" width="576" /></p>
<pre class="r"><code>col=c(rev(rgb(seq(1,0,length=1000),1,seq(1,0,length=1000))),
      rgb(1,seq(1,0,length=1000),seq(1,0,length=1000)))
image(as.matrix(cov2cor(strimmer_sample)),
      col=col, main=paste0(&quot;shafer strimmer: &quot;), cex.main=2,
      xaxt = &quot;n&quot;, yaxt = &quot;n&quot;, zlim=c(-1,1))</code></pre>
<p><img src="corshrink_dsc_graph_files/figure-html/unnamed-chunk-35-1.png" width="576" /></p>
<pre class="r"><code>col=c(rev(rgb(seq(1,0,length=1000),1,seq(1,0,length=1000))),
      rgb(1,seq(1,0,length=1000),seq(1,0,length=1000)))
image(as.matrix(cov_sample_ML$ash_cor_only),
      col=col, main=paste0(&quot;corshrink: &quot;), cex.main=2,
      xaxt = &quot;n&quot;, yaxt = &quot;n&quot;, zlim=c(-1,1))</code></pre>
<p><img src="corshrink_dsc_graph_files/figure-html/unnamed-chunk-35-2.png" width="576" /></p>
<pre class="r"><code>col=c(rev(rgb(seq(1,0,length=1000),1,seq(1,0,length=1000))),
      rgb(1,seq(1,0,length=1000),seq(1,0,length=1000)))
image(as.matrix(cov2cor(glasso_sample_005$w)),
      col=col, main=paste0(&quot;glasso 0.05: &quot;), cex.main=2,
      xaxt = &quot;n&quot;, yaxt = &quot;n&quot;, zlim=c(-1,1))</code></pre>
<p><img src="corshrink_dsc_graph_files/figure-html/unnamed-chunk-35-3.png" width="576" /></p>
<pre class="r"><code>col=c(rev(rgb(seq(1,0,length=1000),1,seq(1,0,length=1000))),
      rgb(1,seq(1,0,length=1000),seq(1,0,length=1000)))
image(as.matrix(cov2cor(glasso_sample_05$w)),
      col=col, main=paste0(&quot;glasso 0.5: &quot;), cex.main=2,
      xaxt = &quot;n&quot;, yaxt = &quot;n&quot;, zlim=c(-1,1))</code></pre>
<p><img src="corshrink_dsc_graph_files/figure-html/unnamed-chunk-35-4.png" width="576" /></p>
<pre class="r"><code>col=c(rev(rgb(seq(1,0,length=1000),1,seq(1,0,length=1000))),
      rgb(1,seq(1,0,length=1000),seq(1,0,length=1000)))
image(as.matrix(spcor_mat),
      col=col, main=paste0(&quot;spcov:&quot;, expression(lambda), &quot;=&quot;, lam), cex.main=2,
      xaxt = &quot;n&quot;, yaxt = &quot;n&quot;, zlim=c(-1,1))</code></pre>
<p><img src="corshrink_dsc_graph_files/figure-html/unnamed-chunk-36-1.png" width="576" /></p>
</div>
<div id="n-50-p100-1" class="section level3">
<h3>n = 50, P=100</h3>
<pre class="r"><code>n &lt;- 50
P &lt;- 100
ll &lt;- DM_graph(n,P,g_type = &quot;cluster&quot;, para = 5)</code></pre>
<pre><code>## Generating data from the multivariate normal distribution with the cluster graph structure....</code></pre>
<p><img src="corshrink_dsc_graph_files/figure-html/unnamed-chunk-37-1.png" width="672" /></p>
<pre><code>## done.</code></pre>
<pre class="r"><code>data &lt;- rbind(ll$Xtrain, ll$Xtest)
Sigma &lt;- ll$Sigma
corSigma &lt;- cov2cor(Sigma)</code></pre>
<pre class="r"><code>Pat &lt;- matrix(1, P, P)
diag(Pat) &lt;- 0</code></pre>
<pre class="r"><code>lam &lt;- 0.06
step.size &lt;- 100
tol &lt;- 1e-4
covmat &lt;- cov(data)
mm &lt;- spcov(Sigma=covmat+0.1*diag(1,P), S=covmat+0.1*diag(1,P), lambda=lam * Pat,step.size=step.size, n.inner.steps=200, thr.inner=0, tol.outer=tol, trace=1)</code></pre>
<pre><code>## ---
## using Nesterov, backtracking line search
## ---
## objective:  73.17393
## step size given to GGDescent/Nesterov: 100
## objective:  39.53527  ( 200 iterations, max step size: 0.0064 )
## Reducing step size to 20
## step size given to GGDescent/Nesterov: 20
## objective:  38.71049  ( 200 iterations, max step size: 0.0064 )
## Reducing step size to 4
## step size given to GGDescent/Nesterov: 4
## objective:  38.65263  ( 200 iterations, max step size: 0.0064 )
## Reducing step size to 0.8
## step size given to GGDescent/Nesterov: 0.8
## objective:  38.64535  ( 200 iterations, max step size: 0.0064 )
## Reducing step size to 0.16
## step size given to GGDescent/Nesterov: 0.16
## objective:  38.64386  ( 200 iterations, max step size: 0.0064 )
## Reducing step size to 0.032
## step size given to GGDescent/Nesterov: 0.032
## objective:  38.64345  ( 200 iterations, max step size: 0.0064 )
## step size given to GGDescent/Nesterov: 0.032
## objective:  38.64333  ( 200 iterations, max step size: 0.0064 )
## step size given to GGDescent/Nesterov: 0.032
## objective:  38.64329  ( 200 iterations, max step size: 0.0064 )
## MM converged in 8 steps!</code></pre>
<pre class="r"><code>spcor_mat &lt;- cov2cor(mm$Sigma)</code></pre>
<pre class="r"><code>#devtools::install_github(&quot;kkdey/CorShrink&quot;)
#library(CorShrink)
#sessionInfo()
cov_mat &lt;- cov(data);
system.time(strimmer_sample &lt;- corpcor::cov.shrink(data))</code></pre>
<pre><code>## Estimating optimal shrinkage intensity lambda.var (variance vector): 0.8907 
## 
## Estimating optimal shrinkage intensity lambda (correlation matrix): 0.7989</code></pre>
<pre><code>##    user  system elapsed 
##   0.005   0.000   0.005</code></pre>
<pre class="r"><code>system.time(glasso_sample_005 &lt;- glasso::glasso(cov_mat, rho = 0.05))</code></pre>
<pre><code>##    user  system elapsed 
##   0.156   0.001   0.156</code></pre>
<pre class="r"><code>system.time(glasso_sample_05 &lt;- glasso::glasso(cov_mat, rho = 0.5))</code></pre>
<pre><code>##    user  system elapsed 
##   0.002   0.000   0.001</code></pre>
<pre class="r"><code>system.time(glasso_sample_1 &lt;- glasso::glasso(cov_mat, rho = 1))</code></pre>
<pre><code>##    user  system elapsed 
##   0.001   0.000   0.001</code></pre>
<pre class="r"><code>system.time(glasso_sample_10 &lt;- glasso::glasso(cov_mat, rho = 10))</code></pre>
<pre><code>##    user  system elapsed 
##   0.001   0.000   0.002</code></pre>
<pre class="r"><code>system.time(cov_sample_ML &lt;-  CorShrinkML(cov2cor(cov_mat), nsamp_mat = matrix(n, P, P), sd_boot = FALSE, ash.control = list(mixcompdist = &quot;normal&quot;, nullweight = 10)))</code></pre>
<pre><code>## ash cor only and ash cor PD matrices are different</code></pre>
<pre><code>##    user  system elapsed 
##   0.950   0.041   0.994</code></pre>
<pre class="r"><code>col=c(rev(rgb(seq(1,0,length=1000),1,seq(1,0,length=1000))),
      rgb(1,seq(1,0,length=1000),seq(1,0,length=1000)))
image(as.matrix(cov2cor(cov_mat)),
      col=col, main=paste0(&quot;sample corr: &quot;), cex.main=2,
      xaxt = &quot;n&quot;, yaxt = &quot;n&quot;, zlim=c(-1,1))</code></pre>
<p><img src="corshrink_dsc_graph_files/figure-html/unnamed-chunk-42-1.png" width="576" /></p>
<pre class="r"><code>col=c(rev(rgb(seq(1,0,length=1000),1,seq(1,0,length=1000))),
      rgb(1,seq(1,0,length=1000),seq(1,0,length=1000)))
image(as.matrix(cov2cor(strimmer_sample)),
      col=col, main=paste0(&quot;shafer strimmer: &quot;), cex.main=2,
      xaxt = &quot;n&quot;, yaxt = &quot;n&quot;, zlim=c(-1,1))</code></pre>
<p><img src="corshrink_dsc_graph_files/figure-html/unnamed-chunk-43-1.png" width="576" /></p>
<pre class="r"><code>col=c(rev(rgb(seq(1,0,length=1000),1,seq(1,0,length=1000))),
      rgb(1,seq(1,0,length=1000),seq(1,0,length=1000)))
image(as.matrix(cov_sample_ML$ash_cor_only),
      col=col, main=paste0(&quot;corshrink: &quot;), cex.main=2,
      xaxt = &quot;n&quot;, yaxt = &quot;n&quot;, zlim=c(-1,1))</code></pre>
<p><img src="corshrink_dsc_graph_files/figure-html/unnamed-chunk-43-2.png" width="576" /></p>
<pre class="r"><code>col=c(rev(rgb(seq(1,0,length=1000),1,seq(1,0,length=1000))),
      rgb(1,seq(1,0,length=1000),seq(1,0,length=1000)))
image(as.matrix(cov2cor(glasso_sample_005$w)),
      col=col, main=paste0(&quot;glasso 0.05: &quot;), cex.main=2,
      xaxt = &quot;n&quot;, yaxt = &quot;n&quot;, zlim=c(-1,1))</code></pre>
<p><img src="corshrink_dsc_graph_files/figure-html/unnamed-chunk-43-3.png" width="576" /></p>
<pre class="r"><code>col=c(rev(rgb(seq(1,0,length=1000),1,seq(1,0,length=1000))),
      rgb(1,seq(1,0,length=1000),seq(1,0,length=1000)))
image(as.matrix(cov2cor(glasso_sample_05$w)),
      col=col, main=paste0(&quot;glasso 0.5: &quot;), cex.main=2,
      xaxt = &quot;n&quot;, yaxt = &quot;n&quot;, zlim=c(-1,1))</code></pre>
<p><img src="corshrink_dsc_graph_files/figure-html/unnamed-chunk-43-4.png" width="576" /></p>
<pre class="r"><code>col=c(rev(rgb(seq(1,0,length=1000),1,seq(1,0,length=1000))),
      rgb(1,seq(1,0,length=1000),seq(1,0,length=1000)))
image(as.matrix(spcor_mat),
      col=col, main=paste0(&quot;spcov:&quot;, expression(lambda), &quot;=&quot;, lam), cex.main=2,
      xaxt = &quot;n&quot;, yaxt = &quot;n&quot;, zlim=c(-1,1))</code></pre>
<p><img src="corshrink_dsc_graph_files/figure-html/unnamed-chunk-44-1.png" width="576" /></p>
</div>
<div id="n-5-p100-1" class="section level3">
<h3>n = 5, P=100</h3>
<pre class="r"><code>n &lt;- 5
P &lt;- 100
ll &lt;- DM_graph(n,P,g_type = &quot;cluster&quot;, para = 5)</code></pre>
<pre><code>## Generating data from the multivariate normal distribution with the cluster graph structure....</code></pre>
<p><img src="corshrink_dsc_graph_files/figure-html/unnamed-chunk-45-1.png" width="672" /></p>
<pre><code>## done.</code></pre>
<pre class="r"><code>data &lt;- rbind(ll$Xtrain, ll$Xtest)
Sigma &lt;- ll$Sigma
corSigma &lt;- cov2cor(Sigma)</code></pre>
<pre class="r"><code>Pat &lt;- matrix(1, P, P)
diag(Pat) &lt;- 0</code></pre>
<pre class="r"><code>lam &lt;- 0.06
step.size &lt;- 100
tol &lt;- 1e-4
covmat &lt;- cov(data)
mm &lt;- spcov(Sigma=covmat+0.1*diag(1,P), S=covmat+0.1*diag(1,P), lambda=lam * Pat,step.size=step.size, n.inner.steps=200, thr.inner=0, tol.outer=tol, trace=1)</code></pre>
<pre><code>## ---
## using Nesterov, backtracking line search
## ---
## objective:  118.331
## step size given to GGDescent/Nesterov: 100
## objective:  -59.13111  ( 200 iterations, max step size: 0.0064 )
## Reducing step size to 20
## step size given to GGDescent/Nesterov: 20
## objective:  -62.0878  ( 200 iterations, max step size: 0.032 )
## Reducing step size to 4
## step size given to GGDescent/Nesterov: 4
## objective:  -62.10418  ( 200 iterations, max step size: 0.00128 )
## Reducing step size to 0.8
## step size given to GGDescent/Nesterov: 0.8
## objective:  -62.10579  ( 200 iterations, max step size: 0.00128 )
## Reducing step size to 0.16
## step size given to GGDescent/Nesterov: 0.16
## objective:  -62.10619  ( 200 iterations, max step size: 0.00128 )
## Reducing step size to 0.032
## step size given to GGDescent/Nesterov: 0.032
## objective:  -62.10631  ( 200 iterations, max step size: 0.00128 )
## step size given to GGDescent/Nesterov: 0.032
## objective:  -62.10634  ( 200 iterations, max step size: 0.00128 )
## MM converged in 7 steps!</code></pre>
<pre class="r"><code>spcor_mat &lt;- cov2cor(mm$Sigma)</code></pre>
<pre class="r"><code>#devtools::install_github(&quot;kkdey/CorShrink&quot;)
#library(CorShrink)
#sessionInfo()
cov_mat &lt;- cov(data);
system.time(strimmer_sample &lt;- corpcor::cov.shrink(data))</code></pre>
<pre><code>## Estimating optimal shrinkage intensity lambda.var (variance vector): 0.8255 
## 
## Estimating optimal shrinkage intensity lambda (correlation matrix): 0.7443</code></pre>
<pre><code>##    user  system elapsed 
##   0.002   0.000   0.002</code></pre>
<pre class="r"><code>system.time(glasso_sample_005 &lt;- glasso::glasso(cov_mat, rho = 0.05))</code></pre>
<pre><code>##    user  system elapsed 
##   0.570   0.001   0.573</code></pre>
<pre class="r"><code>system.time(glasso_sample_05 &lt;- glasso::glasso(cov_mat, rho = 0.5))</code></pre>
<pre><code>##    user  system elapsed 
##   0.057   0.000   0.058</code></pre>
<pre class="r"><code>system.time(glasso_sample_1 &lt;- glasso::glasso(cov_mat, rho = 1))</code></pre>
<pre><code>##    user  system elapsed 
##   0.011   0.000   0.010</code></pre>
<pre class="r"><code>system.time(glasso_sample_10 &lt;- glasso::glasso(cov_mat, rho = 10))</code></pre>
<pre><code>##    user  system elapsed 
##   0.002   0.000   0.001</code></pre>
<pre class="r"><code>system.time(cov_sample_ML &lt;-  CorShrinkML(cov2cor(cov_mat), nsamp_mat = matrix(n, P, P), sd_boot = FALSE, ash.control = list(mixcompdist = &quot;normal&quot;, nullweight = 10)))</code></pre>
<pre><code>## ash cor only and ash cor PD matrices are different</code></pre>
<pre><code>##    user  system elapsed 
##   1.052   0.054   1.108</code></pre>
<pre class="r"><code>col=c(rev(rgb(seq(1,0,length=1000),1,seq(1,0,length=1000))),
      rgb(1,seq(1,0,length=1000),seq(1,0,length=1000)))
image(as.matrix(cov2cor(cov_mat)),
      col=col, main=paste0(&quot;sample corr: &quot;), cex.main=2,
      xaxt = &quot;n&quot;, yaxt = &quot;n&quot;, zlim=c(-1,1))</code></pre>
<p><img src="corshrink_dsc_graph_files/figure-html/unnamed-chunk-50-1.png" width="576" /></p>
<pre class="r"><code>col=c(rev(rgb(seq(1,0,length=1000),1,seq(1,0,length=1000))),
      rgb(1,seq(1,0,length=1000),seq(1,0,length=1000)))
image(as.matrix(cov2cor(strimmer_sample)),
      col=col, main=paste0(&quot;shafer strimmer: &quot;), cex.main=2,
      xaxt = &quot;n&quot;, yaxt = &quot;n&quot;, zlim=c(-1,1))</code></pre>
<p><img src="corshrink_dsc_graph_files/figure-html/unnamed-chunk-51-1.png" width="576" /></p>
<pre class="r"><code>col=c(rev(rgb(seq(1,0,length=1000),1,seq(1,0,length=1000))),
      rgb(1,seq(1,0,length=1000),seq(1,0,length=1000)))
image(as.matrix(cov_sample_ML$ash_cor_only),
      col=col, main=paste0(&quot;corshrink: &quot;), cex.main=2,
      xaxt = &quot;n&quot;, yaxt = &quot;n&quot;, zlim=c(-1,1))</code></pre>
<p><img src="corshrink_dsc_graph_files/figure-html/unnamed-chunk-51-2.png" width="576" /></p>
<pre class="r"><code>col=c(rev(rgb(seq(1,0,length=1000),1,seq(1,0,length=1000))),
      rgb(1,seq(1,0,length=1000),seq(1,0,length=1000)))
image(as.matrix(cov2cor(glasso_sample_005$w)),
      col=col, main=paste0(&quot;glasso 0.05: &quot;), cex.main=2,
      xaxt = &quot;n&quot;, yaxt = &quot;n&quot;, zlim=c(-1,1))</code></pre>
<p><img src="corshrink_dsc_graph_files/figure-html/unnamed-chunk-51-3.png" width="576" /></p>
<pre class="r"><code>col=c(rev(rgb(seq(1,0,length=1000),1,seq(1,0,length=1000))),
      rgb(1,seq(1,0,length=1000),seq(1,0,length=1000)))
image(as.matrix(cov2cor(glasso_sample_05$w)),
      col=col, main=paste0(&quot;glasso 0.5: &quot;), cex.main=2,
      xaxt = &quot;n&quot;, yaxt = &quot;n&quot;, zlim=c(-1,1))</code></pre>
<p><img src="corshrink_dsc_graph_files/figure-html/unnamed-chunk-51-4.png" width="576" /></p>
<pre class="r"><code>col=c(rev(rgb(seq(1,0,length=1000),1,seq(1,0,length=1000))),
      rgb(1,seq(1,0,length=1000),seq(1,0,length=1000)))
image(as.matrix(spcor_mat),
      col=col, main=paste0(&quot;spcov:&quot;, expression(lambda), &quot;=&quot;, lam), cex.main=2,
      xaxt = &quot;n&quot;, yaxt = &quot;n&quot;, zlim=c(-1,1))</code></pre>
<p><img src="corshrink_dsc_graph_files/figure-html/unnamed-chunk-52-1.png" width="576" /></p>
</div>
</div>
<div id="dm-graph-dense-edors-renyi-graph" class="section level2">
<h2>DM graph (dense Edors Renyi graph)</h2>
<div id="n-10-p100-2" class="section level3">
<h3>n = 10, P=100</h3>
<pre class="r"><code>n &lt;- 10
P &lt;- 100
ll &lt;- DM_graph(n,P, para = 0.5)</code></pre>
<pre><code>## Generating data from the multivariate normal distribution with the random graph structure....</code></pre>
<p><img src="corshrink_dsc_graph_files/figure-html/unnamed-chunk-53-1.png" width="672" /></p>
<pre><code>## done.</code></pre>
<pre class="r"><code>data &lt;- rbind(ll$Xtrain, ll$Xtest)
Sigma &lt;- ll$Sigma
corSigma &lt;- cov2cor(Sigma)</code></pre>
<pre class="r"><code>col=c(rev(rgb(seq(1,0,length=1000),1,seq(1,0,length=1000))),
      rgb(1,seq(1,0,length=1000),seq(1,0,length=1000)))
image(as.matrix(corSigma),
      col=col, main=paste0(&quot;pop corr: &quot;), cex.main=2,
      xaxt = &quot;n&quot;, yaxt = &quot;n&quot;, zlim=c(-1,1))</code></pre>
<p><img src="corshrink_dsc_graph_files/figure-html/unnamed-chunk-54-1.png" width="576" /></p>
<pre class="r"><code>Pat &lt;- matrix(1, P, P)
diag(Pat) &lt;- 0</code></pre>
<pre class="r"><code>lam &lt;- 0.06
step.size &lt;- 100
tol &lt;- 1e-4
covmat &lt;- cov(data)
mm &lt;- spcov(Sigma=covmat+0.1*diag(1,P), S=covmat+0.1*diag(1,P), lambda=lam * Pat,step.size=step.size, n.inner.steps=200, thr.inner=0, tol.outer=tol, trace=1)</code></pre>
<pre><code>## ---
## using Nesterov, backtracking line search
## ---
## objective:  76.70698
## step size given to GGDescent/Nesterov: 100
## objective:  -38.09189  ( 200 iterations, max step size: 0.0064 )
## Reducing step size to 20
## step size given to GGDescent/Nesterov: 20
## objective:  -39.05851  ( 200 iterations, max step size: 0.0064 )
## Reducing step size to 4
## step size given to GGDescent/Nesterov: 4
## objective:  -39.06928  ( 200 iterations, max step size: 0.00128 )
## Reducing step size to 0.8
## step size given to GGDescent/Nesterov: 0.8
## objective:  -39.07084  ( 200 iterations, max step size: 0.00128 )
## Reducing step size to 0.16
## step size given to GGDescent/Nesterov: 0.16
## objective:  -39.07123  ( 200 iterations, max step size: 0.00128 )
## Reducing step size to 0.032
## step size given to GGDescent/Nesterov: 0.032
## objective:  -39.07134  ( 200 iterations, max step size: 0.00128 )
## step size given to GGDescent/Nesterov: 0.032
## objective:  -39.07137  ( 200 iterations, max step size: 0.00128 )
## MM converged in 7 steps!</code></pre>
<pre class="r"><code>spcor_mat &lt;- cov2cor(mm$Sigma)</code></pre>
<pre class="r"><code>#devtools::install_github(&quot;kkdey/CorShrink&quot;)
#library(CorShrink)
#sessionInfo()
cov_mat &lt;- cov(data);
system.time(strimmer_sample &lt;- corpcor::cov.shrink(data))</code></pre>
<pre><code>## Estimating optimal shrinkage intensity lambda.var (variance vector): 0.9237 
## 
## Estimating optimal shrinkage intensity lambda (correlation matrix): 0.8124</code></pre>
<pre><code>##    user  system elapsed 
##   0.002   0.000   0.002</code></pre>
<pre class="r"><code>system.time(glasso_sample_005 &lt;- glasso::glasso(cov_mat, rho = 0.05))</code></pre>
<pre><code>##    user  system elapsed 
##   0.377   0.001   0.379</code></pre>
<pre class="r"><code>system.time(glasso_sample_05 &lt;- glasso::glasso(cov_mat, rho = 0.5))</code></pre>
<pre><code>##    user  system elapsed 
##   0.028   0.000   0.028</code></pre>
<pre class="r"><code>system.time(glasso_sample_1 &lt;- glasso::glasso(cov_mat, rho = 1))</code></pre>
<pre><code>##    user  system elapsed 
##   0.003   0.000   0.003</code></pre>
<pre class="r"><code>system.time(glasso_sample_10 &lt;- glasso::glasso(cov_mat, rho = 10))</code></pre>
<pre><code>##    user  system elapsed 
##   0.002   0.000   0.002</code></pre>
<pre class="r"><code>system.time(cov_sample_ML &lt;-  CorShrinkML(cov2cor(cov_mat), nsamp_mat = matrix(n, P, P), sd_boot = FALSE, ash.control = list(mixcompdist = &quot;normal&quot;, nullweight = 10)))</code></pre>
<pre><code>## ash cor only and ash cor PD matrices are different</code></pre>
<pre><code>##    user  system elapsed 
##   1.002   0.049   1.052</code></pre>
<pre class="r"><code>col=c(rev(rgb(seq(1,0,length=1000),1,seq(1,0,length=1000))),
      rgb(1,seq(1,0,length=1000),seq(1,0,length=1000)))
image(as.matrix(cov2cor(cov_mat)),
      col=col, main=paste0(&quot;sample corr: &quot;), cex.main=2,
      xaxt = &quot;n&quot;, yaxt = &quot;n&quot;, zlim=c(-1,1))</code></pre>
<p><img src="corshrink_dsc_graph_files/figure-html/unnamed-chunk-59-1.png" width="576" /></p>
<pre class="r"><code>col=c(rev(rgb(seq(1,0,length=1000),1,seq(1,0,length=1000))),
      rgb(1,seq(1,0,length=1000),seq(1,0,length=1000)))
image(as.matrix(cov2cor(strimmer_sample)),
      col=col, main=paste0(&quot;shafer strimmer: &quot;), cex.main=2,
      xaxt = &quot;n&quot;, yaxt = &quot;n&quot;, zlim=c(-1,1))</code></pre>
<p><img src="corshrink_dsc_graph_files/figure-html/unnamed-chunk-60-1.png" width="576" /></p>
<pre class="r"><code>col=c(rev(rgb(seq(1,0,length=1000),1,seq(1,0,length=1000))),
      rgb(1,seq(1,0,length=1000),seq(1,0,length=1000)))
image(as.matrix(cov_sample_ML$ash_cor_only),
      col=col, main=paste0(&quot;corshrink: &quot;), cex.main=2,
      xaxt = &quot;n&quot;, yaxt = &quot;n&quot;, zlim=c(-1,1))</code></pre>
<p><img src="corshrink_dsc_graph_files/figure-html/unnamed-chunk-60-2.png" width="576" /></p>
<pre class="r"><code>col=c(rev(rgb(seq(1,0,length=1000),1,seq(1,0,length=1000))),
      rgb(1,seq(1,0,length=1000),seq(1,0,length=1000)))
image(as.matrix(cov2cor(glasso_sample_005$w)),
      col=col, main=paste0(&quot;glasso 0.05: &quot;), cex.main=2,
      xaxt = &quot;n&quot;, yaxt = &quot;n&quot;, zlim=c(-1,1))</code></pre>
<p><img src="corshrink_dsc_graph_files/figure-html/unnamed-chunk-60-3.png" width="576" /></p>
<pre class="r"><code>col=c(rev(rgb(seq(1,0,length=1000),1,seq(1,0,length=1000))),
      rgb(1,seq(1,0,length=1000),seq(1,0,length=1000)))
image(as.matrix(cov2cor(glasso_sample_05$w)),
      col=col, main=paste0(&quot;glasso 0.5: &quot;), cex.main=2,
      xaxt = &quot;n&quot;, yaxt = &quot;n&quot;, zlim=c(-1,1))</code></pre>
<p><img src="corshrink_dsc_graph_files/figure-html/unnamed-chunk-60-4.png" width="576" /></p>
<pre class="r"><code>col=c(rev(rgb(seq(1,0,length=1000),1,seq(1,0,length=1000))),
      rgb(1,seq(1,0,length=1000),seq(1,0,length=1000)))
image(as.matrix(spcor_mat),
      col=col, main=paste0(&quot;spcov:&quot;, expression(lambda), &quot;=&quot;, lam), cex.main=2,
      xaxt = &quot;n&quot;, yaxt = &quot;n&quot;, zlim=c(-1,1))</code></pre>
<p><img src="corshrink_dsc_graph_files/figure-html/unnamed-chunk-61-1.png" width="576" /></p>
</div>
<div id="n-50-p100-2" class="section level3">
<h3>n = 50, P=100</h3>
<pre class="r"><code>n &lt;- 50
P &lt;- 100
ll &lt;- DM_graph(n,P, para = 0.5)</code></pre>
<pre><code>## Generating data from the multivariate normal distribution with the random graph structure....</code></pre>
<p><img src="corshrink_dsc_graph_files/figure-html/unnamed-chunk-62-1.png" width="672" /></p>
<pre><code>## done.</code></pre>
<pre class="r"><code>data &lt;- rbind(ll$Xtrain, ll$Xtest)
Sigma &lt;- ll$Sigma
corSigma &lt;- cov2cor(Sigma)</code></pre>
<pre class="r"><code>Pat &lt;- matrix(1, P, P)
diag(Pat) &lt;- 0</code></pre>
<pre class="r"><code>lam &lt;- 0.06
step.size &lt;- 100
tol &lt;- 1e-4
covmat &lt;- cov(data)
mm &lt;- spcov(Sigma=covmat+0.1*diag(1,P), S=covmat+0.1*diag(1,P), lambda=lam * Pat,step.size=step.size, n.inner.steps=200, thr.inner=0, tol.outer=tol, trace=1)</code></pre>
<pre><code>## ---
## using Nesterov, backtracking line search
## ---
## objective:  83.99654
## step size given to GGDescent/Nesterov: 100
## objective:  39.1013  ( 200 iterations, max step size: 0.0064 )
## Reducing step size to 20
## step size given to GGDescent/Nesterov: 20
## objective:  38.27159  ( 200 iterations, max step size: 0.0064 )
## Reducing step size to 4
## step size given to GGDescent/Nesterov: 4
## objective:  38.21559  ( 200 iterations, max step size: 0.0064 )
## Reducing step size to 0.8
## step size given to GGDescent/Nesterov: 0.8
## objective:  38.20821  ( 200 iterations, max step size: 0.0064 )
## Reducing step size to 0.16
## step size given to GGDescent/Nesterov: 0.16
## objective:  38.20664  ( 200 iterations, max step size: 0.0064 )
## Reducing step size to 0.032
## step size given to GGDescent/Nesterov: 0.032
## objective:  38.2062  ( 200 iterations, max step size: 0.0064 )
## step size given to GGDescent/Nesterov: 0.032
## objective:  38.20607  ( 200 iterations, max step size: 0.0064 )
## step size given to GGDescent/Nesterov: 0.032
## objective:  38.20603  ( 200 iterations, max step size: 0.0064 )
## MM converged in 8 steps!</code></pre>
<pre class="r"><code>spcor_mat &lt;- cov2cor(mm$Sigma)</code></pre>
<pre class="r"><code>#devtools::install_github(&quot;kkdey/CorShrink&quot;)
#library(CorShrink)
#sessionInfo()
cov_mat &lt;- cov(data);
system.time(strimmer_sample &lt;- corpcor::cov.shrink(data))</code></pre>
<pre><code>## Estimating optimal shrinkage intensity lambda.var (variance vector): 0.7368 
## 
## Estimating optimal shrinkage intensity lambda (correlation matrix): 0.6473</code></pre>
<pre><code>##    user  system elapsed 
##   0.005   0.000   0.005</code></pre>
<pre class="r"><code>system.time(glasso_sample_005 &lt;- glasso::glasso(cov_mat, rho = 0.05))</code></pre>
<pre><code>##    user  system elapsed 
##   0.170   0.001   0.171</code></pre>
<pre class="r"><code>system.time(glasso_sample_05 &lt;- glasso::glasso(cov_mat, rho = 0.5))</code></pre>
<pre><code>##    user  system elapsed 
##   0.002   0.000   0.002</code></pre>
<pre class="r"><code>system.time(glasso_sample_1 &lt;- glasso::glasso(cov_mat, rho = 1))</code></pre>
<pre><code>##    user  system elapsed 
##   0.001   0.000   0.001</code></pre>
<pre class="r"><code>system.time(glasso_sample_10 &lt;- glasso::glasso(cov_mat, rho = 10))</code></pre>
<pre><code>##    user  system elapsed 
##   0.002   0.000   0.002</code></pre>
<pre class="r"><code>system.time(cov_sample_ML &lt;-  CorShrinkML(cov2cor(cov_mat), nsamp_mat = matrix(n, P, P), sd_boot = FALSE, ash.control = list(mixcompdist = &quot;normal&quot;, nullweight = 10)))</code></pre>
<pre><code>## ash cor only and ash cor PD matrices are different</code></pre>
<pre><code>##    user  system elapsed 
##   1.808   0.098   1.957</code></pre>
<pre class="r"><code>col=c(rev(rgb(seq(1,0,length=1000),1,seq(1,0,length=1000))),
      rgb(1,seq(1,0,length=1000),seq(1,0,length=1000)))
image(as.matrix(cov2cor(cov_mat)),
      col=col, main=paste0(&quot;sample corr: &quot;), cex.main=2,
      xaxt = &quot;n&quot;, yaxt = &quot;n&quot;, zlim=c(-1,1))</code></pre>
<p><img src="corshrink_dsc_graph_files/figure-html/unnamed-chunk-67-1.png" width="576" /></p>
<pre class="r"><code>col=c(rev(rgb(seq(1,0,length=1000),1,seq(1,0,length=1000))),
      rgb(1,seq(1,0,length=1000),seq(1,0,length=1000)))
image(as.matrix(cov2cor(strimmer_sample)),
      col=col, main=paste0(&quot;shafer strimmer: &quot;), cex.main=2,
      xaxt = &quot;n&quot;, yaxt = &quot;n&quot;, zlim=c(-1,1))</code></pre>
<p><img src="corshrink_dsc_graph_files/figure-html/unnamed-chunk-68-1.png" width="576" /></p>
<pre class="r"><code>col=c(rev(rgb(seq(1,0,length=1000),1,seq(1,0,length=1000))),
      rgb(1,seq(1,0,length=1000),seq(1,0,length=1000)))
image(as.matrix(cov_sample_ML$ash_cor_only),
      col=col, main=paste0(&quot;corshrink: &quot;), cex.main=2,
      xaxt = &quot;n&quot;, yaxt = &quot;n&quot;, zlim=c(-1,1))</code></pre>
<p><img src="corshrink_dsc_graph_files/figure-html/unnamed-chunk-68-2.png" width="576" /></p>
<pre class="r"><code>col=c(rev(rgb(seq(1,0,length=1000),1,seq(1,0,length=1000))),
      rgb(1,seq(1,0,length=1000),seq(1,0,length=1000)))
image(as.matrix(cov2cor(glasso_sample_005$w)),
      col=col, main=paste0(&quot;glasso 0.05: &quot;), cex.main=2,
      xaxt = &quot;n&quot;, yaxt = &quot;n&quot;, zlim=c(-1,1))</code></pre>
<p><img src="corshrink_dsc_graph_files/figure-html/unnamed-chunk-68-3.png" width="576" /></p>
<pre class="r"><code>col=c(rev(rgb(seq(1,0,length=1000),1,seq(1,0,length=1000))),
      rgb(1,seq(1,0,length=1000),seq(1,0,length=1000)))
image(as.matrix(cov2cor(glasso_sample_05$w)),
      col=col, main=paste0(&quot;glasso 0.5: &quot;), cex.main=2,
      xaxt = &quot;n&quot;, yaxt = &quot;n&quot;, zlim=c(-1,1))</code></pre>
<p><img src="corshrink_dsc_graph_files/figure-html/unnamed-chunk-68-4.png" width="576" /></p>
<pre class="r"><code>col=c(rev(rgb(seq(1,0,length=1000),1,seq(1,0,length=1000))),
      rgb(1,seq(1,0,length=1000),seq(1,0,length=1000)))
image(as.matrix(spcor_mat),
      col=col, main=paste0(&quot;spcov:&quot;, expression(lambda), &quot;=&quot;, lam), cex.main=2,
      xaxt = &quot;n&quot;, yaxt = &quot;n&quot;, zlim=c(-1,1))</code></pre>
<p><img src="corshrink_dsc_graph_files/figure-html/unnamed-chunk-69-1.png" width="576" /></p>
</div>
<div id="n-5-p100-2" class="section level3">
<h3>n = 5, P=100</h3>
<pre class="r"><code>n &lt;- 5
P &lt;- 100
ll &lt;- DM_graph(n,P, para = 0.5)</code></pre>
<pre><code>## Generating data from the multivariate normal distribution with the random graph structure....</code></pre>
<p><img src="corshrink_dsc_graph_files/figure-html/unnamed-chunk-70-1.png" width="672" /></p>
<pre><code>## done.</code></pre>
<pre class="r"><code>data &lt;- rbind(ll$Xtrain, ll$Xtest)
Sigma &lt;- ll$Sigma
corSigma &lt;- cov2cor(Sigma)</code></pre>
<pre class="r"><code>Pat &lt;- matrix(1, P, P)
diag(Pat) &lt;- 0</code></pre>
<pre class="r"><code>lam &lt;- 0.06
step.size &lt;- 100
tol &lt;- 1e-4
covmat &lt;- cov(data)
mm &lt;- spcov(Sigma=covmat+0.1*diag(1,P), S=covmat+0.1*diag(1,P), lambda=lam * Pat,step.size=step.size, n.inner.steps=200, thr.inner=0, tol.outer=tol, trace=1)</code></pre>
<pre><code>## ---
## using Nesterov, backtracking line search
## ---
## objective:  100.5123
## step size given to GGDescent/Nesterov: 100
## objective:  -55.94037  ( 200 iterations, max step size: 0.0064 )
## Reducing step size to 20
## step size given to GGDescent/Nesterov: 20
## objective:  -66.22464  ( 200 iterations, max step size: 0.0064 )
## Reducing step size to 4
## step size given to GGDescent/Nesterov: 4
## objective:  -66.23679  ( 200 iterations, max step size: 0.00128 )
## Reducing step size to 0.8
## step size given to GGDescent/Nesterov: 0.8
## objective:  -66.23834  ( 200 iterations, max step size: 0.00128 )
## Reducing step size to 0.16
## step size given to GGDescent/Nesterov: 0.16
## objective:  -66.23874  ( 200 iterations, max step size: 0.00128 )
## Reducing step size to 0.032
## step size given to GGDescent/Nesterov: 0.032
## objective:  -66.23885  ( 200 iterations, max step size: 0.00128 )
## step size given to GGDescent/Nesterov: 0.032
## objective:  -66.23888  ( 200 iterations, max step size: 0.00128 )
## MM converged in 7 steps!</code></pre>
<pre class="r"><code>spcor_mat &lt;- cov2cor(mm$Sigma)</code></pre>
<pre class="r"><code>#devtools::install_github(&quot;kkdey/CorShrink&quot;)
#library(CorShrink)
#sessionInfo()
cov_mat &lt;- cov(data);
system.time(strimmer_sample &lt;- corpcor::cov.shrink(data))</code></pre>
<pre><code>## Estimating optimal shrinkage intensity lambda.var (variance vector): 1 
## 
## Estimating optimal shrinkage intensity lambda (correlation matrix): 0.718</code></pre>
<pre><code>##    user  system elapsed 
##   0.002   0.000   0.001</code></pre>
<pre class="r"><code>system.time(glasso_sample_005 &lt;- glasso::glasso(cov_mat, rho = 0.05))</code></pre>
<pre><code>##    user  system elapsed 
##   0.668   0.001   0.670</code></pre>
<pre class="r"><code>system.time(glasso_sample_05 &lt;- glasso::glasso(cov_mat, rho = 0.5))</code></pre>
<pre><code>##    user  system elapsed 
##   0.053   0.000   0.053</code></pre>
<pre class="r"><code>system.time(glasso_sample_1 &lt;- glasso::glasso(cov_mat, rho = 1))</code></pre>
<pre><code>##    user  system elapsed 
##   0.005   0.000   0.006</code></pre>
<pre class="r"><code>system.time(glasso_sample_10 &lt;- glasso::glasso(cov_mat, rho = 10))</code></pre>
<pre><code>##    user  system elapsed 
##   0.002   0.000   0.001</code></pre>
<pre class="r"><code>system.time(cov_sample_ML &lt;-  CorShrinkML(cov2cor(cov_mat), nsamp_mat = matrix(n, P, P), sd_boot = FALSE, ash.control = list(mixcompdist = &quot;normal&quot;, nullweight = 10)))</code></pre>
<pre><code>## ash cor only and ash cor PD matrices are different</code></pre>
<pre><code>##    user  system elapsed 
##   0.937   0.123   1.111</code></pre>
<pre class="r"><code>col=c(rev(rgb(seq(1,0,length=1000),1,seq(1,0,length=1000))),
      rgb(1,seq(1,0,length=1000),seq(1,0,length=1000)))
image(as.matrix(cov2cor(cov_mat)),
      col=col, main=paste0(&quot;sample corr: &quot;), cex.main=2,
      xaxt = &quot;n&quot;, yaxt = &quot;n&quot;, zlim=c(-1,1))</code></pre>
<p><img src="corshrink_dsc_graph_files/figure-html/unnamed-chunk-75-1.png" width="576" /></p>
<pre class="r"><code>col=c(rev(rgb(seq(1,0,length=1000),1,seq(1,0,length=1000))),
      rgb(1,seq(1,0,length=1000),seq(1,0,length=1000)))
image(as.matrix(cov2cor(strimmer_sample)),
      col=col, main=paste0(&quot;shafer strimmer: &quot;), cex.main=2,
      xaxt = &quot;n&quot;, yaxt = &quot;n&quot;, zlim=c(-1,1))</code></pre>
<p><img src="corshrink_dsc_graph_files/figure-html/unnamed-chunk-76-1.png" width="576" /></p>
<pre class="r"><code>col=c(rev(rgb(seq(1,0,length=1000),1,seq(1,0,length=1000))),
      rgb(1,seq(1,0,length=1000),seq(1,0,length=1000)))
image(as.matrix(cov_sample_ML$ash_cor_only),
      col=col, main=paste0(&quot;corshrink: &quot;), cex.main=2,
      xaxt = &quot;n&quot;, yaxt = &quot;n&quot;, zlim=c(-1,1))</code></pre>
<p><img src="corshrink_dsc_graph_files/figure-html/unnamed-chunk-76-2.png" width="576" /></p>
<pre class="r"><code>col=c(rev(rgb(seq(1,0,length=1000),1,seq(1,0,length=1000))),
      rgb(1,seq(1,0,length=1000),seq(1,0,length=1000)))
image(as.matrix(cov2cor(glasso_sample_005$w)),
      col=col, main=paste0(&quot;glasso 0.05: &quot;), cex.main=2,
      xaxt = &quot;n&quot;, yaxt = &quot;n&quot;, zlim=c(-1,1))</code></pre>
<p><img src="corshrink_dsc_graph_files/figure-html/unnamed-chunk-76-3.png" width="576" /></p>
<pre class="r"><code>col=c(rev(rgb(seq(1,0,length=1000),1,seq(1,0,length=1000))),
      rgb(1,seq(1,0,length=1000),seq(1,0,length=1000)))
image(as.matrix(cov2cor(glasso_sample_05$w)),
      col=col, main=paste0(&quot;glasso 0.5: &quot;), cex.main=2,
      xaxt = &quot;n&quot;, yaxt = &quot;n&quot;, zlim=c(-1,1))</code></pre>
<p><img src="corshrink_dsc_graph_files/figure-html/unnamed-chunk-76-4.png" width="576" /></p>
<pre class="r"><code>col=c(rev(rgb(seq(1,0,length=1000),1,seq(1,0,length=1000))),
      rgb(1,seq(1,0,length=1000),seq(1,0,length=1000)))
image(as.matrix(spcor_mat),
      col=col, main=paste0(&quot;spcov:&quot;, expression(lambda), &quot;=&quot;, lam), cex.main=2,
      xaxt = &quot;n&quot;, yaxt = &quot;n&quot;, zlim=c(-1,1))</code></pre>
<p><img src="corshrink_dsc_graph_files/figure-html/unnamed-chunk-77-1.png" width="576" /></p>
</div>
</div>
<div id="dm-graph-sparse-edors-renyi-graph" class="section level2">
<h2>DM graph (sparse Edors Renyi graph)</h2>
<div id="n-10-p100-3" class="section level3">
<h3>n = 10, P=100</h3>
<pre class="r"><code>n &lt;- 10
P &lt;- 100
ll &lt;- DM_graph(n,P)</code></pre>
<pre><code>## Generating data from the multivariate normal distribution with the random graph structure....</code></pre>
<p><img src="corshrink_dsc_graph_files/figure-html/unnamed-chunk-78-1.png" width="672" /></p>
<pre><code>## done.</code></pre>
<pre class="r"><code>data &lt;- rbind(ll$Xtrain, ll$Xtest)
Sigma &lt;- ll$Sigma
corSigma &lt;- cov2cor(Sigma)</code></pre>
<pre class="r"><code>col=c(rev(rgb(seq(1,0,length=1000),1,seq(1,0,length=1000))),
      rgb(1,seq(1,0,length=1000),seq(1,0,length=1000)))
image(as.matrix(corSigma),
      col=col, main=paste0(&quot;pop corr: &quot;), cex.main=2,
      xaxt = &quot;n&quot;, yaxt = &quot;n&quot;, zlim=c(-1,1))</code></pre>
<p><img src="corshrink_dsc_graph_files/figure-html/unnamed-chunk-79-1.png" width="576" /></p>
<pre class="r"><code>Pat &lt;- matrix(1, P, P)
diag(Pat) &lt;- 0</code></pre>
<pre class="r"><code>lam &lt;- 0.06
step.size &lt;- 100
tol &lt;- 1e-4
covmat &lt;- cov(data)
mm &lt;- spcov(Sigma=covmat+0.1*diag(1,P), S=covmat+0.1*diag(1,P), lambda=lam * Pat,step.size=step.size, n.inner.steps=200, thr.inner=0, tol.outer=tol, trace=1)</code></pre>
<pre><code>## ---
## using Nesterov, backtracking line search
## ---
## objective:  77.04022
## step size given to GGDescent/Nesterov: 100
## objective:  -35.95787  ( 200 iterations, max step size: 0.0064 )
## Reducing step size to 20
## step size given to GGDescent/Nesterov: 20
## objective:  -36.99794  ( 200 iterations, max step size: 0.0064 )
## Reducing step size to 4
## step size given to GGDescent/Nesterov: 4
## objective:  -37.00957  ( 200 iterations, max step size: 0.00128 )
## Reducing step size to 0.8
## step size given to GGDescent/Nesterov: 0.8
## objective:  -37.01111  ( 200 iterations, max step size: 0.00128 )
## Reducing step size to 0.16
## step size given to GGDescent/Nesterov: 0.16
## objective:  -37.01149  ( 200 iterations, max step size: 0.00128 )
## Reducing step size to 0.032
## step size given to GGDescent/Nesterov: 0.032
## objective:  -37.0116  ( 200 iterations, max step size: 0.00128 )
## step size given to GGDescent/Nesterov: 0.032
## objective:  -37.01163  ( 200 iterations, max step size: 0.00128 )
## MM converged in 7 steps!</code></pre>
<pre class="r"><code>spcor_mat &lt;- cov2cor(mm$Sigma)</code></pre>
<pre class="r"><code>#devtools::install_github(&quot;kkdey/CorShrink&quot;)
#library(CorShrink)
#sessionInfo()
cov_mat &lt;- cov(data);
system.time(strimmer_sample &lt;- corpcor::cov.shrink(data))</code></pre>
<pre><code>## Estimating optimal shrinkage intensity lambda.var (variance vector): 0.9849 
## 
## Estimating optimal shrinkage intensity lambda (correlation matrix): 0.886</code></pre>
<pre><code>##    user  system elapsed 
##   0.002   0.000   0.002</code></pre>
<pre class="r"><code>system.time(glasso_sample_005 &lt;- glasso::glasso(cov_mat, rho = 0.05))</code></pre>
<pre><code>##    user  system elapsed 
##   0.398   0.000   0.399</code></pre>
<pre class="r"><code>system.time(glasso_sample_05 &lt;- glasso::glasso(cov_mat, rho = 0.5))</code></pre>
<pre><code>##    user  system elapsed 
##   0.032   0.000   0.031</code></pre>
<pre class="r"><code>system.time(glasso_sample_1 &lt;- glasso::glasso(cov_mat, rho = 1))</code></pre>
<pre><code>##    user  system elapsed 
##   0.002   0.000   0.002</code></pre>
<pre class="r"><code>system.time(glasso_sample_10 &lt;- glasso::glasso(cov_mat, rho = 10))</code></pre>
<pre><code>##    user  system elapsed 
##   0.002   0.000   0.002</code></pre>
<pre class="r"><code>system.time(cov_sample_ML &lt;-  CorShrinkML(cov2cor(cov_mat), nsamp_mat = matrix(n, P, P), sd_boot = FALSE, ash.control = list(mixcompdist = &quot;normal&quot;, nullweight = 10)))</code></pre>
<pre><code>## ash cor only and ash cor PD matrices are different</code></pre>
<pre><code>##    user  system elapsed 
##   0.673   0.074   0.749</code></pre>
<pre class="r"><code>col=c(rev(rgb(seq(1,0,length=1000),1,seq(1,0,length=1000))),
      rgb(1,seq(1,0,length=1000),seq(1,0,length=1000)))
image(as.matrix(cov2cor(cov_mat)),
      col=col, main=paste0(&quot;sample corr: &quot;), cex.main=2,
      xaxt = &quot;n&quot;, yaxt = &quot;n&quot;, zlim=c(-1,1))</code></pre>
<p><img src="corshrink_dsc_graph_files/figure-html/unnamed-chunk-84-1.png" width="576" /></p>
<pre class="r"><code>col=c(rev(rgb(seq(1,0,length=1000),1,seq(1,0,length=1000))),
      rgb(1,seq(1,0,length=1000),seq(1,0,length=1000)))
image(as.matrix(cov2cor(strimmer_sample)),
      col=col, main=paste0(&quot;shafer strimmer: &quot;), cex.main=2,
      xaxt = &quot;n&quot;, yaxt = &quot;n&quot;, zlim=c(-1,1))</code></pre>
<p><img src="corshrink_dsc_graph_files/figure-html/unnamed-chunk-85-1.png" width="576" /></p>
<pre class="r"><code>col=c(rev(rgb(seq(1,0,length=1000),1,seq(1,0,length=1000))),
      rgb(1,seq(1,0,length=1000),seq(1,0,length=1000)))
image(as.matrix(cov_sample_ML$ash_cor_only),
      col=col, main=paste0(&quot;corshrink: &quot;), cex.main=2,
      xaxt = &quot;n&quot;, yaxt = &quot;n&quot;, zlim=c(-1,1))</code></pre>
<p><img src="corshrink_dsc_graph_files/figure-html/unnamed-chunk-85-2.png" width="576" /></p>
<pre class="r"><code>col=c(rev(rgb(seq(1,0,length=1000),1,seq(1,0,length=1000))),
      rgb(1,seq(1,0,length=1000),seq(1,0,length=1000)))
image(as.matrix(cov2cor(glasso_sample_005$w)),
      col=col, main=paste0(&quot;glasso 0.05: &quot;), cex.main=2,
      xaxt = &quot;n&quot;, yaxt = &quot;n&quot;, zlim=c(-1,1))</code></pre>
<p><img src="corshrink_dsc_graph_files/figure-html/unnamed-chunk-85-3.png" width="576" /></p>
<pre class="r"><code>col=c(rev(rgb(seq(1,0,length=1000),1,seq(1,0,length=1000))),
      rgb(1,seq(1,0,length=1000),seq(1,0,length=1000)))
image(as.matrix(cov2cor(glasso_sample_05$w)),
      col=col, main=paste0(&quot;glasso 0.5: &quot;), cex.main=2,
      xaxt = &quot;n&quot;, yaxt = &quot;n&quot;, zlim=c(-1,1))</code></pre>
<p><img src="corshrink_dsc_graph_files/figure-html/unnamed-chunk-85-4.png" width="576" /></p>
<pre class="r"><code>col=c(rev(rgb(seq(1,0,length=1000),1,seq(1,0,length=1000))),
      rgb(1,seq(1,0,length=1000),seq(1,0,length=1000)))
image(as.matrix(spcor_mat),
      col=col, main=paste0(&quot;spcov:&quot;, expression(lambda), &quot;=&quot;, lam), cex.main=2,
      xaxt = &quot;n&quot;, yaxt = &quot;n&quot;, zlim=c(-1,1))</code></pre>
<p><img src="corshrink_dsc_graph_files/figure-html/unnamed-chunk-86-1.png" width="576" /></p>
</div>
<div id="n-50-p100-3" class="section level3">
<h3>n = 50, P=100</h3>
<pre class="r"><code>n &lt;- 50
P &lt;- 100
ll &lt;- DM_graph(n,P)</code></pre>
<pre><code>## Generating data from the multivariate normal distribution with the random graph structure....</code></pre>
<p><img src="corshrink_dsc_graph_files/figure-html/unnamed-chunk-87-1.png" width="672" /></p>
<pre><code>## done.</code></pre>
<pre class="r"><code>data &lt;- rbind(ll$Xtrain, ll$Xtest)
Sigma &lt;- ll$Sigma
corSigma &lt;- cov2cor(Sigma)</code></pre>
<pre class="r"><code>Pat &lt;- matrix(1, P, P)
diag(Pat) &lt;- 0</code></pre>
<pre class="r"><code>lam &lt;- 0.06
step.size &lt;- 100
tol &lt;- 1e-4
covmat &lt;- cov(data)
mm &lt;- spcov(Sigma=covmat+0.1*diag(1,P), S=covmat+0.1*diag(1,P), lambda=lam * Pat,step.size=step.size, n.inner.steps=200, thr.inner=0, tol.outer=tol, trace=1)</code></pre>
<pre><code>## ---
## using Nesterov, backtracking line search
## ---
## objective:  77.35571
## step size given to GGDescent/Nesterov: 100
## objective:  43.40194  ( 200 iterations, max step size: 0.0064 )
## Reducing step size to 20
## step size given to GGDescent/Nesterov: 20
## objective:  42.51915  ( 200 iterations, max step size: 0.0064 )
## Reducing step size to 4
## step size given to GGDescent/Nesterov: 4
## objective:  42.4585  ( 200 iterations, max step size: 0.0064 )
## Reducing step size to 0.8
## step size given to GGDescent/Nesterov: 0.8
## objective:  42.45084  ( 200 iterations, max step size: 0.0064 )
## Reducing step size to 0.16
## step size given to GGDescent/Nesterov: 0.16
## objective:  42.4492  ( 200 iterations, max step size: 0.0064 )
## Reducing step size to 0.032
## step size given to GGDescent/Nesterov: 0.032
## objective:  42.44874  ( 200 iterations, max step size: 0.0064 )
## step size given to GGDescent/Nesterov: 0.032
## objective:  42.4486  ( 200 iterations, max step size: 0.0064 )
## step size given to GGDescent/Nesterov: 0.032
## objective:  42.44855  ( 200 iterations, max step size: 0.0064 )
## MM converged in 8 steps!</code></pre>
<pre class="r"><code>spcor_mat &lt;- cov2cor(mm$Sigma)</code></pre>
<pre class="r"><code>#devtools::install_github(&quot;kkdey/CorShrink&quot;)
#library(CorShrink)
#sessionInfo()
cov_mat &lt;- cov(data);
system.time(strimmer_sample &lt;- corpcor::cov.shrink(data))</code></pre>
<pre><code>## Estimating optimal shrinkage intensity lambda.var (variance vector): 0.8991 
## 
## Estimating optimal shrinkage intensity lambda (correlation matrix): 0.8222</code></pre>
<pre><code>##    user  system elapsed 
##   0.005   0.000   0.005</code></pre>
<pre class="r"><code>system.time(glasso_sample_005 &lt;- glasso::glasso(cov_mat, rho = 0.05))</code></pre>
<pre><code>##    user  system elapsed 
##   0.158   0.000   0.160</code></pre>
<pre class="r"><code>system.time(glasso_sample_05 &lt;- glasso::glasso(cov_mat, rho = 0.5))</code></pre>
<pre><code>##    user  system elapsed 
##   0.001   0.000   0.001</code></pre>
<pre class="r"><code>system.time(glasso_sample_1 &lt;- glasso::glasso(cov_mat, rho = 1))</code></pre>
<pre><code>##    user  system elapsed 
##   0.002   0.001   0.002</code></pre>
<pre class="r"><code>system.time(glasso_sample_10 &lt;- glasso::glasso(cov_mat, rho = 10))</code></pre>
<pre><code>##    user  system elapsed 
##   0.002   0.000   0.002</code></pre>
<pre class="r"><code>system.time(cov_sample_ML &lt;-  CorShrinkML(cov2cor(cov_mat), nsamp_mat = matrix(n, P, P), sd_boot = FALSE, ash.control = list(mixcompdist = &quot;normal&quot;, nullweight = 10)))</code></pre>
<pre><code>## ash cor only and ash cor PD matrices are different</code></pre>
<pre><code>##    user  system elapsed 
##   0.788   0.094   0.883</code></pre>
<pre class="r"><code>col=c(rev(rgb(seq(1,0,length=1000),1,seq(1,0,length=1000))),
      rgb(1,seq(1,0,length=1000),seq(1,0,length=1000)))
image(as.matrix(cov2cor(cov_mat)),
      col=col, main=paste0(&quot;sample corr: &quot;), cex.main=2,
      xaxt = &quot;n&quot;, yaxt = &quot;n&quot;, zlim=c(-1,1))</code></pre>
<p><img src="corshrink_dsc_graph_files/figure-html/unnamed-chunk-92-1.png" width="576" /></p>
<pre class="r"><code>col=c(rev(rgb(seq(1,0,length=1000),1,seq(1,0,length=1000))),
      rgb(1,seq(1,0,length=1000),seq(1,0,length=1000)))
image(as.matrix(cov2cor(strimmer_sample)),
      col=col, main=paste0(&quot;shafer strimmer: &quot;), cex.main=2,
      xaxt = &quot;n&quot;, yaxt = &quot;n&quot;, zlim=c(-1,1))</code></pre>
<p><img src="corshrink_dsc_graph_files/figure-html/unnamed-chunk-93-1.png" width="576" /></p>
<pre class="r"><code>col=c(rev(rgb(seq(1,0,length=1000),1,seq(1,0,length=1000))),
      rgb(1,seq(1,0,length=1000),seq(1,0,length=1000)))
image(as.matrix(cov_sample_ML$ash_cor_only),
      col=col, main=paste0(&quot;corshrink: &quot;), cex.main=2,
      xaxt = &quot;n&quot;, yaxt = &quot;n&quot;, zlim=c(-1,1))</code></pre>
<p><img src="corshrink_dsc_graph_files/figure-html/unnamed-chunk-93-2.png" width="576" /></p>
<pre class="r"><code>col=c(rev(rgb(seq(1,0,length=1000),1,seq(1,0,length=1000))),
      rgb(1,seq(1,0,length=1000),seq(1,0,length=1000)))
image(as.matrix(cov2cor(glasso_sample_005$w)),
      col=col, main=paste0(&quot;glasso 0.05: &quot;), cex.main=2,
      xaxt = &quot;n&quot;, yaxt = &quot;n&quot;, zlim=c(-1,1))</code></pre>
<p><img src="corshrink_dsc_graph_files/figure-html/unnamed-chunk-93-3.png" width="576" /></p>
<pre class="r"><code>col=c(rev(rgb(seq(1,0,length=1000),1,seq(1,0,length=1000))),
      rgb(1,seq(1,0,length=1000),seq(1,0,length=1000)))
image(as.matrix(cov2cor(glasso_sample_05$w)),
      col=col, main=paste0(&quot;glasso 0.5: &quot;), cex.main=2,
      xaxt = &quot;n&quot;, yaxt = &quot;n&quot;, zlim=c(-1,1))</code></pre>
<p><img src="corshrink_dsc_graph_files/figure-html/unnamed-chunk-93-4.png" width="576" /></p>
<pre class="r"><code>col=c(rev(rgb(seq(1,0,length=1000),1,seq(1,0,length=1000))),
      rgb(1,seq(1,0,length=1000),seq(1,0,length=1000)))
image(as.matrix(spcor_mat),
      col=col, main=paste0(&quot;spcov:&quot;, expression(lambda), &quot;=&quot;, lam), cex.main=2,
      xaxt = &quot;n&quot;, yaxt = &quot;n&quot;, zlim=c(-1,1))</code></pre>
<p><img src="corshrink_dsc_graph_files/figure-html/unnamed-chunk-94-1.png" width="576" /></p>
</div>
<div id="n-5-p100-3" class="section level3">
<h3>n = 5, P=100</h3>
<pre class="r"><code>n &lt;- 5
P &lt;- 100
ll &lt;- DM_graph(n,P)</code></pre>
<pre><code>## Generating data from the multivariate normal distribution with the random graph structure....</code></pre>
<p><img src="corshrink_dsc_graph_files/figure-html/unnamed-chunk-95-1.png" width="672" /></p>
<pre><code>## done.</code></pre>
<pre class="r"><code>data &lt;- rbind(ll$Xtrain, ll$Xtest)
Sigma &lt;- ll$Sigma
corSigma &lt;- cov2cor(Sigma)</code></pre>
<pre class="r"><code>Pat &lt;- matrix(1, P, P)
diag(Pat) &lt;- 0</code></pre>
<pre class="r"><code>lam &lt;- 0.06
step.size &lt;- 100
tol &lt;- 1e-4
covmat &lt;- cov(data)
mm &lt;- spcov(Sigma=covmat+0.1*diag(1,P), S=covmat+0.1*diag(1,P), lambda=lam * Pat,step.size=step.size, n.inner.steps=200, thr.inner=0, tol.outer=tol, trace=1)</code></pre>
<pre><code>## ---
## using Nesterov, backtracking line search
## ---
## objective:  109.7669
## step size given to GGDescent/Nesterov: 100
## objective:  -48.14035  ( 200 iterations, max step size: 0.0064 )
## Reducing step size to 20
## step size given to GGDescent/Nesterov: 20
## objective:  -62.83723  ( 200 iterations, max step size: 0.0064 )
## Reducing step size to 4
## step size given to GGDescent/Nesterov: 4
## objective:  -62.8798  ( 200 iterations, max step size: 0.00128 )
## Reducing step size to 0.8
## step size given to GGDescent/Nesterov: 0.8
## objective:  -62.88203  ( 200 iterations, max step size: 0.00128 )
## Reducing step size to 0.16
## step size given to GGDescent/Nesterov: 0.16
## objective:  -62.88252  ( 200 iterations, max step size: 0.00128 )
## Reducing step size to 0.032
## step size given to GGDescent/Nesterov: 0.032
## objective:  -62.88265  ( 200 iterations, max step size: 0.00128 )
## step size given to GGDescent/Nesterov: 0.032
## objective:  -62.88269  ( 200 iterations, max step size: 0.00128 )
## MM converged in 7 steps!</code></pre>
<pre class="r"><code>spcor_mat &lt;- cov2cor(mm$Sigma)</code></pre>
<pre class="r"><code>#devtools::install_github(&quot;kkdey/CorShrink&quot;)
#library(CorShrink)
#sessionInfo()
cov_mat &lt;- cov(data);
system.time(strimmer_sample &lt;- corpcor::cov.shrink(data))</code></pre>
<pre><code>## Estimating optimal shrinkage intensity lambda.var (variance vector): 0.8694 
## 
## Estimating optimal shrinkage intensity lambda (correlation matrix): 0.7584</code></pre>
<pre><code>##    user  system elapsed 
##   0.002   0.000   0.002</code></pre>
<pre class="r"><code>system.time(glasso_sample_005 &lt;- glasso::glasso(cov_mat, rho = 0.05))</code></pre>
<pre><code>##    user  system elapsed 
##   0.635   0.001   0.636</code></pre>
<pre class="r"><code>system.time(glasso_sample_05 &lt;- glasso::glasso(cov_mat, rho = 0.5))</code></pre>
<pre><code>##    user  system elapsed 
##   0.058   0.000   0.057</code></pre>
<pre class="r"><code>system.time(glasso_sample_1 &lt;- glasso::glasso(cov_mat, rho = 1))</code></pre>
<pre><code>##    user  system elapsed 
##   0.008   0.000   0.008</code></pre>
<pre class="r"><code>system.time(glasso_sample_10 &lt;- glasso::glasso(cov_mat, rho = 10))</code></pre>
<pre><code>##    user  system elapsed 
##   0.002   0.000   0.001</code></pre>
<pre class="r"><code>system.time(cov_sample_ML &lt;-  CorShrinkML(cov2cor(cov_mat), nsamp_mat = matrix(n, P, P), sd_boot = FALSE, ash.control = list(mixcompdist = &quot;normal&quot;, nullweight = 10)))</code></pre>
<pre><code>## ash cor only and ash cor PD matrices are different</code></pre>
<pre><code>##    user  system elapsed 
##   0.702   0.078   0.781</code></pre>
<pre class="r"><code>col=c(rev(rgb(seq(1,0,length=1000),1,seq(1,0,length=1000))),
      rgb(1,seq(1,0,length=1000),seq(1,0,length=1000)))
image(as.matrix(cov2cor(cov_mat)),
      col=col, main=paste0(&quot;sample corr: &quot;), cex.main=2,
      xaxt = &quot;n&quot;, yaxt = &quot;n&quot;, zlim=c(-1,1))</code></pre>
<p><img src="corshrink_dsc_graph_files/figure-html/unnamed-chunk-100-1.png" width="576" /></p>
<pre class="r"><code>col=c(rev(rgb(seq(1,0,length=1000),1,seq(1,0,length=1000))),
      rgb(1,seq(1,0,length=1000),seq(1,0,length=1000)))
image(as.matrix(cov2cor(strimmer_sample)),
      col=col, main=paste0(&quot;shafer strimmer: &quot;), cex.main=2,
      xaxt = &quot;n&quot;, yaxt = &quot;n&quot;, zlim=c(-1,1))</code></pre>
<p><img src="corshrink_dsc_graph_files/figure-html/unnamed-chunk-101-1.png" width="576" /></p>
<pre class="r"><code>col=c(rev(rgb(seq(1,0,length=1000),1,seq(1,0,length=1000))),
      rgb(1,seq(1,0,length=1000),seq(1,0,length=1000)))
image(as.matrix(cov_sample_ML$ash_cor_only),
      col=col, main=paste0(&quot;corshrink: &quot;), cex.main=2,
      xaxt = &quot;n&quot;, yaxt = &quot;n&quot;, zlim=c(-1,1))</code></pre>
<p><img src="corshrink_dsc_graph_files/figure-html/unnamed-chunk-101-2.png" width="576" /></p>
<pre class="r"><code>col=c(rev(rgb(seq(1,0,length=1000),1,seq(1,0,length=1000))),
      rgb(1,seq(1,0,length=1000),seq(1,0,length=1000)))
image(as.matrix(cov2cor(glasso_sample_005$w)),
      col=col, main=paste0(&quot;glasso 0.05: &quot;), cex.main=2,
      xaxt = &quot;n&quot;, yaxt = &quot;n&quot;, zlim=c(-1,1))</code></pre>
<p><img src="corshrink_dsc_graph_files/figure-html/unnamed-chunk-101-3.png" width="576" /></p>
<pre class="r"><code>col=c(rev(rgb(seq(1,0,length=1000),1,seq(1,0,length=1000))),
      rgb(1,seq(1,0,length=1000),seq(1,0,length=1000)))
image(as.matrix(cov2cor(glasso_sample_05$w)),
      col=col, main=paste0(&quot;glasso 0.5: &quot;), cex.main=2,
      xaxt = &quot;n&quot;, yaxt = &quot;n&quot;, zlim=c(-1,1))</code></pre>
<p><img src="corshrink_dsc_graph_files/figure-html/unnamed-chunk-101-4.png" width="576" /></p>
<pre class="r"><code>col=c(rev(rgb(seq(1,0,length=1000),1,seq(1,0,length=1000))),
      rgb(1,seq(1,0,length=1000),seq(1,0,length=1000)))
image(as.matrix(spcor_mat),
      col=col, main=paste0(&quot;spcov:&quot;, expression(lambda), &quot;=&quot;, lam), cex.main=2,
      xaxt = &quot;n&quot;, yaxt = &quot;n&quot;, zlim=c(-1,1))</code></pre>
<p><img src="corshrink_dsc_graph_files/figure-html/unnamed-chunk-102-1.png" width="576" /></p>
</div>
</div>
<div id="dm-graph-hub-graph" class="section level2">
<h2>DM graph (hub graph)</h2>
<div id="n-10-p100-4" class="section level3">
<h3>n = 10, P=100</h3>
<pre class="r"><code>n &lt;- 10
P &lt;- 100
ll &lt;- DM_graph(n,P,g_type = &quot;hub&quot;, para = 5)</code></pre>
<pre><code>## Generating data from the multivariate normal distribution with the hub graph structure....</code></pre>
<p><img src="corshrink_dsc_graph_files/figure-html/unnamed-chunk-103-1.png" width="672" /></p>
<pre><code>## done.</code></pre>
<pre class="r"><code>data &lt;- rbind(ll$Xtrain, ll$Xtest)
Sigma &lt;- ll$Sigma
corSigma &lt;- cov2cor(Sigma)</code></pre>
<pre class="r"><code>col=c(rev(rgb(seq(1,0,length=1000),1,seq(1,0,length=1000))),
      rgb(1,seq(1,0,length=1000),seq(1,0,length=1000)))
image(as.matrix(corSigma),
      col=col, main=paste0(&quot;pop corr: &quot;), cex.main=2,
      xaxt = &quot;n&quot;, yaxt = &quot;n&quot;, zlim=c(-1,1))</code></pre>
<p><img src="corshrink_dsc_graph_files/figure-html/unnamed-chunk-104-1.png" width="576" /></p>
<pre class="r"><code>Pat &lt;- matrix(1, P, P)
diag(Pat) &lt;- 0</code></pre>
<pre class="r"><code>lam &lt;- 0.06
step.size &lt;- 100
tol &lt;- 1e-4
covmat &lt;- cov(data)
mm &lt;- spcov(Sigma=covmat+0.1*diag(1,P), S=covmat+0.1*diag(1,P), lambda=lam * Pat,step.size=step.size, n.inner.steps=200, thr.inner=0, tol.outer=tol, trace=1)</code></pre>
<pre><code>## ---
## using Nesterov, backtracking line search
## ---
## objective:  64.06577
## step size given to GGDescent/Nesterov: 100
## objective:  -39.8016  ( 200 iterations, max step size: 0.0064 )
## Reducing step size to 20
## step size given to GGDescent/Nesterov: 20
## objective:  -40.41891  ( 200 iterations, max step size: 0.0064 )
## Reducing step size to 4
## step size given to GGDescent/Nesterov: 4
## objective:  -40.42898  ( 200 iterations, max step size: 0.00128 )
## Reducing step size to 0.8
## step size given to GGDescent/Nesterov: 0.8
## objective:  -40.43043  ( 200 iterations, max step size: 0.00128 )
## Reducing step size to 0.16
## step size given to GGDescent/Nesterov: 0.16
## objective:  -40.43079  ( 200 iterations, max step size: 0.00128 )
## Reducing step size to 0.032
## step size given to GGDescent/Nesterov: 0.032
## objective:  -40.43089  ( 200 iterations, max step size: 0.00128 )
## MM converged in 6 steps!</code></pre>
<pre class="r"><code>spcor_mat &lt;- cov2cor(mm$Sigma)</code></pre>
<pre class="r"><code>#devtools::install_github(&quot;kkdey/CorShrink&quot;)
#library(CorShrink)
#sessionInfo()
cov_mat &lt;- cov(data);
system.time(strimmer_sample &lt;- corpcor::cov.shrink(data))</code></pre>
<pre><code>## Estimating optimal shrinkage intensity lambda.var (variance vector): 1 
## 
## Estimating optimal shrinkage intensity lambda (correlation matrix): 0.8569</code></pre>
<pre><code>##    user  system elapsed 
##   0.002   0.000   0.002</code></pre>
<pre class="r"><code>system.time(glasso_sample_005 &lt;- glasso::glasso(cov_mat, rho = 0.05))</code></pre>
<pre><code>##    user  system elapsed 
##   0.360   0.000   0.361</code></pre>
<pre class="r"><code>system.time(glasso_sample_05 &lt;- glasso::glasso(cov_mat, rho = 0.5))</code></pre>
<pre><code>##    user  system elapsed 
##   0.027   0.000   0.027</code></pre>
<pre class="r"><code>system.time(glasso_sample_1 &lt;- glasso::glasso(cov_mat, rho = 1))</code></pre>
<pre><code>##    user  system elapsed 
##   0.002   0.000   0.001</code></pre>
<pre class="r"><code>system.time(glasso_sample_10 &lt;- glasso::glasso(cov_mat, rho = 10))</code></pre>
<pre><code>##    user  system elapsed 
##   0.001   0.000   0.002</code></pre>
<pre class="r"><code>system.time(cov_sample_ML &lt;-  CorShrinkML(cov2cor(cov_mat), nsamp_mat = matrix(n, P, P), sd_boot = FALSE, ash.control = list(mixcompdist = &quot;normal&quot;, nullweight = 10)))</code></pre>
<pre><code>## ash cor only and ash cor PD matrices are different</code></pre>
<pre><code>##    user  system elapsed 
##   0.648   0.065   0.715</code></pre>
<pre class="r"><code>col=c(rev(rgb(seq(1,0,length=1000),1,seq(1,0,length=1000))),
      rgb(1,seq(1,0,length=1000),seq(1,0,length=1000)))
image(as.matrix(cov2cor(cov_mat)),
      col=col, main=paste0(&quot;sample corr: &quot;), cex.main=2,
      xaxt = &quot;n&quot;, yaxt = &quot;n&quot;, zlim=c(-1,1))</code></pre>
<p><img src="corshrink_dsc_graph_files/figure-html/unnamed-chunk-109-1.png" width="576" /></p>
<pre class="r"><code>col=c(rev(rgb(seq(1,0,length=1000),1,seq(1,0,length=1000))),
      rgb(1,seq(1,0,length=1000),seq(1,0,length=1000)))
image(as.matrix(cov2cor(strimmer_sample)),
      col=col, main=paste0(&quot;shafer strimmer: &quot;), cex.main=2,
      xaxt = &quot;n&quot;, yaxt = &quot;n&quot;, zlim=c(-1,1))</code></pre>
<p><img src="corshrink_dsc_graph_files/figure-html/unnamed-chunk-110-1.png" width="576" /></p>
<pre class="r"><code>col=c(rev(rgb(seq(1,0,length=1000),1,seq(1,0,length=1000))),
      rgb(1,seq(1,0,length=1000),seq(1,0,length=1000)))
image(as.matrix(cov_sample_ML$ash_cor_only),
      col=col, main=paste0(&quot;corshrink: &quot;), cex.main=2,
      xaxt = &quot;n&quot;, yaxt = &quot;n&quot;, zlim=c(-1,1))</code></pre>
<p><img src="corshrink_dsc_graph_files/figure-html/unnamed-chunk-110-2.png" width="576" /></p>
<pre class="r"><code>col=c(rev(rgb(seq(1,0,length=1000),1,seq(1,0,length=1000))),
      rgb(1,seq(1,0,length=1000),seq(1,0,length=1000)))
image(as.matrix(cov2cor(glasso_sample_005$w)),
      col=col, main=paste0(&quot;glasso 0.05: &quot;), cex.main=2,
      xaxt = &quot;n&quot;, yaxt = &quot;n&quot;, zlim=c(-1,1))</code></pre>
<p><img src="corshrink_dsc_graph_files/figure-html/unnamed-chunk-110-3.png" width="576" /></p>
<pre class="r"><code>col=c(rev(rgb(seq(1,0,length=1000),1,seq(1,0,length=1000))),
      rgb(1,seq(1,0,length=1000),seq(1,0,length=1000)))
image(as.matrix(cov2cor(glasso_sample_05$w)),
      col=col, main=paste0(&quot;glasso 0.5: &quot;), cex.main=2,
      xaxt = &quot;n&quot;, yaxt = &quot;n&quot;, zlim=c(-1,1))</code></pre>
<p><img src="corshrink_dsc_graph_files/figure-html/unnamed-chunk-110-4.png" width="576" /></p>
<pre class="r"><code>col=c(rev(rgb(seq(1,0,length=1000),1,seq(1,0,length=1000))),
      rgb(1,seq(1,0,length=1000),seq(1,0,length=1000)))
image(as.matrix(spcor_mat),
      col=col, main=paste0(&quot;spcov:&quot;, expression(lambda), &quot;=&quot;, lam), cex.main=2,
      xaxt = &quot;n&quot;, yaxt = &quot;n&quot;, zlim=c(-1,1))</code></pre>
<p><img src="corshrink_dsc_graph_files/figure-html/unnamed-chunk-111-1.png" width="576" /></p>
</div>
<div id="n-50-p100-4" class="section level3">
<h3>n = 50, P=100</h3>
<pre class="r"><code>n &lt;- 50
P &lt;- 100
ll &lt;- DM_graph(n,P,g_type = &quot;hub&quot;, para = 5)</code></pre>
<pre><code>## Generating data from the multivariate normal distribution with the hub graph structure....</code></pre>
<p><img src="corshrink_dsc_graph_files/figure-html/unnamed-chunk-112-1.png" width="672" /></p>
<pre><code>## done.</code></pre>
<pre class="r"><code>data &lt;- rbind(ll$Xtrain, ll$Xtest)
Sigma &lt;- ll$Sigma
corSigma &lt;- cov2cor(Sigma)</code></pre>
<pre class="r"><code>Pat &lt;- matrix(1, P, P)
diag(Pat) &lt;- 0</code></pre>
<pre class="r"><code>lam &lt;- 0.06
step.size &lt;- 100
tol &lt;- 1e-4
covmat &lt;- cov(data)
mm &lt;- spcov(Sigma=covmat+0.1*diag(1,P), S=covmat+0.1*diag(1,P), lambda=lam * Pat,step.size=step.size, n.inner.steps=200, thr.inner=0, tol.outer=tol, trace=1)</code></pre>
<pre><code>## ---
## using Nesterov, backtracking line search
## ---
## objective:  83.22507
## step size given to GGDescent/Nesterov: 100
## objective:  43.33035  ( 200 iterations, max step size: 0.0064 )
## Reducing step size to 20
## step size given to GGDescent/Nesterov: 20
## objective:  42.4401  ( 200 iterations, max step size: 0.0064 )
## Reducing step size to 4
## step size given to GGDescent/Nesterov: 4
## objective:  42.38017  ( 200 iterations, max step size: 0.0064 )
## Reducing step size to 0.8
## step size given to GGDescent/Nesterov: 0.8
## objective:  42.37246  ( 200 iterations, max step size: 0.0064 )
## Reducing step size to 0.16
## step size given to GGDescent/Nesterov: 0.16
## objective:  42.37081  ( 200 iterations, max step size: 0.0064 )
## Reducing step size to 0.032
## step size given to GGDescent/Nesterov: 0.032
## objective:  42.37034  ( 200 iterations, max step size: 0.0064 )
## step size given to GGDescent/Nesterov: 0.032
## objective:  42.3702  ( 200 iterations, max step size: 0.0064 )
## step size given to GGDescent/Nesterov: 0.032
## objective:  42.37015  ( 200 iterations, max step size: 0.0064 )
## MM converged in 8 steps!</code></pre>
<pre class="r"><code>spcor_mat &lt;- cov2cor(mm$Sigma)</code></pre>
<pre class="r"><code>#devtools::install_github(&quot;kkdey/CorShrink&quot;)
#library(CorShrink)
#sessionInfo()
cov_mat &lt;- cov(data);
system.time(strimmer_sample &lt;- corpcor::cov.shrink(data))</code></pre>
<pre><code>## Estimating optimal shrinkage intensity lambda.var (variance vector): 0.9125 
## 
## Estimating optimal shrinkage intensity lambda (correlation matrix): 0.7233</code></pre>
<pre><code>##    user  system elapsed 
##   0.005   0.000   0.005</code></pre>
<pre class="r"><code>system.time(glasso_sample_005 &lt;- glasso::glasso(cov_mat, rho = 0.05))</code></pre>
<pre><code>##    user  system elapsed 
##   0.160   0.000   0.161</code></pre>
<pre class="r"><code>system.time(glasso_sample_05 &lt;- glasso::glasso(cov_mat, rho = 0.5))</code></pre>
<pre><code>##    user  system elapsed 
##   0.001   0.000   0.002</code></pre>
<pre class="r"><code>system.time(glasso_sample_1 &lt;- glasso::glasso(cov_mat, rho = 1))</code></pre>
<pre><code>##    user  system elapsed 
##   0.001   0.000   0.001</code></pre>
<pre class="r"><code>system.time(glasso_sample_10 &lt;- glasso::glasso(cov_mat, rho = 10))</code></pre>
<pre><code>##    user  system elapsed 
##   0.002   0.000   0.001</code></pre>
<pre class="r"><code>system.time(cov_sample_ML &lt;-  CorShrinkML(cov2cor(cov_mat), nsamp_mat = matrix(n, P, P), sd_boot = FALSE, ash.control = list(mixcompdist = &quot;normal&quot;, nullweight = 10)))</code></pre>
<pre><code>## ash cor only and ash cor PD matrices are different</code></pre>
<pre><code>##    user  system elapsed 
##   0.722   0.092   0.823</code></pre>
<pre class="r"><code>col=c(rev(rgb(seq(1,0,length=1000),1,seq(1,0,length=1000))),
      rgb(1,seq(1,0,length=1000),seq(1,0,length=1000)))
image(as.matrix(cov2cor(cov_mat)),
      col=col, main=paste0(&quot;sample corr: &quot;), cex.main=2,
      xaxt = &quot;n&quot;, yaxt = &quot;n&quot;, zlim=c(-1,1))</code></pre>
<p><img src="corshrink_dsc_graph_files/figure-html/unnamed-chunk-117-1.png" width="576" /></p>
<pre class="r"><code>col=c(rev(rgb(seq(1,0,length=1000),1,seq(1,0,length=1000))),
      rgb(1,seq(1,0,length=1000),seq(1,0,length=1000)))
image(as.matrix(cov2cor(strimmer_sample)),
      col=col, main=paste0(&quot;shafer strimmer: &quot;), cex.main=2,
      xaxt = &quot;n&quot;, yaxt = &quot;n&quot;, zlim=c(-1,1))</code></pre>
<p><img src="corshrink_dsc_graph_files/figure-html/unnamed-chunk-118-1.png" width="576" /></p>
<pre class="r"><code>col=c(rev(rgb(seq(1,0,length=1000),1,seq(1,0,length=1000))),
      rgb(1,seq(1,0,length=1000),seq(1,0,length=1000)))
image(as.matrix(cov_sample_ML$ash_cor_only),
      col=col, main=paste0(&quot;corshrink: &quot;), cex.main=2,
      xaxt = &quot;n&quot;, yaxt = &quot;n&quot;, zlim=c(-1,1))</code></pre>
<p><img src="corshrink_dsc_graph_files/figure-html/unnamed-chunk-118-2.png" width="576" /></p>
<pre class="r"><code>col=c(rev(rgb(seq(1,0,length=1000),1,seq(1,0,length=1000))),
      rgb(1,seq(1,0,length=1000),seq(1,0,length=1000)))
image(as.matrix(cov2cor(glasso_sample_005$w)),
      col=col, main=paste0(&quot;glasso 0.05: &quot;), cex.main=2,
      xaxt = &quot;n&quot;, yaxt = &quot;n&quot;, zlim=c(-1,1))</code></pre>
<p><img src="corshrink_dsc_graph_files/figure-html/unnamed-chunk-118-3.png" width="576" /></p>
<pre class="r"><code>col=c(rev(rgb(seq(1,0,length=1000),1,seq(1,0,length=1000))),
      rgb(1,seq(1,0,length=1000),seq(1,0,length=1000)))
image(as.matrix(cov2cor(glasso_sample_05$w)),
      col=col, main=paste0(&quot;glasso 0.5: &quot;), cex.main=2,
      xaxt = &quot;n&quot;, yaxt = &quot;n&quot;, zlim=c(-1,1))</code></pre>
<p><img src="corshrink_dsc_graph_files/figure-html/unnamed-chunk-118-4.png" width="576" /></p>
<pre class="r"><code>col=c(rev(rgb(seq(1,0,length=1000),1,seq(1,0,length=1000))),
      rgb(1,seq(1,0,length=1000),seq(1,0,length=1000)))
image(as.matrix(spcor_mat),
      col=col, main=paste0(&quot;spcov:&quot;, expression(lambda), &quot;=&quot;, lam), cex.main=2,
      xaxt = &quot;n&quot;, yaxt = &quot;n&quot;, zlim=c(-1,1))</code></pre>
<p><img src="corshrink_dsc_graph_files/figure-html/unnamed-chunk-119-1.png" width="576" /></p>
</div>
<div id="n-5-p100-4" class="section level3">
<h3>n = 5, P=100</h3>
<pre class="r"><code>n &lt;- 5
P &lt;- 100
ll &lt;- DM_graph(n,P,g_type = &quot;hub&quot;, para = 5)</code></pre>
<pre><code>## Generating data from the multivariate normal distribution with the hub graph structure....</code></pre>
<p><img src="corshrink_dsc_graph_files/figure-html/unnamed-chunk-120-1.png" width="672" /></p>
<pre><code>## done.</code></pre>
<pre class="r"><code>data &lt;- rbind(ll$Xtrain, ll$Xtest)
Sigma &lt;- ll$Sigma
corSigma &lt;- cov2cor(Sigma)</code></pre>
<pre class="r"><code>Pat &lt;- matrix(1, P, P)
diag(Pat) &lt;- 0</code></pre>
<pre class="r"><code>lam &lt;- 0.06
step.size &lt;- 100
tol &lt;- 1e-4
covmat &lt;- cov(data)
mm &lt;- spcov(Sigma=covmat+0.1*diag(1,P), S=covmat+0.1*diag(1,P), lambda=lam * Pat,step.size=step.size, n.inner.steps=200, thr.inner=0, tol.outer=tol, trace=1)</code></pre>
<pre><code>## ---
## using Nesterov, backtracking line search
## ---
## objective:  167.8495
## step size given to GGDescent/Nesterov: 100
## objective:  -32.89818  ( 200 iterations, max step size: 0.0064 )
## Reducing step size to 20
## step size given to GGDescent/Nesterov: 20
## objective:  -55.3639  ( 200 iterations, max step size: 0.0064 )
## Reducing step size to 4
## step size given to GGDescent/Nesterov: 4
## objective:  -55.50689  ( 200 iterations, max step size: 0.0064 )
## Reducing step size to 0.8
## step size given to GGDescent/Nesterov: 0.8
## objective:  -55.5093  ( 200 iterations, max step size: 0.00128 )
## Reducing step size to 0.16
## step size given to GGDescent/Nesterov: 0.16
## objective:  -55.50977  ( 200 iterations, max step size: 0.00128 )
## Reducing step size to 0.032
## step size given to GGDescent/Nesterov: 0.032
## objective:  -55.5099  ( 200 iterations, max step size: 0.00128 )
## step size given to GGDescent/Nesterov: 0.032
## objective:  -55.50993  ( 200 iterations, max step size: 0.00128 )
## MM converged in 7 steps!</code></pre>
<pre class="r"><code>spcor_mat &lt;- cov2cor(mm$Sigma)</code></pre>
<pre class="r"><code>#devtools::install_github(&quot;kkdey/CorShrink&quot;)
#library(CorShrink)
#sessionInfo()
cov_mat &lt;- cov(data);
system.time(strimmer_sample &lt;- corpcor::cov.shrink(data))</code></pre>
<pre><code>## Estimating optimal shrinkage intensity lambda.var (variance vector): 0.775 
## 
## Estimating optimal shrinkage intensity lambda (correlation matrix): 0.7394</code></pre>
<pre><code>##    user  system elapsed 
##   0.002   0.000   0.002</code></pre>
<pre class="r"><code>system.time(glasso_sample_005 &lt;- glasso::glasso(cov_mat, rho = 0.05))</code></pre>
<pre><code>##    user  system elapsed 
##   0.732   0.000   0.732</code></pre>
<pre class="r"><code>system.time(glasso_sample_05 &lt;- glasso::glasso(cov_mat, rho = 0.5))</code></pre>
<pre><code>##    user  system elapsed 
##   0.073   0.001   0.073</code></pre>
<pre class="r"><code>system.time(glasso_sample_1 &lt;- glasso::glasso(cov_mat, rho = 1))</code></pre>
<pre><code>##    user  system elapsed 
##   0.019   0.000   0.018</code></pre>
<pre class="r"><code>system.time(glasso_sample_10 &lt;- glasso::glasso(cov_mat, rho = 10))</code></pre>
<pre><code>##    user  system elapsed 
##   0.001   0.000   0.002</code></pre>
<pre class="r"><code>system.time(cov_sample_ML &lt;-  CorShrinkML(cov2cor(cov_mat), nsamp_mat = matrix(n, P, P), sd_boot = FALSE, ash.control = list(mixcompdist = &quot;normal&quot;, nullweight = 10)))</code></pre>
<pre><code>## ash cor only and ash cor PD matrices are different</code></pre>
<pre><code>##    user  system elapsed 
##   0.729   0.077   0.806</code></pre>
<pre class="r"><code>col=c(rev(rgb(seq(1,0,length=1000),1,seq(1,0,length=1000))),
      rgb(1,seq(1,0,length=1000),seq(1,0,length=1000)))
image(as.matrix(cov2cor(cov_mat)),
      col=col, main=paste0(&quot;sample corr: &quot;), cex.main=2,
      xaxt = &quot;n&quot;, yaxt = &quot;n&quot;, zlim=c(-1,1))</code></pre>
<p><img src="corshrink_dsc_graph_files/figure-html/unnamed-chunk-125-1.png" width="576" /></p>
<pre class="r"><code>col=c(rev(rgb(seq(1,0,length=1000),1,seq(1,0,length=1000))),
      rgb(1,seq(1,0,length=1000),seq(1,0,length=1000)))
image(as.matrix(cov2cor(strimmer_sample)),
      col=col, main=paste0(&quot;shafer strimmer: &quot;), cex.main=2,
      xaxt = &quot;n&quot;, yaxt = &quot;n&quot;, zlim=c(-1,1))</code></pre>
<p><img src="corshrink_dsc_graph_files/figure-html/unnamed-chunk-126-1.png" width="576" /></p>
<pre class="r"><code>col=c(rev(rgb(seq(1,0,length=1000),1,seq(1,0,length=1000))),
      rgb(1,seq(1,0,length=1000),seq(1,0,length=1000)))
image(as.matrix(cov_sample_ML$ash_cor_only),
      col=col, main=paste0(&quot;corshrink: &quot;), cex.main=2,
      xaxt = &quot;n&quot;, yaxt = &quot;n&quot;, zlim=c(-1,1))</code></pre>
<p><img src="corshrink_dsc_graph_files/figure-html/unnamed-chunk-126-2.png" width="576" /></p>
<pre class="r"><code>col=c(rev(rgb(seq(1,0,length=1000),1,seq(1,0,length=1000))),
      rgb(1,seq(1,0,length=1000),seq(1,0,length=1000)))
image(as.matrix(cov2cor(glasso_sample_005$w)),
      col=col, main=paste0(&quot;glasso 0.05: &quot;), cex.main=2,
      xaxt = &quot;n&quot;, yaxt = &quot;n&quot;, zlim=c(-1,1))</code></pre>
<p><img src="corshrink_dsc_graph_files/figure-html/unnamed-chunk-126-3.png" width="576" /></p>
<pre class="r"><code>col=c(rev(rgb(seq(1,0,length=1000),1,seq(1,0,length=1000))),
      rgb(1,seq(1,0,length=1000),seq(1,0,length=1000)))
image(as.matrix(cov2cor(glasso_sample_05$w)),
      col=col, main=paste0(&quot;glasso 0.5: &quot;), cex.main=2,
      xaxt = &quot;n&quot;, yaxt = &quot;n&quot;, zlim=c(-1,1))</code></pre>
<p><img src="corshrink_dsc_graph_files/figure-html/unnamed-chunk-126-4.png" width="576" /></p>
<pre class="r"><code>col=c(rev(rgb(seq(1,0,length=1000),1,seq(1,0,length=1000))),
      rgb(1,seq(1,0,length=1000),seq(1,0,length=1000)))
image(as.matrix(spcor_mat),
      col=col, main=paste0(&quot;spcov:&quot;, expression(lambda), &quot;=&quot;, lam), cex.main=2,
      xaxt = &quot;n&quot;, yaxt = &quot;n&quot;, zlim=c(-1,1))</code></pre>
<p><img src="corshrink_dsc_graph_files/figure-html/unnamed-chunk-127-1.png" width="576" /></p>
</div>
</div>
<div id="dm-graph-scale-free-graph" class="section level2">
<h2>DM graph (scale free graph)</h2>
<div id="n-10-p100-5" class="section level3">
<h3>n = 10, P=100</h3>
<pre class="r"><code>n &lt;- 10
P &lt;- 100
ll &lt;- DM_graph(n,P,g_type = &quot;scale-free&quot;)</code></pre>
<pre><code>## Generating data from the multivariate normal distribution with the scale-free graph structure....</code></pre>
<p><img src="corshrink_dsc_graph_files/figure-html/unnamed-chunk-128-1.png" width="672" /></p>
<pre><code>## done.</code></pre>
<pre class="r"><code>data &lt;- rbind(ll$Xtrain, ll$Xtest)
Sigma &lt;- ll$Sigma
corSigma &lt;- cov2cor(Sigma)</code></pre>
<pre class="r"><code>col=c(rev(rgb(seq(1,0,length=1000),1,seq(1,0,length=1000))),
      rgb(1,seq(1,0,length=1000),seq(1,0,length=1000)))
image(as.matrix(corSigma),
      col=col, main=paste0(&quot;pop corr: &quot;), cex.main=2,
      xaxt = &quot;n&quot;, yaxt = &quot;n&quot;, zlim=c(-1,1))</code></pre>
<p><img src="corshrink_dsc_graph_files/figure-html/unnamed-chunk-129-1.png" width="576" /></p>
<pre class="r"><code>Pat &lt;- matrix(1, P, P)
diag(Pat) &lt;- 0</code></pre>
<pre class="r"><code>lam &lt;- 0.06
step.size &lt;- 100
tol &lt;- 1e-4
covmat &lt;- cov(data)
mm &lt;- spcov(Sigma=covmat+0.1*diag(1,P), S=covmat+0.1*diag(1,P), lambda=lam * Pat,step.size=step.size, n.inner.steps=200, thr.inner=0, tol.outer=tol, trace=1)</code></pre>
<pre><code>## ---
## using Nesterov, backtracking line search
## ---
## objective:  56.28347
## step size given to GGDescent/Nesterov: 100
## objective:  -41.32945  ( 200 iterations, max step size: 0.0064 )
## Reducing step size to 20
## step size given to GGDescent/Nesterov: 20
## objective:  -41.76731  ( 200 iterations, max step size: 0.0064 )
## Reducing step size to 4
## step size given to GGDescent/Nesterov: 4
## objective:  -41.77652  ( 200 iterations, max step size: 0.00128 )
## Reducing step size to 0.8
## step size given to GGDescent/Nesterov: 0.8
## objective:  -41.77799  ( 200 iterations, max step size: 0.00128 )
## Reducing step size to 0.16
## step size given to GGDescent/Nesterov: 0.16
## objective:  -41.77836  ( 200 iterations, max step size: 0.00128 )
## Reducing step size to 0.032
## step size given to GGDescent/Nesterov: 0.032
## objective:  -41.77846  ( 200 iterations, max step size: 0.00128 )
## step size given to GGDescent/Nesterov: 0.032
## objective:  -41.77849  ( 200 iterations, max step size: 0.00128 )
## MM converged in 7 steps!</code></pre>
<pre class="r"><code>spcor_mat &lt;- cov2cor(mm$Sigma)</code></pre>
<pre class="r"><code>#devtools::install_github(&quot;kkdey/CorShrink&quot;)
#library(CorShrink)
#sessionInfo()
cov_mat &lt;- cov(data);
system.time(strimmer_sample &lt;- corpcor::cov.shrink(data))</code></pre>
<pre><code>## Estimating optimal shrinkage intensity lambda.var (variance vector): 0.82 
## 
## Estimating optimal shrinkage intensity lambda (correlation matrix): 0.8805</code></pre>
<pre><code>##    user  system elapsed 
##   0.002   0.000   0.002</code></pre>
<pre class="r"><code>system.time(glasso_sample_005 &lt;- glasso::glasso(cov_mat, rho = 0.05))</code></pre>
<pre><code>##    user  system elapsed 
##   0.350   0.000   0.351</code></pre>
<pre class="r"><code>system.time(glasso_sample_05 &lt;- glasso::glasso(cov_mat, rho = 0.5))</code></pre>
<pre><code>##    user  system elapsed 
##   0.028   0.000   0.028</code></pre>
<pre class="r"><code>system.time(glasso_sample_1 &lt;- glasso::glasso(cov_mat, rho = 1))</code></pre>
<pre><code>##    user  system elapsed 
##   0.001   0.000   0.001</code></pre>
<pre class="r"><code>system.time(glasso_sample_10 &lt;- glasso::glasso(cov_mat, rho = 10))</code></pre>
<pre><code>##    user  system elapsed 
##   0.001   0.000   0.001</code></pre>
<pre class="r"><code>system.time(cov_sample_ML &lt;-  CorShrinkML(cov2cor(cov_mat), nsamp_mat = matrix(n, P, P), sd_boot = FALSE, ash.control = list(mixcompdist = &quot;normal&quot;, nullweight = 10)))</code></pre>
<pre><code>## ash cor only and ash cor PD matrices are different</code></pre>
<pre><code>##    user  system elapsed 
##   0.665   0.067   0.734</code></pre>
<pre class="r"><code>col=c(rev(rgb(seq(1,0,length=1000),1,seq(1,0,length=1000))),
      rgb(1,seq(1,0,length=1000),seq(1,0,length=1000)))
image(as.matrix(cov2cor(cov_mat)),
      col=col, main=paste0(&quot;sample corr: &quot;), cex.main=2,
      xaxt = &quot;n&quot;, yaxt = &quot;n&quot;, zlim=c(-1,1))</code></pre>
<p><img src="corshrink_dsc_graph_files/figure-html/unnamed-chunk-134-1.png" width="576" /></p>
<pre class="r"><code>col=c(rev(rgb(seq(1,0,length=1000),1,seq(1,0,length=1000))),
      rgb(1,seq(1,0,length=1000),seq(1,0,length=1000)))
image(as.matrix(cov2cor(strimmer_sample)),
      col=col, main=paste0(&quot;shafer strimmer: &quot;), cex.main=2,
      xaxt = &quot;n&quot;, yaxt = &quot;n&quot;, zlim=c(-1,1))</code></pre>
<p><img src="corshrink_dsc_graph_files/figure-html/unnamed-chunk-135-1.png" width="576" /></p>
<pre class="r"><code>col=c(rev(rgb(seq(1,0,length=1000),1,seq(1,0,length=1000))),
      rgb(1,seq(1,0,length=1000),seq(1,0,length=1000)))
image(as.matrix(cov_sample_ML$ash_cor_only),
      col=col, main=paste0(&quot;corshrink: &quot;), cex.main=2,
      xaxt = &quot;n&quot;, yaxt = &quot;n&quot;, zlim=c(-1,1))</code></pre>
<p><img src="corshrink_dsc_graph_files/figure-html/unnamed-chunk-135-2.png" width="576" /></p>
<pre class="r"><code>col=c(rev(rgb(seq(1,0,length=1000),1,seq(1,0,length=1000))),
      rgb(1,seq(1,0,length=1000),seq(1,0,length=1000)))
image(as.matrix(cov2cor(glasso_sample_005$w)),
      col=col, main=paste0(&quot;glasso 0.05: &quot;), cex.main=2,
      xaxt = &quot;n&quot;, yaxt = &quot;n&quot;, zlim=c(-1,1))</code></pre>
<p><img src="corshrink_dsc_graph_files/figure-html/unnamed-chunk-135-3.png" width="576" /></p>
<pre class="r"><code>col=c(rev(rgb(seq(1,0,length=1000),1,seq(1,0,length=1000))),
      rgb(1,seq(1,0,length=1000),seq(1,0,length=1000)))
image(as.matrix(cov2cor(glasso_sample_05$w)),
      col=col, main=paste0(&quot;glasso 0.5: &quot;), cex.main=2,
      xaxt = &quot;n&quot;, yaxt = &quot;n&quot;, zlim=c(-1,1))</code></pre>
<p><img src="corshrink_dsc_graph_files/figure-html/unnamed-chunk-135-4.png" width="576" /></p>
<pre class="r"><code>col=c(rev(rgb(seq(1,0,length=1000),1,seq(1,0,length=1000))),
      rgb(1,seq(1,0,length=1000),seq(1,0,length=1000)))
image(as.matrix(spcor_mat),
      col=col, main=paste0(&quot;spcov:&quot;, expression(lambda), &quot;=&quot;, lam), cex.main=2,
      xaxt = &quot;n&quot;, yaxt = &quot;n&quot;, zlim=c(-1,1))</code></pre>
<p><img src="corshrink_dsc_graph_files/figure-html/unnamed-chunk-136-1.png" width="576" /></p>
</div>
<div id="n-50-p100-5" class="section level3">
<h3>n = 50, P=100</h3>
<pre class="r"><code>n &lt;- 50
P &lt;- 100
ll &lt;- DM_graph(n,P,g_type = &quot;scale-free&quot;)</code></pre>
<pre><code>## Generating data from the multivariate normal distribution with the scale-free graph structure....</code></pre>
<p><img src="corshrink_dsc_graph_files/figure-html/unnamed-chunk-137-1.png" width="672" /></p>
<pre><code>## done.</code></pre>
<pre class="r"><code>data &lt;- rbind(ll$Xtrain, ll$Xtest)
Sigma &lt;- ll$Sigma
corSigma &lt;- cov2cor(Sigma)</code></pre>
<pre class="r"><code>Pat &lt;- matrix(1, P, P)
diag(Pat) &lt;- 0</code></pre>
<pre class="r"><code>lam &lt;- 0.06
step.size &lt;- 100
tol &lt;- 1e-4
covmat &lt;- cov(data)
mm &lt;- spcov(Sigma=covmat+0.1*diag(1,P), S=covmat+0.1*diag(1,P), lambda=lam * Pat,step.size=step.size, n.inner.steps=200, thr.inner=0, tol.outer=tol, trace=1)</code></pre>
<pre><code>## ---
## using Nesterov, backtracking line search
## ---
## objective:  79.11804
## step size given to GGDescent/Nesterov: 100
## objective:  44.57655  ( 200 iterations, max step size: 0.0064 )
## Reducing step size to 20
## step size given to GGDescent/Nesterov: 20
## objective:  43.69096  ( 200 iterations, max step size: 0.0064 )
## Reducing step size to 4
## step size given to GGDescent/Nesterov: 4
## objective:  43.62965  ( 200 iterations, max step size: 0.0064 )
## Reducing step size to 0.8
## step size given to GGDescent/Nesterov: 0.8
## objective:  43.62216  ( 200 iterations, max step size: 0.0064 )
## Reducing step size to 0.16
## step size given to GGDescent/Nesterov: 0.16
## objective:  43.62065  ( 200 iterations, max step size: 0.0064 )
## Reducing step size to 0.032
## step size given to GGDescent/Nesterov: 0.032
## objective:  43.62024  ( 200 iterations, max step size: 0.0064 )
## step size given to GGDescent/Nesterov: 0.032
## objective:  43.62012  ( 200 iterations, max step size: 0.0064 )
## step size given to GGDescent/Nesterov: 0.032
## objective:  43.62008  ( 200 iterations, max step size: 0.0064 )
## MM converged in 8 steps!</code></pre>
<pre class="r"><code>spcor_mat &lt;- cov2cor(mm$Sigma)</code></pre>
<pre class="r"><code>#devtools::install_github(&quot;kkdey/CorShrink&quot;)
#library(CorShrink)
#sessionInfo()
cov_mat &lt;- cov(data);
system.time(strimmer_sample &lt;- corpcor::cov.shrink(data))</code></pre>
<pre><code>## Estimating optimal shrinkage intensity lambda.var (variance vector): 0.8891 
## 
## Estimating optimal shrinkage intensity lambda (correlation matrix): 0.8408</code></pre>
<pre><code>##    user  system elapsed 
##   0.006   0.000   0.005</code></pre>
<pre class="r"><code>system.time(glasso_sample_005 &lt;- glasso::glasso(cov_mat, rho = 0.05))</code></pre>
<pre><code>##    user  system elapsed 
##   0.169   0.000   0.169</code></pre>
<pre class="r"><code>system.time(glasso_sample_05 &lt;- glasso::glasso(cov_mat, rho = 0.5))</code></pre>
<pre><code>##    user  system elapsed 
##   0.002   0.000   0.002</code></pre>
<pre class="r"><code>system.time(glasso_sample_1 &lt;- glasso::glasso(cov_mat, rho = 1))</code></pre>
<pre><code>##    user  system elapsed 
##   0.002   0.000   0.002</code></pre>
<pre class="r"><code>system.time(glasso_sample_10 &lt;- glasso::glasso(cov_mat, rho = 10))</code></pre>
<pre><code>##    user  system elapsed 
##   0.002   0.000   0.001</code></pre>
<pre class="r"><code>system.time(cov_sample_ML &lt;-  CorShrinkML(cov2cor(cov_mat), nsamp_mat = matrix(n, P, P), sd_boot = FALSE, ash.control = list(mixcompdist = &quot;normal&quot;, nullweight = 10)))</code></pre>
<pre><code>## ash cor only and ash cor PD matrices are different</code></pre>
<pre><code>##    user  system elapsed 
##   0.692   0.077   0.770</code></pre>
<pre class="r"><code>col=c(rev(rgb(seq(1,0,length=1000),1,seq(1,0,length=1000))),
      rgb(1,seq(1,0,length=1000),seq(1,0,length=1000)))
image(as.matrix(cov2cor(cov_mat)),
      col=col, main=paste0(&quot;sample corr: &quot;), cex.main=2,
      xaxt = &quot;n&quot;, yaxt = &quot;n&quot;, zlim=c(-1,1))</code></pre>
<p><img src="corshrink_dsc_graph_files/figure-html/unnamed-chunk-142-1.png" width="576" /></p>
<pre class="r"><code>col=c(rev(rgb(seq(1,0,length=1000),1,seq(1,0,length=1000))),
      rgb(1,seq(1,0,length=1000),seq(1,0,length=1000)))
image(as.matrix(cov2cor(strimmer_sample)),
      col=col, main=paste0(&quot;shafer strimmer: &quot;), cex.main=2,
      xaxt = &quot;n&quot;, yaxt = &quot;n&quot;, zlim=c(-1,1))</code></pre>
<p><img src="corshrink_dsc_graph_files/figure-html/unnamed-chunk-143-1.png" width="576" /></p>
<pre class="r"><code>col=c(rev(rgb(seq(1,0,length=1000),1,seq(1,0,length=1000))),
      rgb(1,seq(1,0,length=1000),seq(1,0,length=1000)))
image(as.matrix(cov_sample_ML$ash_cor_only),
      col=col, main=paste0(&quot;corshrink: &quot;), cex.main=2,
      xaxt = &quot;n&quot;, yaxt = &quot;n&quot;, zlim=c(-1,1))</code></pre>
<p><img src="corshrink_dsc_graph_files/figure-html/unnamed-chunk-143-2.png" width="576" /></p>
<pre class="r"><code>col=c(rev(rgb(seq(1,0,length=1000),1,seq(1,0,length=1000))),
      rgb(1,seq(1,0,length=1000),seq(1,0,length=1000)))
image(as.matrix(cov2cor(glasso_sample_005$w)),
      col=col, main=paste0(&quot;glasso 0.05: &quot;), cex.main=2,
      xaxt = &quot;n&quot;, yaxt = &quot;n&quot;, zlim=c(-1,1))</code></pre>
<p><img src="corshrink_dsc_graph_files/figure-html/unnamed-chunk-143-3.png" width="576" /></p>
<pre class="r"><code>col=c(rev(rgb(seq(1,0,length=1000),1,seq(1,0,length=1000))),
      rgb(1,seq(1,0,length=1000),seq(1,0,length=1000)))
image(as.matrix(cov2cor(glasso_sample_05$w)),
      col=col, main=paste0(&quot;glasso 0.5: &quot;), cex.main=2,
      xaxt = &quot;n&quot;, yaxt = &quot;n&quot;, zlim=c(-1,1))</code></pre>
<p><img src="corshrink_dsc_graph_files/figure-html/unnamed-chunk-143-4.png" width="576" /></p>
<pre class="r"><code>col=c(rev(rgb(seq(1,0,length=1000),1,seq(1,0,length=1000))),
      rgb(1,seq(1,0,length=1000),seq(1,0,length=1000)))
image(as.matrix(spcor_mat),
      col=col, main=paste0(&quot;spcov:&quot;, expression(lambda), &quot;=&quot;, lam), cex.main=2,
      xaxt = &quot;n&quot;, yaxt = &quot;n&quot;, zlim=c(-1,1))</code></pre>
<p><img src="corshrink_dsc_graph_files/figure-html/unnamed-chunk-144-1.png" width="576" /></p>
</div>
<div id="n-5-p100-5" class="section level3">
<h3>n = 5, P=100</h3>
<pre class="r"><code>n &lt;- 5
P &lt;- 100
ll &lt;- DM_graph(n,P,g_type = &quot;scale-free&quot;)</code></pre>
<pre><code>## Generating data from the multivariate normal distribution with the scale-free graph structure....</code></pre>
<p><img src="corshrink_dsc_graph_files/figure-html/unnamed-chunk-145-1.png" width="672" /></p>
<pre><code>## done.</code></pre>
<pre class="r"><code>data &lt;- rbind(ll$Xtrain, ll$Xtest)
Sigma &lt;- ll$Sigma
corSigma &lt;- cov2cor(Sigma)</code></pre>
<pre class="r"><code>Pat &lt;- matrix(1, P, P)
diag(Pat) &lt;- 0</code></pre>
<pre class="r"><code>lam &lt;- 0.06
step.size &lt;- 100
tol &lt;- 1e-4
covmat &lt;- cov(data)
mm &lt;- spcov(Sigma=covmat+0.1*diag(1,P), S=covmat+0.1*diag(1,P), lambda=lam * Pat,step.size=step.size, n.inner.steps=200, thr.inner=0, tol.outer=tol, trace=1)</code></pre>
<pre><code>## ---
## using Nesterov, backtracking line search
## ---
## objective:  109.2405
## step size given to GGDescent/Nesterov: 100
## objective:  -60.07266  ( 200 iterations, max step size: 0.0064 )
## Reducing step size to 20
## step size given to GGDescent/Nesterov: 20
## objective:  -62.32766  ( 200 iterations, max step size: 0.0064 )
## Reducing step size to 4
## step size given to GGDescent/Nesterov: 4
## objective:  -62.33747  ( 200 iterations, max step size: 0.00128 )
## Reducing step size to 0.8
## step size given to GGDescent/Nesterov: 0.8
## objective:  -62.33919  ( 200 iterations, max step size: 0.00128 )
## Reducing step size to 0.16
## step size given to GGDescent/Nesterov: 0.16
## objective:  -62.33965  ( 200 iterations, max step size: 0.00128 )
## Reducing step size to 0.032
## step size given to GGDescent/Nesterov: 0.032
## objective:  -62.33977  ( 200 iterations, max step size: 0.00128 )
## step size given to GGDescent/Nesterov: 0.032
## objective:  -62.3398  ( 200 iterations, max step size: 0.00128 )
## MM converged in 7 steps!</code></pre>
<pre class="r"><code>spcor_mat &lt;- cov2cor(mm$Sigma)</code></pre>
<pre class="r"><code>#devtools::install_github(&quot;kkdey/CorShrink&quot;)
#library(CorShrink)
#sessionInfo()
cov_mat &lt;- cov(data);
system.time(strimmer_sample &lt;- corpcor::cov.shrink(data))</code></pre>
<pre><code>## Estimating optimal shrinkage intensity lambda.var (variance vector): 0.7644 
## 
## Estimating optimal shrinkage intensity lambda (correlation matrix): 0.7628</code></pre>
<pre><code>##    user  system elapsed 
##   0.002   0.000   0.002</code></pre>
<pre class="r"><code>system.time(glasso_sample_005 &lt;- glasso::glasso(cov_mat, rho = 0.05))</code></pre>
<pre><code>##    user  system elapsed 
##   0.582   0.000   0.582</code></pre>
<pre class="r"><code>system.time(glasso_sample_05 &lt;- glasso::glasso(cov_mat, rho = 0.5))</code></pre>
<pre><code>##    user  system elapsed 
##   0.053   0.000   0.054</code></pre>
<pre class="r"><code>system.time(glasso_sample_1 &lt;- glasso::glasso(cov_mat, rho = 1))</code></pre>
<pre><code>##    user  system elapsed 
##   0.012   0.000   0.012</code></pre>
<pre class="r"><code>system.time(glasso_sample_10 &lt;- glasso::glasso(cov_mat, rho = 10))</code></pre>
<pre><code>##    user  system elapsed 
##   0.001   0.000   0.002</code></pre>
<pre class="r"><code>system.time(cov_sample_ML &lt;-  CorShrinkML(cov2cor(cov_mat), nsamp_mat = matrix(n, P, P), sd_boot = FALSE, ash.control = list(mixcompdist = &quot;normal&quot;, nullweight = 10)))</code></pre>
<pre><code>## ash cor only and ash cor PD matrices are different</code></pre>
<pre><code>##    user  system elapsed 
##   0.694   0.077   0.773</code></pre>
<pre class="r"><code>col=c(rev(rgb(seq(1,0,length=1000),1,seq(1,0,length=1000))),
      rgb(1,seq(1,0,length=1000),seq(1,0,length=1000)))
image(as.matrix(cov2cor(cov_mat)),
      col=col, main=paste0(&quot;sample corr: &quot;), cex.main=2,
      xaxt = &quot;n&quot;, yaxt = &quot;n&quot;, zlim=c(-1,1))</code></pre>
<p><img src="corshrink_dsc_graph_files/figure-html/unnamed-chunk-150-1.png" width="576" /></p>
<pre class="r"><code>col=c(rev(rgb(seq(1,0,length=1000),1,seq(1,0,length=1000))),
      rgb(1,seq(1,0,length=1000),seq(1,0,length=1000)))
image(as.matrix(cov2cor(strimmer_sample)),
      col=col, main=paste0(&quot;shafer strimmer: &quot;), cex.main=2,
      xaxt = &quot;n&quot;, yaxt = &quot;n&quot;, zlim=c(-1,1))</code></pre>
<p><img src="corshrink_dsc_graph_files/figure-html/unnamed-chunk-151-1.png" width="576" /></p>
<pre class="r"><code>col=c(rev(rgb(seq(1,0,length=1000),1,seq(1,0,length=1000))),
      rgb(1,seq(1,0,length=1000),seq(1,0,length=1000)))
image(as.matrix(cov_sample_ML$ash_cor_only),
      col=col, main=paste0(&quot;corshrink: &quot;), cex.main=2,
      xaxt = &quot;n&quot;, yaxt = &quot;n&quot;, zlim=c(-1,1))</code></pre>
<p><img src="corshrink_dsc_graph_files/figure-html/unnamed-chunk-151-2.png" width="576" /></p>
<pre class="r"><code>col=c(rev(rgb(seq(1,0,length=1000),1,seq(1,0,length=1000))),
      rgb(1,seq(1,0,length=1000),seq(1,0,length=1000)))
image(as.matrix(cov2cor(glasso_sample_005$w)),
      col=col, main=paste0(&quot;glasso 0.05: &quot;), cex.main=2,
      xaxt = &quot;n&quot;, yaxt = &quot;n&quot;, zlim=c(-1,1))</code></pre>
<p><img src="corshrink_dsc_graph_files/figure-html/unnamed-chunk-151-3.png" width="576" /></p>
<pre class="r"><code>col=c(rev(rgb(seq(1,0,length=1000),1,seq(1,0,length=1000))),
      rgb(1,seq(1,0,length=1000),seq(1,0,length=1000)))
image(as.matrix(cov2cor(glasso_sample_05$w)),
      col=col, main=paste0(&quot;glasso 0.5: &quot;), cex.main=2,
      xaxt = &quot;n&quot;, yaxt = &quot;n&quot;, zlim=c(-1,1))</code></pre>
<p><img src="corshrink_dsc_graph_files/figure-html/unnamed-chunk-151-4.png" width="576" /></p>
<pre class="r"><code>col=c(rev(rgb(seq(1,0,length=1000),1,seq(1,0,length=1000))),
      rgb(1,seq(1,0,length=1000),seq(1,0,length=1000)))
image(as.matrix(spcor_mat),
      col=col, main=paste0(&quot;spcov:&quot;, expression(lambda), &quot;=&quot;, lam), cex.main=2,
      xaxt = &quot;n&quot;, yaxt = &quot;n&quot;, zlim=c(-1,1))</code></pre>
<p><img src="corshrink_dsc_graph_files/figure-html/unnamed-chunk-152-1.png" width="576" /></p>
</div>
</div>

<hr>
<p>
    This <a href="http://rmarkdown.rstudio.com">R Markdown</a> site was created with <a href="https://github.com/jdblischak/workflowr">workflowr</a>
</p>
<hr>

<!-- To enable disqus, uncomment the section below and provide your disqus_shortname -->

<!-- disqus
  <div id="disqus_thread"></div>
    <script type="text/javascript">
        /* * * CONFIGURATION VARIABLES: EDIT BEFORE PASTING INTO YOUR WEBPAGE * * */
        var disqus_shortname = 'rmarkdown'; // required: replace example with your forum shortname

        /* * * DON'T EDIT BELOW THIS LINE * * */
        (function() {
            var dsq = document.createElement('script'); dsq.type = 'text/javascript'; dsq.async = true;
            dsq.src = '//' + disqus_shortname + '.disqus.com/embed.js';
            (document.getElementsByTagName('head')[0] || document.getElementsByTagName('body')[0]).appendChild(dsq);
        })();
    </script>
    <noscript>Please enable JavaScript to view the <a href="http://disqus.com/?ref_noscript">comments powered by Disqus.</a></noscript>
    <a href="http://disqus.com" class="dsq-brlink">comments powered by <span class="logo-disqus">Disqus</span></a>
-->


<!-- dynamically load mathjax for compatibility with self-contained -->
<script>
  (function () {
    var script = document.createElement("script");
    script.type = "text/javascript";
    script.src  = "https://mathjax.rstudio.com/latest/MathJax.js?config=TeX-AMS-MML_HTMLorMML";
    document.getElementsByTagName("head")[0].appendChild(script);
  })();
</script>

</body>
</html>
